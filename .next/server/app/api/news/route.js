"use strict";(()=>{var e={};e.id=7634,e.ids=[7634],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},6516:(e,t,a)=>{a.r(t),a.d(t,{headerHooks:()=>_,originalPathname:()=>k,patchFetch:()=>I,requestAsyncStorage:()=>h,routeModule:()=>g,serverHooks:()=>p,staticGenerationAsyncStorage:()=>y,staticGenerationBailout:()=>w});var i={};a.r(i),a.d(i,{GET:()=>d,POST:()=>m});var r=a(5419),s=a(9108),n=a(9678),l=a(2002),o=a(6176),u=a(9413);let c=new(a(7935)).TQ;async function d(e){try{let t=e.cookies.get("accessToken")?.value||e.headers.get("authorization")?.replace("Bearer ","");if(!t)return u.C4.MISSING_TOKEN();if(!(await l.e8.verifyAccessToken(t)).success)return u.C4.INVALID_TOKEN();let a=new URL(e.url),i=a.searchParams.get("category"),r=a.searchParams.get("is_featured"),s=a.searchParams.get("is_published"),n=a.searchParams.get("search"),o=Math.min(parseInt(a.searchParams.get("limit")||"50"),100),d=parseInt(a.searchParams.get("offset")||"0");if(c.isAvailable())try{let e=[],t=[];if(i&&(e.push("category = ?"),t.push(i)),null!==r&&""!==r&&(e.push("is_featured = ?"),t.push("true"===r?1:0)),null!==s&&""!==s&&(e.push("is_published = ?"),t.push("true"===s?1:0)),n){e.push("(title LIKE ? OR content LIKE ? OR summary LIKE ? OR tags LIKE ?)");let a=`%${n}%`;t.push(a,a,a,a)}let a=e.length>0?`WHERE ${e.join(" AND ")}`:"",l=`
          SELECT * FROM news 
          ${a}
          ORDER BY publish_date DESC, created_at DESC
          LIMIT ? OFFSET ?
        `;t.push(o,d);let m=await c.executeQuery(l,t);if(m.success&&m.data){let e=`SELECT COUNT(*) as total FROM news ${a}`,i=await c.executeQuery(e,t.slice(0,-2)),r=i.success&&i.data?.[0]?.total||0;return(0,u.x_)(m.data,"News fetched successfully",{total:r,limit:o,offset:d,hasMore:d+o<r,source:"D1"})}}catch(e){console.error("D1 news fetch error:",e)}console.log("⚠️ D1 database not available - returning mock news");let m=[{id:"news-001",title:"Yeni BRIX \xd6l\xe7\xfcm Teknolojisi Tanıtıldı",slug:"yeni-brix-olcum-teknolojisi-tanitildi",summary:"Protek Analitik'in geliştirdiği yeni nesil BRIX \xf6l\xe7\xfcm cihazları, end\xfcstriyel uygulamalarda hassasiyet standardını yeniden belirliyor.",content:"Gıda ve i\xe7ecek end\xfcstrisinde kritik \xf6nem taşıyan BRIX değeri \xf6l\xe7\xfcmlerinde devrim niteliğinde bir yenilik... [Detaylı i\xe7erik]",category:"sirket-haberleri",author:"Protek Analitik",publish_date:new Date(Date.now()-1728e5).toISOString().split("T")[0],image_url:"/images/news/brix-technology.jpg",tags:"BRIX,\xf6l\xe7\xfcm,teknoloji,gıda",is_featured:!0,is_published:!0,view_count:245,meta_title:"Yeni BRIX \xd6l\xe7\xfcm Teknolojisi | Protek Analitik",meta_description:"End\xfcstriyel BRIX \xf6l\xe7\xfcm teknolojilerinde yeni standartlar",meta_keywords:"BRIX, \xf6l\xe7\xfcm cihazı, teknoloji",created_at:new Date(Date.now()-1728e5).toISOString(),updated_at:new Date(Date.now()-1728e5).toISOString()},{id:"news-002",title:"Su Aktivitesi \xd6l\xe7\xfcmlerinde Kalibrasyon İpu\xe7ları",slug:"su-aktivitesi-olcumlerinde-kalibrasyon-ipuclari",summary:"Doğru su aktivitesi \xf6l\xe7\xfcmleri i\xe7in kalibrasyon s\xfcre\xe7lerinin \xf6nemi ve pratik uygulamalar.",content:"Su aktivitesi \xf6l\xe7\xfcmlerinde g\xfcvenilir sonu\xe7lar elde etmek i\xe7in kalibrasyon protokolleri... [Detaylı i\xe7erik]",category:"sektor-guncel",author:"Dr. Ahmet \xd6zkan",publish_date:new Date(Date.now()-432e6).toISOString().split("T")[0],image_url:"/images/news/water-activity.jpg",tags:"su aktivitesi,kalibrasyon,\xf6l\xe7\xfcm",is_featured:!1,is_published:!0,view_count:156,meta_title:"Su Aktivitesi Kalibrasyon Rehberi | Protek Analitik",meta_description:"Su aktivitesi \xf6l\xe7\xfcmlerinde kalibrasyon i\xe7in pratik ipu\xe7ları",meta_keywords:"su aktivitesi, kalibrasyon, \xf6l\xe7\xfcm",created_at:new Date(Date.now()-432e6).toISOString(),updated_at:new Date(Date.now()-432e6).toISOString()},{id:"news-003",title:"Laboratuvar Otomasyonunda Başarı Hikayesi",slug:"laboratuvar-otomasyonunda-basari-hikayesi",summary:"XYZ Gıda Şirketi ile ger\xe7ekleştirilen laboratuvar otomasyon projesi ve elde edilen verimlilik artışı.",content:"Modern laboratuvar y\xf6netiminde otomasyon \xe7\xf6z\xfcmlerinin rol\xfc... [Detaylı i\xe7erik]",category:"basari-hikayeleri",author:"Protek Analitik",publish_date:new Date(Date.now()-6048e5).toISOString().split("T")[0],image_url:"/images/news/lab-automation.jpg",tags:"laboratuvar,otomasyon,başarı",is_featured:!0,is_published:!0,view_count:324,meta_title:"Laboratuvar Otomasyon Başarı Hikayesi | Protek Analitik",meta_description:"XYZ Gıda ile laboratuvar otomasyon projesi başarı hikayesi",meta_keywords:"laboratuvar, otomasyon, başarı hikayesi",created_at:new Date(Date.now()-6048e5).toISOString(),updated_at:new Date(Date.now()-6048e5).toISOString()}];if(i&&(m=m.filter(e=>e.category===i)),null!==r&&""!==r){let e="true"===r;m=m.filter(t=>t.is_featured===e)}if(null!==s&&""!==s){let e="true"===s;m=m.filter(t=>t.is_published===e)}if(n){let e=n.toLowerCase();m=m.filter(t=>t.title.toLowerCase().includes(e)||t.content.toLowerCase().includes(e)||t.summary.toLowerCase().includes(e)||t.tags.toLowerCase().includes(e))}let g=m.length,h=m.slice(d,d+o);return(0,u.x_)(h,"News fetched successfully (development mode)",{total:g,limit:o,offset:d,hasMore:d+o<g,source:"mock-data"})}catch(e){return console.error("News fetch error:",e),u.Gl.SERVER_ERROR("Failed to fetch news")}}async function m(e){try{let t=e.cookies.get("accessToken")?.value||e.headers.get("authorization")?.replace("Bearer ","");if(!t)return u.C4.MISSING_TOKEN();let a=await l.e8.verifyAccessToken(t);if(!a.success)return u.C4.INVALID_TOKEN();if(!l.e8.hasRole(a.user,"editor"))return u.C4.INSUFFICIENT_PERMISSIONS();let i=await e.json(),r=(0,u.MN)(i,["title","content","category","publish_date"]);if(!r.isValid)return(0,u.jl)(`Missing required fields: ${r.missingFields.join(", ")}`,"MISSING_REQUIRED_FIELDS",400);let s=[];("string"!=typeof i.title||i.title.trim().length<5)&&s.push("Title must be at least 5 characters long"),("string"!=typeof i.content||i.content.trim().length<50)&&s.push("Content must be at least 50 characters long"),["sirket-haberleri","sektor-guncel","basari-hikayeleri"].includes(i.category)||s.push("Invalid category. Must be one of: sirket-haberleri, sektor-guncel, basari-hikayeleri");let n=new Date(i.publish_date);if(isNaN(n.getTime())&&s.push("Invalid publish date format"),s.length>0)return(0,u.jl)("Validation failed","VALIDATION_ERROR",400,{errors:s});let d=i.id||o.l3.generateId(),m=i.slug||o.l3.generateSlug(i.title);if(c.isAvailable())try{let e=await c.executeQuery("SELECT COUNT(*) as count FROM news WHERE slug = ?",[m]);if(e.success&&e.data?.[0]&&e.data[0].count>0)return(0,u.jl)("A news article with this slug already exists","DUPLICATE_SLUG",409);let t=new Date().toISOString(),r={id:d,title:i.title.trim(),slug:m,summary:i.summary?.trim()||"",content:o.v$.sanitizeHtml(i.content),category:i.category,author:i.author||a.user.username,publish_date:i.publish_date,image_url:i.image_url||i.imageUrl||"",tags:Array.isArray(i.tags)?i.tags.join(","):"string"==typeof i.tags?i.tags:"",is_featured:!!(i.is_featured||i.featured),is_published:!1!==i.is_published,view_count:0,meta_title:i.meta_title||i.title,meta_description:i.meta_description||i.summary||i.title,meta_keywords:i.meta_keywords||"",created_at:t,updated_at:t},s=await c.insertRecord("news",r);if(s.success)return console.log(`News created in D1: ${r.id} by user ${a.user.username}`),u.$X.CREATED(r,"News article");console.error("D1 insert failed:",s.error)}catch(e){console.error("D1 news creation error:",e)}console.log("⚠️ D1 database not available - simulating news creation");let g=new Date().toISOString(),h={id:d,title:i.title.trim(),slug:m,summary:i.summary?.trim()||"",content:o.v$.sanitizeHtml(i.content),category:i.category,author:i.author||a.user.username,publish_date:i.publish_date,image_url:i.image_url||i.imageUrl||"",tags:Array.isArray(i.tags)?i.tags.join(","):"string"==typeof i.tags?i.tags:"",is_featured:!!(i.is_featured||i.featured),is_published:!1!==i.is_published,view_count:0,meta_title:i.meta_title||i.title,meta_description:i.meta_description||i.summary||i.title,meta_keywords:i.meta_keywords||"",created_at:g,updated_at:g};return console.log(`News created: ${h.id} by user ${a.user.username}`),u.$X.CREATED(h,"News article (development mode)")}catch(e){return console.error("News creation error:",e),u.Gl.SERVER_ERROR("Failed to create news article")}}let g=new r.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/news/route",pathname:"/api/news",filename:"route",bundlePath:"app/api/news/route"},resolvedPagePath:"/Users/denizhan/Documents/Windsurf/protekanalitik/src/app/api/news/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:h,staticGenerationAsyncStorage:y,serverHooks:p,headerHooks:_,staticGenerationBailout:w}=g,k="/api/news/route";function I(){return(0,n.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:y})}},9413:(e,t,a)=>{a.d(t,{$X:()=>o,C4:()=>n,Gl:()=>l,MN:()=>u,jl:()=>s,x_:()=>r});var i=a(8070);function r(e,t,a){let r={success:!0,message:t,data:e,meta:{timestamp:new Date().toISOString(),version:"1.0.0",...a}};return i.Z.json(r)}function s(e,t,a=400,r){let s={success:!1,error:e,code:t,meta:{timestamp:new Date().toISOString(),version:"1.0.0",...r}};return i.Z.json(s,{status:a})}let n={MISSING_TOKEN:()=>s("Authentication token required","MISSING_TOKEN",401),INVALID_TOKEN:()=>s("Invalid or expired token","INVALID_TOKEN",401),INSUFFICIENT_PERMISSIONS:()=>s("Insufficient permissions","INSUFFICIENT_PERMISSIONS",403),RATE_LIMITED:e=>{let t=s("Too many requests. Please try again later.","RATE_LIMITED",429);return e&&t.headers.set("Retry-After",e.toString()),t}},l={NOT_FOUND:(e="Resource")=>s(`${e} not found`,"NOT_FOUND",404),ALREADY_EXISTS:(e="Resource")=>s(`${e} already exists`,"ALREADY_EXISTS",409),SERVER_ERROR:(e="Internal server error")=>s(e,"SERVER_ERROR",500),BAD_REQUEST:(e="Bad request")=>s(e,"BAD_REQUEST",400),FORBIDDEN:(e="Access forbidden")=>s(e,"FORBIDDEN",403)},o={CREATED:(e,t="Resource")=>r(e,`${t} created successfully`),UPDATED:(e,t="Resource")=>r(e,`${t} updated successfully`),DELETED:(e="Resource")=>r(null,`${e} deleted successfully`),FETCHED:(e,t="Resource")=>r(e,`${t} fetched successfully`)};function u(e,t){let a=t.filter(t=>void 0===e[t]||null===e[t]||""===e[t]);return{isValid:0===a.length,missingFields:a}}class c{static{this.requests=new Map}static isRateLimited(e,t=100,a=6e4){let i=Date.now(),r=this.requests.get(e);return!r||i>r.resetTime?(this.requests.set(e,{count:1,resetTime:i+a}),!1):r.count>=t||(r.count++,!1)}static getRemainingRequests(e,t=100){let a=this.requests.get(e);return a?Math.max(0,t-a.count):t}static cleanup(){let e=Date.now();for(let[t,a]of Array.from(this.requests.entries()))e>a.resetTime&&this.requests.delete(t)}}"undefined"!=typeof setInterval&&setInterval(()=>{c.cleanup()},3e5)}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),i=t.X(0,[1638,6206,5669,6458],()=>a(6516));module.exports=i})();