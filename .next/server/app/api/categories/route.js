"use strict";(()=>{var e={};e.id=9961,e.ids=[9961],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},1182:(e,t,a)=>{a.r(t),a.d(t,{headerHooks:()=>f,originalPathname:()=>I,patchFetch:()=>_,requestAsyncStorage:()=>E,routeModule:()=>p,serverHooks:()=>R,staticGenerationAsyncStorage:()=>y,staticGenerationBailout:()=>S});var r={};a.r(r),a.d(r,{GET:()=>m,POST:()=>g});var i=a(5419),s=a(9108),o=a(9678),n=a(2002),l=a(9413),c=a(7935);let u=[{id:"laboratuvar-ekipmanlari",name:"Laboratuvar Ekipmanları, Sarf Malzemeler Ve Kitler"},{id:"proses-kontrol",name:"Proses Kontrol Ve Hat Tipi Analiz \xc7\xf6z\xfcmleri"},{id:"pilot-uretim",name:"Pilot Tipi \xdcretim ve Proses Sim\xfclasyon Sistemleri"}],d=[{id:"fiziksel-analiz",category_id:"laboratuvar-ekipmanlari",name:"Fiziksel Analiz Ekipmanları"},{id:"kimyasal-analiz",category_id:"laboratuvar-ekipmanlari",name:"Kimyasal Analiz Ekipmanları"},{id:"mikrobiyoloji",category_id:"laboratuvar-ekipmanlari",name:"Mikrobiyoloji Analiz Ekipmanları"},{id:"molekuler-biyoloji",category_id:"laboratuvar-ekipmanlari",name:"Molek\xfcler Biyoloji/Genetik Analiz Ekipmanları"},{id:"test-olcu",category_id:"laboratuvar-ekipmanlari",name:"Test, \xd6l\xe7\xfc Kontrol Sistemleri"},{id:"ambalaj-test",category_id:"laboratuvar-ekipmanlari",name:"Ambalaj ve Malzeme Test Sistemleri"},{id:"arge-ekipmanlari",category_id:"laboratuvar-ekipmanlari",name:"Araştırma ve Geliştirme Ekipmanları"},{id:"hat-tipi-analiz",category_id:"proses-kontrol",name:"Hat Tipi Analiz Sistemleri"},{id:"proses-sensorleri",category_id:"proses-kontrol",name:"Proses Sens\xf6rleri"},{id:"karistirma",category_id:"pilot-uretim",name:"Karıştırma ve Homojenizasyon"},{id:"kurutma-isleme",category_id:"pilot-uretim",name:"Kurutma ve İşleme"},{id:"filtrasyon",category_id:"pilot-uretim",name:"Filtrasyon ve Separasyon"}];async function m(e){try{let t=e.cookies.get("accessToken")?.value||e.headers.get("authorization")?.replace("Bearer ","");if(!t)return l.C4.MISSING_TOKEN();if(!(await n.e8.verifyAccessToken(t)).success)return l.C4.INVALID_TOKEN();let a=new URL(e.url).searchParams.get("type");if(!c.ki.isAvailable())return(0,l.x_)("subcategories"===a?d:{categories:u,subcategories:d},"Categories fetched successfully (fallback)",{totalCategories:u.length,totalSubcategories:d.length,source:"fallback"});{let e=[],t=[];if("subcategories"===a){let e=await c.ki.getRecords("subcategories",{orderBy:"name ASC"});t=e.success&&e.data||[]}else{let a=await c.ki.getRecords("categories",{orderBy:"name ASC"});e=a.success&&a.data||[];let r=await c.ki.getRecords("subcategories",{orderBy:"name ASC"});t=r.success&&r.data||[]}return(0,l.x_)("subcategories"===a?t:{categories:e,subcategories:t},"Categories fetched successfully",{totalCategories:e.length,totalSubcategories:t.length,source:"D1"})}}catch(e){return console.error("Categories fetch error:",e),l.Gl.SERVER_ERROR("Failed to fetch categories")}}async function g(e){try{let t=e.cookies.get("accessToken")?.value||e.headers.get("authorization")?.replace("Bearer ","");if(!t)return l.C4.MISSING_TOKEN();let a=await n.e8.verifyAccessToken(t);if(!a.success)return l.C4.INVALID_TOKEN();if(!n.e8.hasRole(a.user,"admin"))return l.C4.INSUFFICIENT_PERMISSIONS();if(!c.ki.isAvailable())return(0,l.jl)("Database not available","DB_UNAVAILABLE",503);let r=await e.json(),i=!!r.category_id,s=["name"];i&&s.push("category_id");let o=(0,l.MN)(r,s);if(!o.isValid)return(0,l.jl)(`Missing required fields: ${o.missingFields.join(", ")}`,"MISSING_REQUIRED_FIELDS",400);let u=[];if(("string"!=typeof r.name||r.name.trim().length<2)&&u.push("Name must be at least 2 characters long"),u.length>0)return(0,l.jl)("Validation failed","VALIDATION_ERROR",400,{errors:u});let d=c.cf.generateId(),m=c.cf.formatDate(),g={id:d,name:r.name.trim(),description:r.description?.trim()||"",image_url:r.image_url||"",is_active:!1!==r.is_active,created_at:m,updated_at:m};i&&(g.category_id=r.category_id);let p=await c.ki.insertRecord(i?"subcategories":"categories",g);if(!p.success)return(0,l.jl)(p.error||"Failed to create item","CREATE_FAILED");return console.log(`${i?"Subcategory":"Category"} created: ${g.id}`),l.$X.CREATED(g,i?"Subcategory":"Category")}catch(e){return console.error("Category creation error:",e),l.Gl.SERVER_ERROR("Failed to create category")}}let p=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/categories/route",pathname:"/api/categories",filename:"route",bundlePath:"app/api/categories/route"},resolvedPagePath:"/Users/denizhan/Documents/Windsurf/protekanalitik/src/app/api/categories/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:E,staticGenerationAsyncStorage:y,serverHooks:R,headerHooks:f,staticGenerationBailout:S}=p,I="/api/categories/route";function _(){return(0,o.patchFetch)({serverHooks:R,staticGenerationAsyncStorage:y})}},9413:(e,t,a)=>{a.d(t,{$X:()=>l,C4:()=>o,Gl:()=>n,MN:()=>c,jl:()=>s,x_:()=>i});var r=a(8070);function i(e,t,a){let i={success:!0,message:t,data:e,meta:{timestamp:new Date().toISOString(),version:"1.0.0",...a}};return r.Z.json(i)}function s(e,t,a=400,i){let s={success:!1,error:e,code:t,meta:{timestamp:new Date().toISOString(),version:"1.0.0",...i}};return r.Z.json(s,{status:a})}let o={MISSING_TOKEN:()=>s("Authentication token required","MISSING_TOKEN",401),INVALID_TOKEN:()=>s("Invalid or expired token","INVALID_TOKEN",401),INSUFFICIENT_PERMISSIONS:()=>s("Insufficient permissions","INSUFFICIENT_PERMISSIONS",403),RATE_LIMITED:e=>{let t=s("Too many requests. Please try again later.","RATE_LIMITED",429);return e&&t.headers.set("Retry-After",e.toString()),t}},n={NOT_FOUND:(e="Resource")=>s(`${e} not found`,"NOT_FOUND",404),ALREADY_EXISTS:(e="Resource")=>s(`${e} already exists`,"ALREADY_EXISTS",409),SERVER_ERROR:(e="Internal server error")=>s(e,"SERVER_ERROR",500),BAD_REQUEST:(e="Bad request")=>s(e,"BAD_REQUEST",400),FORBIDDEN:(e="Access forbidden")=>s(e,"FORBIDDEN",403)},l={CREATED:(e,t="Resource")=>i(e,`${t} created successfully`),UPDATED:(e,t="Resource")=>i(e,`${t} updated successfully`),DELETED:(e="Resource")=>i(null,`${e} deleted successfully`),FETCHED:(e,t="Resource")=>i(e,`${t} fetched successfully`)};function c(e,t){let a=t.filter(t=>void 0===e[t]||null===e[t]||""===e[t]);return{isValid:0===a.length,missingFields:a}}class u{static{this.requests=new Map}static isRateLimited(e,t=100,a=6e4){let r=Date.now(),i=this.requests.get(e);return!i||r>i.resetTime?(this.requests.set(e,{count:1,resetTime:r+a}),!1):i.count>=t||(i.count++,!1)}static getRemainingRequests(e,t=100){let a=this.requests.get(e);return a?Math.max(0,t-a.count):t}static cleanup(){let e=Date.now();for(let[t,a]of Array.from(this.requests.entries()))e>a.resetTime&&this.requests.delete(t)}}"undefined"!=typeof setInterval&&setInterval(()=>{u.cleanup()},3e5)}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[1638,6206,5669,6458],()=>a(1182));module.exports=r})();