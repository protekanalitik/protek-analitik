"use strict";(()=>{var e={};e.id=6007,e.ids=[6007],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},7276:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>k,originalPathname:()=>y,patchFetch:()=>h,requestAsyncStorage:()=>m,routeModule:()=>_,serverHooks:()=>g,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>R});var i={};r.r(i),r.d(i,{DELETE:()=>v,GET:()=>p,PUT:()=>E});var n=r(5419),a=r(9108),s=r(9678),o=r(2002),l=r(6176),d=r(9413),u=r(1494);let c={id:"event-1",title:"G\xfcvenlik Teknolojileri Semineri",slug:"guvenlik-teknolojileri-semineri",description:"Modern g\xfcvenlik teknolojileri ve uygulamaları hakkında kapsamlı seminer",content:"Bu seminerde son teknoloji g\xfcvenlik \xe7\xf6z\xfcmlerini ve uygulamalarını detaylı olarak inceleyeceğiz.",event_type:"seminer",start_date:"2024-02-15",end_date:"2024-02-15",location:"İstanbul Kongre Merkezi",address:"Harbiye, İstanbul",registration_url:"https://example.com/register",max_participants:100,current_participants:45,image_url:"/images/events/security-seminar.jpg",tags:"g\xfcvenlik,teknoloji,seminer",is_featured:!0,is_published:!0,registration_required:!0,is_online:!1,meeting_link:"",meta_title:"G\xfcvenlik Teknolojileri Semineri - Protek Analitik",meta_description:"Modern g\xfcvenlik teknolojileri semineri",meta_keywords:"g\xfcvenlik,teknoloji,seminer",created_at:"2024-01-15T10:00:00Z",updated_at:"2024-01-15T10:00:00Z",created_by:"admin"};async function p(e,{params:t}){try{let r=e.cookies.get("accessToken")?.value||e.headers.get("authorization")?.replace("Bearer ","");if(!r)return d.C4.MISSING_TOKEN();if(!(await o.e8.verifyAccessToken(r)).success)return d.C4.INVALID_TOKEN();let i=(0,u.j)(),n=null;if(i)try{(n=await i.prepare("SELECT * FROM events WHERE id = ?").bind(t.id).first())&&console.log(`Fetched event ${t.id} from D1 database`)}catch(e){console.error("D1 query error:",e),"event-1"===t.id&&(n=c,console.log("Using mock event data due to D1 error"))}else"event-1"===t.id&&(n=c,console.log("Using mock event data (D1 not available)"));if(!n)return(0,d.jl)("Event not found","EVENT_NOT_FOUND",404);return(0,d.x_)(n,"Event fetched successfully")}catch(e){return console.error("Event fetch error:",e),d.Gl.SERVER_ERROR("Failed to fetch event")}}async function E(e,{params:t}){try{let r=e.cookies.get("accessToken")?.value||e.headers.get("authorization")?.replace("Bearer ","");if(!r)return d.C4.MISSING_TOKEN();let i=await o.e8.verifyAccessToken(r);if(!i.success)return d.C4.INVALID_TOKEN();if(!o.e8.hasRole(i.user,"editor"))return d.C4.INSUFFICIENT_PERMISSIONS();let n=await e.json(),a=(0,u.j)();if(a)try{if(!await a.prepare("SELECT * FROM events WHERE id = ?").bind(t.id).first())return(0,d.jl)("Event not found","EVENT_NOT_FOUND",404);let e={updated_at:l.l3.formatDate()};["title","slug","description","content","event_type","start_date","end_date","location","address","registration_url","max_participants","current_participants","image_url","tags","is_featured","is_published","registration_required","is_online","meeting_link","meta_title","meta_description","meta_keywords"].forEach(t=>{void 0!==n[t]&&(["is_featured","is_published","registration_required","is_online"].includes(t)?e[t]=n[t]?1:0:"tags"===t&&"string"!=typeof n[t]?e[t]=JSON.stringify(n[t]||[]):e[t]=n[t])});let r=Object.keys(e).map(e=>`${e} = ?`).join(", "),s=Object.values(e);s.push(t.id),await a.prepare(`
          UPDATE events SET ${r} WHERE id = ?
        `).bind(...s).run();let o=await a.prepare("SELECT * FROM events WHERE id = ?").bind(t.id).first();return console.log(`Event updated in D1: ${t.id} by user ${i.user.username}`),(0,d.x_)(o,"Event updated successfully")}catch(e){return console.error("D1 event update error:",e),d.Gl.SERVER_ERROR("Failed to update event in database")}else{console.log("D1 not available, returning mock event update success");let e={id:t.id,...n,updated_at:l.l3.formatDate()};return(0,d.x_)(e,"Event updated successfully")}}catch(e){return console.error("Event update error:",e),d.Gl.SERVER_ERROR("Failed to update event")}}async function v(e,{params:t}){try{let r=e.cookies.get("accessToken")?.value||e.headers.get("authorization")?.replace("Bearer ","");if(!r)return d.C4.MISSING_TOKEN();let i=await o.e8.verifyAccessToken(r);if(!i.success)return d.C4.INVALID_TOKEN();if(!o.e8.hasRole(i.user,"admin"))return d.C4.INSUFFICIENT_PERMISSIONS();let n=(0,u.j)();if(!n)return console.log("D1 not available, returning mock event deletion success"),(0,d.x_)({id:t.id},"Event deleted successfully");try{let e=await n.prepare("SELECT id, title FROM events WHERE id = ?").bind(t.id).first();if(!e)return(0,d.jl)("Event not found","EVENT_NOT_FOUND",404);return await n.prepare("DELETE FROM events WHERE id = ?").bind(t.id).run(),console.log(`Event deleted from D1: ${t.id} by user ${i.user.username}`),(0,d.x_)({id:t.id,title:e.title},"Event deleted successfully")}catch(e){return console.error("D1 event deletion error:",e),d.Gl.SERVER_ERROR("Failed to delete event from database")}}catch(e){return console.error("Event deletion error:",e),d.Gl.SERVER_ERROR("Failed to delete event")}}let _=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/events/[id]/route",pathname:"/api/events/[id]",filename:"route",bundlePath:"app/api/events/[id]/route"},resolvedPagePath:"/Users/denizhan/Documents/Windsurf/protekanalitik/src/app/api/events/[id]/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:g,headerHooks:k,staticGenerationBailout:R}=_,y="/api/events/[id]/route";function h(){return(0,s.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:f})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[1638,6206,5669,9745],()=>r(7276));module.exports=i})();