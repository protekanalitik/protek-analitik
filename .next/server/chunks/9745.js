"use strict";exports.id=9745,exports.ids=[9745],exports.modules={9413:(e,t,r)=>{r.d(t,{$X:()=>c,C4:()=>n,Gl:()=>o,MN:()=>l,jl:()=>i,x_:()=>a});var s=r(8070);function a(e,t,r){let a={success:!0,message:t,data:e,meta:{timestamp:new Date().toISOString(),version:"1.0.0",...r}};return s.Z.json(a)}function i(e,t,r=400,a){let i={success:!1,error:e,code:t,meta:{timestamp:new Date().toISOString(),version:"1.0.0",...a}};return s.Z.json(i,{status:r})}let n={MISSING_TOKEN:()=>i("Authentication token required","MISSING_TOKEN",401),INVALID_TOKEN:()=>i("Invalid or expired token","INVALID_TOKEN",401),INSUFFICIENT_PERMISSIONS:()=>i("Insufficient permissions","INSUFFICIENT_PERMISSIONS",403),RATE_LIMITED:e=>{let t=i("Too many requests. Please try again later.","RATE_LIMITED",429);return e&&t.headers.set("Retry-After",e.toString()),t}},o={NOT_FOUND:(e="Resource")=>i(`${e} not found`,"NOT_FOUND",404),ALREADY_EXISTS:(e="Resource")=>i(`${e} already exists`,"ALREADY_EXISTS",409),SERVER_ERROR:(e="Internal server error")=>i(e,"SERVER_ERROR",500),BAD_REQUEST:(e="Bad request")=>i(e,"BAD_REQUEST",400),FORBIDDEN:(e="Access forbidden")=>i(e,"FORBIDDEN",403)},c={CREATED:(e,t="Resource")=>a(e,`${t} created successfully`),UPDATED:(e,t="Resource")=>a(e,`${t} updated successfully`),DELETED:(e="Resource")=>a(null,`${e} deleted successfully`),FETCHED:(e,t="Resource")=>a(e,`${t} fetched successfully`)};function l(e,t){let r=t.filter(t=>void 0===e[t]||null===e[t]||""===e[t]);return{isValid:0===r.length,missingFields:r}}class u{static{this.requests=new Map}static isRateLimited(e,t=100,r=6e4){let s=Date.now(),a=this.requests.get(e);return!a||s>a.resetTime?(this.requests.set(e,{count:1,resetTime:s+r}),!1):a.count>=t||(a.count++,!1)}static getRemainingRequests(e,t=100){let r=this.requests.get(e);return r?Math.max(0,t-r.count):t}static cleanup(){let e=Date.now();for(let[t,r]of Array.from(this.requests.entries()))e>r.resetTime&&this.requests.delete(t)}}"undefined"!=typeof setInterval&&setInterval(()=>{u.cleanup()},3e5)},2002:(e,t,r)=>{r.d(t,{e8:()=>d,pS:()=>u});var s=r(9616),a=r(1865);r(7529);var i=r(6176);let n=process.env.JWT_SECRET||"your-super-secret-jwt-key-change-in-production",o=process.env.JWT_ACCESS_EXPIRES_IN||"15m",c=process.env.JWT_REFRESH_EXPIRES_IN||"7d";class l{static getSecret(){return new TextEncoder().encode(n)}static async generateAccessToken(e){let t={sub:e.id,username:e.username,email:e.email,role:e.role,type:"access"};return await new s.N(t).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime(o).sign(this.getSecret())}static async generateRefreshToken(e){let t={sub:e.id,username:e.username,email:e.email,role:e.role,type:"refresh"};return await new s.N(t).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime(c).sign(this.getSecret())}static async verifyToken(e){try{let{payload:t}=await (0,a._)(e,this.getSecret());return{success:!0,payload:t}}catch(e){return{success:!1,error:e.message||"Invalid token"}}}}class u{static{this.attempts=new Map}static isRateLimited(e,t=5,r=9e5){let s=Date.now(),a=this.attempts.get(e);return!a||s>a.resetTime?(this.attempts.set(e,{count:1,resetTime:s+r}),!1):a.count>=t||(a.count++,!1)}static clearAttempts(e){this.attempts.delete(e)}static resetRateLimit(e){this.attempts.delete(e)}static cleanup(){let e=Date.now(),t=[];this.attempts.forEach((r,s)=>{e>r.resetTime&&t.push(s)}),t.forEach(e=>{this.attempts.delete(e)})}}class d{static async authenticate(e,t){try{if("protekadmin"!==e&&"admin@protekanalitik.com"!==e||"protek1234"!==t)return{success:!1,error:"Ge\xe7ersiz kullanıcı adı veya şifre"};{let e={id:"admin-001",username:"protekadmin",email:"admin@protekanalitik.com",first_name:"Admin",last_name:"User",role:"admin",is_active:!0,last_login:i.l3.formatDate(),created_at:i.l3.formatDate(),updated_at:i.l3.formatDate()},t=await l.generateAccessToken(e),r=await l.generateRefreshToken(e);return{success:!0,user:e,accessToken:t,refreshToken:r}}}catch(e){return console.error("Authentication error:",e),{success:!1,error:"Kimlik doğrulama sırasında hata oluştu"}}}static async refreshAccessToken(e){try{let t=await l.verifyToken(e);if(!t.success||!t.payload)return{success:!1,error:"Ge\xe7ersiz refresh token"};if("refresh"!==t.payload.type)return{success:!1,error:"Ge\xe7ersiz token tipi"};let r={id:t.payload.sub,username:t.payload.username,email:t.payload.email,role:t.payload.role,is_active:!0,created_at:i.l3.formatDate(),updated_at:i.l3.formatDate()},s=await l.generateAccessToken(r);return{success:!0,user:r,accessToken:s,refreshToken:e}}catch(e){return console.error("Token refresh error:",e),{success:!1,error:"Token yenileme sırasında hata oluştu"}}}static async verifyAccessToken(e){try{let t=await l.verifyToken(e);if(!t.success||!t.payload)return{success:!1,error:"Ge\xe7ersiz token"};if("access"!==t.payload.type)return{success:!1,error:"Ge\xe7ersiz token tipi"};let r={id:t.payload.sub,username:t.payload.username,email:t.payload.email,role:t.payload.role,is_active:!0,created_at:i.l3.formatDate(),updated_at:i.l3.formatDate()};return{success:!0,user:r}}catch(e){return console.error("Token verification error:",e),{success:!1,error:"Token doğrulama sırasında hata oluştu"}}}static hasRole(e,t){let r={viewer:1,editor:2,admin:3,super_admin:4};return r[e.role]>=r[t]}static async generatePasswordResetToken(e){let t={sub:e,type:"password_reset",exp:Math.floor(Date.now()/1e3)+3600};return await new s.N(t).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("1h").sign(l.getSecret())}static async verifyPasswordResetToken(e){try{let t=await l.verifyToken(e);if(!t.success||!t.payload||"password_reset"!==t.payload.type)return{success:!1,error:"Ge\xe7ersiz şifre sıfırlama token"};return{success:!0,userId:t.payload.sub}}catch(e){return console.error("Password reset token verification error:",e),{success:!1,error:"Token doğrulama sırasında hata oluştu"}}}}},6176:(e,t,r)=>{r.d(t,{l3:()=>s,v$:()=>a});let s={generateId:()=>crypto.randomUUID(),toJson:e=>JSON.stringify(e),fromJson:e=>{if(!e)return null;try{return JSON.parse(e)}catch{return null}},generateSlug:e=>e.toLowerCase().replace(/ğ/g,"g").replace(/ü/g,"u").replace(/ş/g,"s").replace(/ı/g,"i").replace(/ö/g,"o").replace(/ç/g,"c").replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,""),formatDate:(e=new Date)=>e.toISOString(),getPaginationParams:(e=1,t=20)=>({limit:t,offset:(e-1)*t})},a={isValidEmail:e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),isValidPhone:e=>/^[\+]?[0-9\s\-\(\)]{10,}$/.test(e),isValidUrl:e=>{try{return new URL(e),!0}catch{return!1}},sanitizeHtml:e=>e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,"").replace(/on\w+="[^"]*"/gi,"")}},1494:(e,t,r)=>{function s(){return void 0!==globalThis.D1?globalThis.D1:null}r.d(t,{j:()=>s})}};