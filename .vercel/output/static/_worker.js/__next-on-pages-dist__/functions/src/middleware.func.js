var hr=Object.defineProperty;var la=Object.getOwnPropertyDescriptor;var pa=Object.getOwnPropertyNames;var ha=Object.prototype.hasOwnProperty;var dt=(Y,G)=>()=>(Y&&(G=Y(Y=0)),G);var ut=(Y,G,Te,z)=>{if(G&&typeof G=="object"||typeof G=="function")for(let $ of pa(G))!ha.call(Y,$)&&$!==Te&&hr(Y,$,{get:()=>G[$],enumerable:!(z=la(G,$))||z.enumerable});return Y},ge=(Y,G,Te)=>(ut(Y,G,"default"),Te&&ut(Te,G,"default"));var lt=Y=>ut(hr({},"__esModule",{value:!0}),Y);var De={};import*as Vi from"node:async_hooks";var fr=dt(()=>{ge(De,Vi)});var Ke={};import*as zi from"node:buffer";var gr=dt(()=>{ge(Ke,zi)});var Le={};import*as Xi from"async_hooks";var yr=dt(()=>{ge(Le,Xi)});var pt=globalThis.__nextOnPagesRoutesIsolation.getProxyFor("/src/middleware"),qi=((Y,G,Te)=>(G._ENTRIES={},Y.__PRERENDER_MANIFEST='{"version":4,"routes":{},"dynamicRoutes":{},"notFoundRoutes":[],"preview":{"previewModeId":"a787199d446dcb35e6586106cb38de82","previewModeSigningKey":"83753da7859395c94270b897009d9ff815d79669a0dc918d7ae84293ad101934","previewModeEncryptionKey":"9d3868e6459aee84d0adfef76d0872c64967a77d9ca6e361fdc3757ec47ddd47"}}',(()=>{"use strict";var z={},$={};function D(x){var U=$[x];if(U!==void 0)return U.exports;var W=$[x]={exports:{}},K=!0;try{z[x](W,W.exports,D),K=!1}finally{K&&delete $[x]}return W.exports}D.m=z,(()=>{var x=[];D.O=(U,W,K,F)=>{if(W){F=F||0;for(var y=x.length;y>0&&x[y-1][2]>F;y--)x[y]=x[y-1];x[y]=[W,K,F];return}for(var s=1/0,y=0;y<x.length;y++){for(var[W,K,F]=x[y],d=!0,u=0;u<W.length;u++)(F&!1||s>=F)&&Object.keys(D.O).every(P=>D.O[P](W[u]))?W.splice(u--,1):(d=!1,F<s&&(s=F));if(d){x.splice(y--,1);var f=K();f!==void 0&&(U=f)}}return U}})(),D.n=x=>{var U=x&&x.__esModule?()=>x.default:()=>x;return D.d(U,{a:U}),U},D.d=(x,U)=>{for(var W in U)D.o(U,W)&&!D.o(x,W)&&Object.defineProperty(x,W,{enumerable:!0,get:U[W]})},D.e=()=>Promise.resolve(),D.g=function(){if(typeof G=="object")return G;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),D.o=(x,U)=>Object.prototype.hasOwnProperty.call(x,U),D.r=x=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(x,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(x,"__esModule",{value:!0})},(()=>{var x={993:0};D.O.j=K=>x[K]===0;var U=(K,F)=>{var[y,s,d]=F,u,f,h=0;if(y.some(g=>x[g]!==0)){for(u in s)D.o(s,u)&&(D.m[u]=s[u]);if(d)var p=d(D)}for(K&&K(F);h<y.length;h++)f=y[h],D.o(x,f)&&x[f]&&x[f][0](),x[f]=0;return D.O(p)},W=Y.webpackChunk_N_E=Y.webpackChunk_N_E||[];W.forEach(U.bind(null,0)),W.push=U.bind(null,W.push.bind(W))})()})(),(Y.webpackChunk_N_E=Y.webpackChunk_N_E||[]).push([[727],{2067:z=>{"use strict";z.exports=(fr(),lt(De))},6195:z=>{"use strict";z.exports=(gr(),lt(Ke))},5257:(z,$,D)=>{"use strict";D.r($),D.d($,{default:()=>ua});var x={};D.r(x),D.d(x,{config:()=>ca,middleware:()=>ia});async function U(){if("globalThis._ENTRIES"in G&&G._ENTRIES.middleware_instrumentation&&G._ENTRIES.middleware_instrumentation.register)try{await G._ENTRIES.middleware_instrumentation.register()}catch(t){throw t.message=`An error occurred while loading instrumentation hook: ${t.message}`,t}}let W=null;function K(){return W||(W=U()),W}function F(t){return`The edge runtime does not support Node.js '${t}' module.
Learn More: https://nextjs.org/docs/messages/node-module-in-edge-runtime`}function y(t){let e=new Proxy(function(){},{get(r,n){if(n==="then")return{};throw new Error(F(t))},construct(){throw new Error(F(t))},apply(r,n,a){if(typeof a[0]=="function")return a[0](e);throw new Error(F(t))}});return new Proxy({},{get:()=>e})}function s(){process!==D.g.process&&(process.env=D.g.process.env,D.g.process=process),Object.defineProperty(G,"__import_unsupported",{value:y,enumerable:!1,configurable:!0}),K()}s();class d extends Error{constructor({page:e}){super(`The middleware "${e}" accepts an async API directly with the form:
  
  export function middleware(request, event) {
    return NextResponse.redirect('/new-location')
  }
  
  Read more: https://nextjs.org/docs/messages/middleware-new-signature
  `)}}class u extends Error{constructor(){super("The request.page has been deprecated in favour of `URLPattern`.\n  Read more: https://nextjs.org/docs/messages/middleware-request-page\n  ")}}class f extends Error{constructor(){super("The request.ua has been removed in favour of `userAgent` function.\n  Read more: https://nextjs.org/docs/messages/middleware-parse-user-agent\n  ")}}function h(t){let e=new Headers;for(let[r,n]of Object.entries(t)){let a=Array.isArray(n)?n:[n];for(let o of a)typeof o>"u"||(typeof o=="number"&&(o=o.toString()),e.append(r,o))}return e}function p(t){var e=[],r=0,n,a,o,i,l;function E(){for(;r<t.length&&/\s/.test(t.charAt(r));)r+=1;return r<t.length}function _(){return a=t.charAt(r),a!=="="&&a!==";"&&a!==","}for(;r<t.length;){for(n=r,l=!1;E();)if(a=t.charAt(r),a===","){for(o=r,r+=1,E(),i=r;r<t.length&&_();)r+=1;r<t.length&&t.charAt(r)==="="?(l=!0,r=i,e.push(t.substring(n,o)),n=r):r=o+1}else r+=1;(!l||r>=t.length)&&e.push(t.substring(n,t.length))}return e}function g(t){let e={},r=[];if(t)for(let[n,a]of t.entries())n.toLowerCase()==="set-cookie"?(r.push(...p(a)),e[n]=r.length===1?r[0]:r):e[n]=a;return e}function m(t){try{return String(new URL(String(t)))}catch(e){throw new Error(`URL is malformed "${String(t)}". Please use only absolute URLs - https://nextjs.org/docs/messages/middleware-relative-urls`,{cause:e})}}let P=Symbol("response"),w=Symbol("passThrough"),v=Symbol("waitUntil");class I{constructor(e){this[v]=[],this[w]=!1}respondWith(e){this[P]||(this[P]=Promise.resolve(e))}passThroughOnException(){this[w]=!0}waitUntil(e){this[v].push(e)}}class C extends I{constructor(e){super(e.request),this.sourcePage=e.page}get request(){throw new d({page:this.sourcePage})}respondWith(){throw new d({page:this.sourcePage})}}function c(t,e,r){if(!!t){r&&(r=r.toLowerCase());for(let o of t){var n,a;let i=(n=o.domain)==null?void 0:n.split(":",1)[0].toLowerCase();if(e===i||r===o.defaultLocale.toLowerCase()||((a=o.locales)==null?void 0:a.some(l=>l.toLowerCase()===r)))return o}}}function S(t){return t.replace(/\/$/,"")||"/"}function b(t){let e=t.indexOf("#"),r=t.indexOf("?"),n=r>-1&&(e<0||r<e);return n||e>-1?{pathname:t.substring(0,n?r:e),query:n?t.substring(r,e>-1?e:void 0):"",hash:e>-1?t.slice(e):""}:{pathname:t,query:"",hash:""}}function M(t,e){if(!t.startsWith("/")||!e)return t;let{pathname:r,query:n,hash:a}=b(t);return""+e+r+n+a}function O(t,e){if(!t.startsWith("/")||!e)return t;let{pathname:r,query:n,hash:a}=b(t);return""+r+e+n+a}function A(t,e){if(typeof t!="string")return!1;let{pathname:r}=b(t);return r===e||r.startsWith(e+"/")}function k(t,e,r,n){if(!e||e===r)return t;let a=t.toLowerCase();return!n&&(A(a,"/api")||A(a,"/"+e.toLowerCase()))?t:M(t,"/"+e)}function L(t){let e=k(t.pathname,t.locale,t.buildId?void 0:t.defaultLocale,t.ignorePrefix);return(t.buildId||!t.trailingSlash)&&(e=S(e)),t.buildId&&(e=O(M(e,"/_next/data/"+t.buildId),t.pathname==="/"?"index.json":".json")),e=M(e,t.basePath),!t.buildId&&t.trailingSlash?e.endsWith("/")?e:O(e,"/"):S(e)}function H(t,e){let r;if(e?.host&&!Array.isArray(e.host))r=e.host.toString().split(":",1)[0];else if(t.hostname)r=t.hostname;else return;return r.toLowerCase()}function Z(t,e){let r,n=t.split("/");return(e||[]).some(a=>n[1]&&n[1].toLowerCase()===a.toLowerCase()?(r=a,n.splice(1,1),t=n.join("/")||"/",!0):!1),{pathname:t,detectedLocale:r}}function ee(t,e){if(!A(t,e))return t;let r=t.slice(e.length);return r.startsWith("/")?r:"/"+r}function ie(t,e){var r;let{basePath:n,i18n:a,trailingSlash:o}=(r=e.nextConfig)!=null?r:{},i={pathname:t,trailingSlash:t!=="/"?t.endsWith("/"):o};n&&A(i.pathname,n)&&(i.pathname=ee(i.pathname,n),i.basePath=n);let l=i.pathname;if(i.pathname.startsWith("/_next/data/")&&i.pathname.endsWith(".json")){let _=i.pathname.replace(/^\/_next\/data\//,"").replace(/\.json$/,"").split("/"),R=_[0];i.buildId=R,l=_[1]!=="index"?"/"+_.slice(1).join("/"):"/",e.parseData===!0&&(i.pathname=l)}if(a){let _=e.i18nProvider?e.i18nProvider.analyze(i.pathname):Z(i.pathname,a.locales);i.locale=_.detectedLocale;var E;i.pathname=(E=_.pathname)!=null?E:i.pathname,!_.detectedLocale&&i.buildId&&(_=e.i18nProvider?e.i18nProvider.analyze(l):Z(l,a.locales),_.detectedLocale&&(i.locale=_.detectedLocale))}return i}let ce=/(?!^https?:\/\/)(127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}|\[::1\]|localhost)/;function ne(t,e){return new URL(String(t).replace(ce,"localhost"),e&&String(e).replace(ce,"localhost"))}let T=Symbol("NextURLInternal");class de{constructor(e,r,n){let a,o;typeof r=="object"&&"pathname"in r||typeof r=="string"?(a=r,o=n||{}):o=n||r||{},this[T]={url:ne(e,a??o.base),options:o,basePath:""},this.analyze()}analyze(){var e,r,n,a,o;let i=ie(this[T].url.pathname,{nextConfig:this[T].options.nextConfig,parseData:!0,i18nProvider:this[T].options.i18nProvider}),l=H(this[T].url,this[T].options.headers);this[T].domainLocale=this[T].options.i18nProvider?this[T].options.i18nProvider.detectDomainLocale(l):c((r=this[T].options.nextConfig)==null||(e=r.i18n)==null?void 0:e.domains,l);let E=((n=this[T].domainLocale)==null?void 0:n.defaultLocale)||((o=this[T].options.nextConfig)==null||(a=o.i18n)==null?void 0:a.defaultLocale);this[T].url.pathname=i.pathname,this[T].defaultLocale=E,this[T].basePath=i.basePath??"",this[T].buildId=i.buildId,this[T].locale=i.locale??E,this[T].trailingSlash=i.trailingSlash}formatPathname(){return L({basePath:this[T].basePath,buildId:this[T].buildId,defaultLocale:this[T].options.forceLocale?void 0:this[T].defaultLocale,locale:this[T].locale,pathname:this[T].url.pathname,trailingSlash:this[T].trailingSlash})}formatSearch(){return this[T].url.search}get buildId(){return this[T].buildId}set buildId(e){this[T].buildId=e}get locale(){return this[T].locale??""}set locale(e){var r,n;if(!this[T].locale||!(!((n=this[T].options.nextConfig)==null||(r=n.i18n)==null)&&r.locales.includes(e)))throw new TypeError(`The NextURL configuration includes no locale "${e}"`);this[T].locale=e}get defaultLocale(){return this[T].defaultLocale}get domainLocale(){return this[T].domainLocale}get searchParams(){return this[T].url.searchParams}get host(){return this[T].url.host}set host(e){this[T].url.host=e}get hostname(){return this[T].url.hostname}set hostname(e){this[T].url.hostname=e}get port(){return this[T].url.port}set port(e){this[T].url.port=e}get protocol(){return this[T].url.protocol}set protocol(e){this[T].url.protocol=e}get href(){let e=this.formatPathname(),r=this.formatSearch();return`${this.protocol}//${this.host}${e}${r}${this.hash}`}set href(e){this[T].url=ne(e),this.analyze()}get origin(){return this[T].url.origin}get pathname(){return this[T].url.pathname}set pathname(e){this[T].url.pathname=e}get hash(){return this[T].url.hash}set hash(e){this[T].url.hash=e}get search(){return this[T].url.search}set search(e){this[T].url.search=e}get password(){return this[T].url.password}set password(e){this[T].url.password=e}get username(){return this[T].url.username}set username(e){this[T].url.username=e}get basePath(){return this[T].basePath}set basePath(e){this[T].basePath=e.startsWith("/")?e:`/${e}`}toString(){return this.href}toJSON(){return this.href}[Symbol.for("edge-runtime.inspect.custom")](){return{href:this.href,origin:this.origin,protocol:this.protocol,username:this.username,password:this.password,host:this.host,hostname:this.hostname,port:this.port,pathname:this.pathname,search:this.search,searchParams:this.searchParams,hash:this.hash}}clone(){return new de(String(this),this[T].options)}}var ve=D(1170);let Ae=Symbol("internal request");class mr extends Request{constructor(e,r={}){let n=typeof e!="string"&&"url"in e?e.url:String(e);m(n),e instanceof Request?super(e,r):super(n,r);let a=new de(n,{headers:g(this.headers),nextConfig:r.nextConfig});this[Ae]={cookies:new ve.RequestCookies(this.headers),geo:r.geo||{},ip:r.ip,nextUrl:a,url:a.toString()}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,geo:this.geo,ip:this.ip,nextUrl:this.nextUrl,url:this.url,bodyUsed:this.bodyUsed,cache:this.cache,credentials:this.credentials,destination:this.destination,headers:Object.fromEntries(this.headers),integrity:this.integrity,keepalive:this.keepalive,method:this.method,mode:this.mode,redirect:this.redirect,referrer:this.referrer,referrerPolicy:this.referrerPolicy,signal:this.signal}}get cookies(){return this[Ae].cookies}get geo(){return this[Ae].geo}get ip(){return this[Ae].ip}get nextUrl(){return this[Ae].nextUrl}get page(){throw new u}get ua(){throw new f}get url(){return this[Ae].url}}let ht=Symbol("internal response"),Er=new Set([301,302,303,307,308]);function ft(t,e){var r;if(!(t==null||(r=t.request)==null)&&r.headers){if(!(t.request.headers instanceof Headers))throw new Error("request.headers must be an instance of Headers");let n=[];for(let[a,o]of t.request.headers)e.set("x-middleware-request-"+a,o),n.push(a);e.set("x-middleware-override-headers",n.join(","))}}class re extends Response{constructor(e,r={}){super(e,r),this[ht]={cookies:new ve.ResponseCookies(this.headers),url:r.url?new de(r.url,{headers:g(this.headers),nextConfig:r.nextConfig}):void 0}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,url:this.url,body:this.body,bodyUsed:this.bodyUsed,headers:Object.fromEntries(this.headers),ok:this.ok,redirected:this.redirected,status:this.status,statusText:this.statusText,type:this.type}}get cookies(){return this[ht].cookies}static json(e,r){let n=Response.json(e,r);return new re(n.body,n)}static redirect(e,r){let n=typeof r=="number"?r:r?.status??307;if(!Er.has(n))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');let a=typeof r=="object"?r:{},o=new Headers(a?.headers);return o.set("Location",m(e)),new re(null,{...a,headers:o,status:n})}static rewrite(e,r){let n=new Headers(r?.headers);return n.set("x-middleware-rewrite",m(e)),ft(r,n),new re(null,{...r,headers:n})}static next(e){let r=new Headers(e?.headers);return r.set("x-middleware-next","1"),ft(e,r),new re(null,{...e,headers:r})}}function gt(t,e){let r=typeof e=="string"?new URL(e):e,n=new URL(t,e),a=r.protocol+"//"+r.host;return n.protocol+"//"+n.host===a?n.toString().replace(a,""):n.toString()}let yt="RSC",fa="Next-Action",mt="Next-Router-State-Tree",Et="Next-Router-Prefetch",wr="Next-Url",ga="text/x-component",ya=yt+", "+mt+", "+Et+", "+wr,wt=[[yt],[mt],[Et]],Sr="_rsc",ma="x-nextjs-postponed";var Ea=D(687);let Ue={client:"client",server:"server",edgeServer:"edge-server"},wa=null,Sa={[Ue.client]:0,[Ue.server]:1,[Ue.edgeServer]:2},_a="phase-export",ba="phase-production-build",va="phase-production-server",Aa="phase-development-server",Pa="phase-test",Ra="phase-info",Ca="pages-manifest.json",Ta="app-paths-manifest.json",Ia="app-path-routes-manifest.json",xa="build-manifest.json",Oa="app-build-manifest.json",Na="functions-config-manifest.json",Ma="subresource-integrity-manifest",Da="next-font-manifest",Ka="export-marker.json",La="export-detail.json",Wa="prerender-manifest.json",ka="routes-manifest.json",Ha="images-manifest.json",Ja="required-server-files.json",Ua="_devPagesManifest.json",Ba="middleware-manifest.json",$a="_devMiddlewareManifest.json",Fa="react-loadable-manifest.json",ja="font-manifest.json",Ga="server",Va=null,za="BUILD_ID",Xa=null,qa="public",Ya="static",Qa="__NEXT_DROP_CLIENT_FILE__",Za="__NEXT_BUILTIN_DOCUMENT__",es="__barrel_optimize__",ts="client-reference-manifest",rs="server-reference-manifest",ns="middleware-build-manifest",as="middleware-react-loadable-manifest",St="main",_r=""+St+"-app",ss="app-pages-internals",br="react-refresh",vr="amp",os="webpack",cs=Symbol("polyfills"),us="edge-runtime-webpack",ds="__N_SSG",ls="__N_SSP",ps="__PAGE__",fs=[{url:"https://fonts.googleapis.com/",preconnect:"https://fonts.gstatic.com"},{url:"https://use.typekit.net",preconnect:"https://use.typekit.net"}],gs={name:"Times New Roman",xAvgCharWidth:821,azAvgWidth:854.3953488372093,unitsPerEm:2048},ys={name:"Arial",xAvgCharWidth:904,azAvgWidth:934.5116279069767,unitsPerEm:2048},ms=null,Es=1,ws=6e3,Ss={client:"client",server:"server"},_s=null,bs=new Set([St,br,vr,_r]),_t=["__nextFallback","__nextLocale","__nextInferredLocaleFromDefault","__nextDefaultLocale","__nextIsNotFound",Sr],Ar=["__nextDataReq"];function vs(t){for(let e of _t)delete t[e]}function Pr(t,e){let r=typeof t=="string",n=r?new URL(t):t;for(let a of _t)n.searchParams.delete(a);if(e)for(let a of Ar)n.searchParams.delete(a);return r?n.toString():n}function As(t){for(let e of INTERNAL_HEADERS)delete t[e]}function Ps(t){return t.startsWith("/")?t:"/"+t}function Rs(t){return t[0]==="("&&t.endsWith(")")}function Cs(t){return ensureLeadingSlash(t.split("/").reduce((e,r,n,a)=>!r||isGroupSegment(r)||r[0]==="@"||(r==="page"||r==="route")&&n===a.length-1?e:e+"/"+r,""))}function Rr(t){return t.replace(/\.rsc($|\?)/,"$1")}let Be="nxtP",Cr="x-prerender-revalidate",Tr="x-prerender-revalidate-if-generated",Ts=".prefetch.rsc",Is=".rsc",xs=".json",Os=".meta",Ns=".body",Ms="x-next-cache-tags",Ds="x-next-cache-soft-tags",Ks="x-next-revalidated-tags",Ls="x-next-revalidate-tag-token",Ws=256,ks=1024,Hs="_N_T_",Js=31536e3,Us="middleware",Bs=null,$s="instrumentation",Fs="private-next-pages",js="private-dot-next",Gs="private-next-root-dir",Vs="private-next-app-dir",zs="private-next-rsc-mod-ref-proxy",Xs="private-next-rsc-action-validate",qs="private-next-rsc-action-proxy",Ys="private-next-rsc-action-encryption",Qs="private-next-rsc-action-client-wrapper",Zs=null,eo=null,to=null,ro=null,no=null,ao=null,so="Your `getStaticProps` function did not return an object. Did you forget to add a `return`?",oo="Your `getServerSideProps` function did not return an object. Did you forget to add a `return`?",io=null,co=null,uo=null,lo=null,po=null,ho=[{title:"Strict",recommended:!0,config:{extends:"next/core-web-vitals"}},{title:"Base",config:{extends:"next"}},{title:"Cancel",config:null}],fo={edge:"edge",experimentalEdge:"experimental-edge",nodejs:"nodejs"},oe={shared:"shared",reactServerComponents:"rsc",serverSideRendering:"ssr",actionBrowser:"action-browser",api:"api",middleware:"middleware",edgeAsset:"edge-asset",appPagesBrowser:"app-pages-browser",appMetadataRoute:"app-metadata-route",appRouteHandler:"app-route-handler"},go={...oe,GROUP:{server:[oe.reactServerComponents,oe.actionBrowser,oe.appMetadataRoute,oe.appRouteHandler],nonClientServerTarget:[oe.middleware,oe.api],app:[oe.reactServerComponents,oe.actionBrowser,oe.appMetadataRoute,oe.appRouteHandler,oe.serverSideRendering,oe.appPagesBrowser]}},yo={edgeSSREntry:"__next_edge_ssr_entry__",metadata:"__next_metadata__",metadataRoute:"__next_metadata_route__",metadataImageMeta:"__next_metadata_image_meta__"};class ue{static get(e,r,n){let a=Reflect.get(e,r,n);return typeof a=="function"?a.bind(e):a}static set(e,r,n,a){return Reflect.set(e,r,n,a)}static has(e,r){return Reflect.has(e,r)}static deleteProperty(e,r){return Reflect.deleteProperty(e,r)}}class $e extends Error{constructor(){super("Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers")}static callable(){throw new $e}}class Ee extends Headers{constructor(e){super(),this.headers=new Proxy(e,{get(r,n,a){if(typeof n=="symbol")return ue.get(r,n,a);let o=n.toLowerCase(),i=Object.keys(e).find(l=>l.toLowerCase()===o);if(!(typeof i>"u"))return ue.get(r,i,a)},set(r,n,a,o){if(typeof n=="symbol")return ue.set(r,n,a,o);let i=n.toLowerCase(),l=Object.keys(e).find(E=>E.toLowerCase()===i);return ue.set(r,l??n,a,o)},has(r,n){if(typeof n=="symbol")return ue.has(r,n);let a=n.toLowerCase(),o=Object.keys(e).find(i=>i.toLowerCase()===a);return typeof o>"u"?!1:ue.has(r,o)},deleteProperty(r,n){if(typeof n=="symbol")return ue.deleteProperty(r,n);let a=n.toLowerCase(),o=Object.keys(e).find(i=>i.toLowerCase()===a);return typeof o>"u"?!0:ue.deleteProperty(r,o)}})}static seal(e){return new Proxy(e,{get(r,n,a){switch(n){case"append":case"delete":case"set":return $e.callable;default:return ue.get(r,n,a)}}})}merge(e){return Array.isArray(e)?e.join(", "):e}static from(e){return e instanceof Headers?e:new Ee(e)}append(e,r){let n=this.headers[e];typeof n=="string"?this.headers[e]=[n,r]:Array.isArray(n)?n.push(r):this.headers[e]=r}delete(e){delete this.headers[e]}get(e){let r=this.headers[e];return typeof r<"u"?this.merge(r):null}has(e){return typeof this.headers[e]<"u"}set(e,r){this.headers[e]=r}forEach(e,r){for(let[n,a]of this.entries())e.call(r,a,n,this)}*entries(){for(let e of Object.keys(this.headers)){let r=e.toLowerCase(),n=this.get(r);yield[r,n]}}*keys(){for(let e of Object.keys(this.headers))yield e.toLowerCase()}*values(){for(let e of Object.keys(this.headers))yield this.get(e)}[Symbol.iterator](){return this.entries()}}class Fe extends Error{constructor(){super("Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#cookiessetname-value-options")}static callable(){throw new Fe}}class Ir{static seal(e){return new Proxy(e,{get(r,n,a){switch(n){case"clear":case"delete":case"set":return Fe.callable;default:return ue.get(r,n,a)}}})}}let bt=Symbol.for("next.mutated.cookies");function xr(t){let e=t[bt];return!e||!Array.isArray(e)||e.length===0?[]:e}function mo(t,e){let r=xr(e);if(r.length===0)return!1;let n=new ResponseCookies(t),a=n.getAll();for(let o of r)n.set(o);for(let o of a)n.set(o);return!0}class Or{static wrap(e,r){let n=new ve.ResponseCookies(new Headers);for(let l of e.getAll())n.set(l);let a=[],o=new Set,i=()=>{var l;let E=fetch.__nextGetStaticStore==null||(l=fetch.__nextGetStaticStore.call(fetch))==null?void 0:l.getStore();if(E&&(E.pathWasRevalidated=!0),a=n.getAll().filter(R=>o.has(R.name)),r){let R=[];for(let J of a){let N=new ve.ResponseCookies(new Headers);N.set(J),R.push(N.toString())}r(R)}};return new Proxy(n,{get(l,E,_){switch(E){case bt:return a;case"delete":return function(...R){o.add(typeof R[0]=="string"?R[0]:R[0].name);try{l.delete(...R)}finally{i()}};case"set":return function(...R){o.add(typeof R[0]=="string"?R[0]:R[0].name);try{return l.set(...R)}finally{i()}};default:return ue.get(l,E,_)}}})}}function Eo(t,e){return t.statusCode=e,t}function wo(t,e,r){if(typeof e=="string"&&(r=e,e=307),typeof e!="number"||typeof r!="string")throw new Error("Invalid redirect arguments. Please use a single argument URL, e.g. res.redirect('/destination') or use a status code and URL, e.g. res.redirect(307, '/destination').");return t.writeHead(e,{Location:r}),t.write(r),t.end(),t}function Nr(t,e){let r=Ee.from(t.headers),a=r.get(Cr)===e.previewModeId,o=r.has(Tr);return{isOnDemandRevalidate:a,revalidateOnlyGenerated:o}}let Ie="__prerender_bypass",vt="__next_preview_data",So=null,_o=Symbol(vt),At=Symbol(Ie);function bo(t,e={}){if(At in t)return t;let{serialize:r}=D(1053),n=t.getHeader("Set-Cookie");return t.setHeader("Set-Cookie",[...typeof n=="string"?[n]:Array.isArray(n)?n:[],r(Ie,"",{expires:new Date(0),httpOnly:!0,sameSite:"none",secure:!0,path:"/",...e.path!==void 0?{path:e.path}:void 0}),r(vt,"",{expires:new Date(0),httpOnly:!0,sameSite:"none",secure:!0,path:"/",...e.path!==void 0?{path:e.path}:void 0})]),Object.defineProperty(t,At,{value:!0,enumerable:!1}),t}class vo extends null{constructor(e,r){super(r),this.statusCode=e}}function Ao(t,e,r){t.statusCode=e,t.statusMessage=r,t.end(r)}function Po({req:t},e,r){let n={configurable:!0,enumerable:!0},a={...n,writable:!0};Object.defineProperty(t,e,{...n,get:()=>{let o=r();return Object.defineProperty(t,e,{...a,value:o}),o},set:o=>{Object.defineProperty(t,e,{...a,value:o})}})}class Mr{constructor(e,r,n,a){var o;let i=e&&Nr(r,e).isOnDemandRevalidate,l=(o=n.get(Ie))==null?void 0:o.value;this.isEnabled=Boolean(!i&&l&&e&&l===e.previewModeId),this._previewModeId=e?.previewModeId,this._mutableCookies=a}enable(){if(!this._previewModeId)throw new Error("Invariant: previewProps missing previewModeId this should never happen");this._mutableCookies.set({name:Ie,value:this._previewModeId,httpOnly:!0,sameSite:"none",secure:!0,path:"/"})}disable(){this._mutableCookies.set({name:Ie,value:"",httpOnly:!0,sameSite:"none",secure:!0,path:"/",expires:new Date(0)})}}function Dr(t){let e=Ee.from(t);for(let r of wt)e.delete(r.toString().toLowerCase());return Ee.seal(e)}function Kr(t){let e=new ve.RequestCookies(Ee.from(t));return Ir.seal(e)}function Lr(t,e){let r=new ve.RequestCookies(Ee.from(t));return Or.wrap(r,e)}let Wr={wrap(t,{req:e,res:r,renderOpts:n},a){let o;n&&"previewProps"in n&&(o=n.previewProps);function i(_){r&&r.setHeader("Set-Cookie",_)}let l={},E={get headers(){return l.headers||(l.headers=Dr(e.headers)),l.headers},get cookies(){return l.cookies||(l.cookies=Kr(e.headers)),l.cookies},get mutableCookies(){return l.mutableCookies||(l.mutableCookies=Lr(e.headers,n?.onUpdateCookies||(r?i:void 0))),l.mutableCookies},get draftMode(){return l.draftMode||(l.draftMode=new Mr(o,e,this.cookies,this.mutableCookies)),l.draftMode}};return t.run(E,a,E)}};var kr=D(9186);let Hr=(0,kr.P)();var Pt;(function(t){t.handleRequest="BaseServer.handleRequest",t.run="BaseServer.run",t.pipe="BaseServer.pipe",t.getStaticHTML="BaseServer.getStaticHTML",t.render="BaseServer.render",t.renderToResponseWithComponents="BaseServer.renderToResponseWithComponents",t.renderToResponse="BaseServer.renderToResponse",t.renderToHTML="BaseServer.renderToHTML",t.renderError="BaseServer.renderError",t.renderErrorToResponse="BaseServer.renderErrorToResponse",t.renderErrorToHTML="BaseServer.renderErrorToHTML",t.render404="BaseServer.render404"})(Pt||(Pt={}));var Rt;(function(t){t.loadDefaultErrorComponents="LoadComponents.loadDefaultErrorComponents",t.loadComponents="LoadComponents.loadComponents"})(Rt||(Rt={}));var Ct;(function(t){t.getRequestHandler="NextServer.getRequestHandler",t.getServer="NextServer.getServer",t.getServerRequestHandler="NextServer.getServerRequestHandler",t.createServer="createServer.createServer"})(Ct||(Ct={}));var Tt;(function(t){t.compression="NextNodeServer.compression",t.getBuildId="NextNodeServer.getBuildId",t.generateStaticRoutes="NextNodeServer.generateStaticRoutes",t.generateFsStaticRoutes="NextNodeServer.generateFsStaticRoutes",t.generatePublicRoutes="NextNodeServer.generatePublicRoutes",t.generateImageRoutes="NextNodeServer.generateImageRoutes.route",t.sendRenderResult="NextNodeServer.sendRenderResult",t.proxyRequest="NextNodeServer.proxyRequest",t.runApi="NextNodeServer.runApi",t.render="NextNodeServer.render",t.renderHTML="NextNodeServer.renderHTML",t.imageOptimizer="NextNodeServer.imageOptimizer",t.getPagePath="NextNodeServer.getPagePath",t.getRoutesManifest="NextNodeServer.getRoutesManifest",t.findPageComponents="NextNodeServer.findPageComponents",t.getFontManifest="NextNodeServer.getFontManifest",t.getServerComponentManifest="NextNodeServer.getServerComponentManifest",t.getRequestHandler="NextNodeServer.getRequestHandler",t.renderToHTML="NextNodeServer.renderToHTML",t.renderError="NextNodeServer.renderError",t.renderErrorToHTML="NextNodeServer.renderErrorToHTML",t.render404="NextNodeServer.render404",t.route="route",t.onProxyReq="onProxyReq",t.apiResolver="apiResolver",t.internalFetch="internalFetch"})(Tt||(Tt={}));var It;(function(t){t.startServer="startServer.startServer"})(It||(It={}));var xt;(function(t){t.getServerSideProps="Render.getServerSideProps",t.getStaticProps="Render.getStaticProps",t.renderToString="Render.renderToString",t.renderDocument="Render.renderDocument",t.createBodyResult="Render.createBodyResult"})(xt||(xt={}));var Ot;(function(t){t.renderToString="AppRender.renderToString",t.renderToReadableStream="AppRender.renderToReadableStream",t.getBodyResult="AppRender.getBodyResult",t.fetch="AppRender.fetch"})(Ot||(Ot={}));var Nt;(function(t){t.executeRoute="Router.executeRoute"})(Nt||(Nt={}));var Mt;(function(t){t.runHandler="Node.runHandler"})(Mt||(Mt={}));var Dt;(function(t){t.runHandler="AppRouteRouteHandlers.runHandler"})(Dt||(Dt={}));var Kt;(function(t){t.generateMetadata="ResolveMetadata.generateMetadata",t.generateViewport="ResolveMetadata.generateViewport"})(Kt||(Kt={}));let Lt=["BaseServer.handleRequest","Render.getServerSideProps","Render.getStaticProps","AppRender.fetch","AppRender.getBodyResult","Render.renderDocument","Node.runHandler","AppRouteRouteHandlers.runHandler","ResolveMetadata.generateMetadata","ResolveMetadata.generateViewport"],je;je=D(3016);let{context:he,propagation:Jr,trace:xe,SpanStatusCode:Ur,SpanKind:Ro,ROOT_CONTEXT:Br}=je,$r=t=>t!==null&&typeof t=="object"&&typeof t.then=="function",Ge=(t,e)=>{e?.bubble===!0?t.setAttribute("next.bubble",!0):(e&&t.recordException(e),t.setStatus({code:Ur.ERROR,message:e?.message})),t.end()},Ve=new Map,Wt=je.createContextKey("next.rootSpanId"),Fr=0,jr=()=>Fr++;class Gr{getTracerInstance(){return xe.getTracer("next.js","0.0.1")}getContext(){return he}getActiveScopeSpan(){return xe.getSpan(he?.active())}withPropagatedContext(e,r,n){let a=he.active();if(xe.getSpanContext(a))return r();let o=Jr.extract(a,e,n);return he.with(o,r)}trace(...e){var r;let[n,a,o]=e,{fn:i,options:l}=typeof a=="function"?{fn:a,options:{}}:{fn:o,options:{...a}};if(!Lt.includes(n)&&process.env.NEXT_OTEL_VERBOSE!=="1"||l.hideSpan)return i();let E=l.spanName??n,_=this.getSpanContext(l?.parentSpan??this.getActiveScopeSpan()),R=!1;_?(r=xe.getSpanContext(_))!=null&&r.isRemote&&(R=!0):(_=Br,R=!0);let J=jr();return l.attributes={"next.span_name":E,"next.span_type":n,...l.attributes},he.with(_.setValue(Wt,J),()=>this.getTracerInstance().startActiveSpan(E,l,N=>{let j=()=>{Ve.delete(J)};R&&Ve.set(J,new Map(Object.entries(l.attributes??{})));try{if(i.length>1)return i(N,X=>Ge(N,X));let B=i(N);return $r(B)?B.then(()=>N.end(),X=>Ge(N,X)).finally(j):(N.end(),j()),B}catch(B){throw Ge(N,B),j(),B}}))}wrap(...e){let r=this,[n,a,o]=e.length===3?e:[e[0],{},e[1]];return!Lt.includes(n)&&process.env.NEXT_OTEL_VERBOSE!=="1"?o:function(){let i=a;typeof i=="function"&&typeof o=="function"&&(i=i.apply(this,arguments));let l=arguments.length-1,E=arguments[l];if(typeof E=="function"){let _=r.getContext().bind(he.active(),E);return r.trace(n,i,(R,J)=>(arguments[l]=function(N){return J?.(N),_.apply(this,arguments)},o.apply(this,arguments)))}else return r.trace(n,i,()=>o.apply(this,arguments))}}startSpan(...e){let[r,n]=e,a=this.getSpanContext(n?.parentSpan??this.getActiveScopeSpan());return this.getTracerInstance().startSpan(r,n,a)}getSpanContext(e){return e?xe.setSpan(he.active(),e):void 0}getRootSpanAttributes(){let e=he.active().getValue(Wt);return Ve.get(e)}}let Vr=(()=>{let t=new Gr;return()=>t})();class zr extends mr{constructor(e){super(e.input,e.init),this.sourcePage=e.page}get request(){throw new d({page:this.sourcePage})}respondWith(){throw new d({page:this.sourcePage})}waitUntil(){throw new d({page:this.sourcePage})}}let Xr={keys:t=>Array.from(t.keys()),get:(t,e)=>t.get(e)??void 0},ze=(t,e)=>Vr().withPropagatedContext(t.headers,e,Xr),kt=!1;function qr(){if(!kt&&(kt=!0,process.env.NEXT_PRIVATE_TEST_PROXY==="true")){let{interceptTestApis:t,wrapRequestHandler:e}=D(3457);t(),ze=e(ze)}}async function Yr(t){qr(),await K();let e=typeof Y.__BUILD_MANIFEST<"u",r=typeof Y.__PRERENDER_MANIFEST=="string"?JSON.parse(Y.__PRERENDER_MANIFEST):void 0;t.request.url=Rr(t.request.url);let n=new de(t.request.url,{headers:t.request.headers,nextConfig:t.request.nextConfig}),a=[...n.searchParams.keys()];for(let V of a){let Q=n.searchParams.getAll(V);if(V!==Be&&V.startsWith(Be)){let ct=V.substring(Be.length);n.searchParams.delete(ct);for(let da of Q)n.searchParams.append(ct,da);n.searchParams.delete(V)}}let o=n.buildId;n.buildId="";let i=t.request.headers["x-nextjs-data"];i&&n.pathname==="/index"&&(n.pathname="/");let l=h(t.request.headers),E=new Map;if(!e)for(let V of wt){let Q=V.toString().toLowerCase();l.get(Q)&&(E.set(Q,l.get(Q)),l.delete(Q))}let _=n,R=new zr({page:t.page,input:Pr(_,!0).toString(),init:{body:t.request.body,geo:t.request.geo,headers:l,ip:t.request.ip,method:t.request.method,nextConfig:t.request.nextConfig,signal:t.request.signal}});i&&Object.defineProperty(R,"__isData",{enumerable:!1,value:!0}),!G.__incrementalCache&&t.IncrementalCache&&(G.__incrementalCache=new t.IncrementalCache({appDir:!0,fetchCache:!0,minimalMode:!0,fetchCacheKeyPrefix:void 0,dev:!1,requestHeaders:t.request.headers,requestProtocol:"https",getPrerenderManifest:()=>({version:-1,routes:{},dynamicRoutes:{},notFoundRoutes:[],preview:{previewModeId:"development-id"}})}));let J=new C({request:R,page:t.page}),N,j;if(N=await ze(R,()=>t.page==="/middleware"||t.page==="/src/middleware"?Wr.wrap(Hr,{req:R,renderOpts:{onUpdateCookies:Q=>{j=Q},previewProps:r?.preview||{previewModeId:"development-id",previewModeEncryptionKey:"",previewModeSigningKey:""}}},()=>t.handler(R,J)):t.handler(R,J)),N&&!(N instanceof Response))throw new TypeError("Expected an instance of Response to be returned");N&&j&&N.headers.set("set-cookie",j);let B=N?.headers.get("x-middleware-rewrite");if(N&&B){let V=new de(B,{forceLocale:!0,headers:t.request.headers,nextConfig:t.request.nextConfig});V.host===R.nextUrl.host&&(V.buildId=o||V.buildId,N.headers.set("x-middleware-rewrite",String(V)));let Q=gt(String(V),String(n));i&&N.headers.set("x-nextjs-rewrite",Q)}let X=N?.headers.get("Location");if(N&&X&&!e){let V=new de(X,{forceLocale:!1,headers:t.request.headers,nextConfig:t.request.nextConfig});N=new Response(N.body,N),V.host===R.nextUrl.host&&(V.buildId=o||V.buildId,N.headers.set("Location",String(V))),i&&(N.headers.delete("Location"),N.headers.set("x-nextjs-redirect",gt(String(V),String(n))))}let se=N||re.next(),Me=se.headers.get("x-middleware-override-headers"),Je=[];if(Me){for(let[V,Q]of E)se.headers.set(`x-middleware-request-${V}`,Q),Je.push(V);Je.length>0&&se.headers.set("x-middleware-override-headers",Me+","+Je.join(","))}return{response:se,waitUntil:Promise.all(J[v]),fetchMetrics:R.fetchMetrics}}let le=new TextEncoder,we=new TextDecoder,We=null;function Ht(...t){let e=t.reduce((a,{length:o})=>a+o,0),r=new Uint8Array(e),n=0;for(let a of t)r.set(a,n),n+=a.length;return r}function Xe(t,e,r){if(e<0||e>=We)throw new RangeError(`value must be >= 0 and <= ${We-1}. Received ${e}`);t.set([e>>>24,e>>>16,e>>>8,e&255],r)}function Co(t){let e=Math.floor(t/We),r=t%We,n=new Uint8Array(8);return Xe(n,e,0),Xe(n,r,4),n}function To(t){let e=new Uint8Array(4);return Xe(e,t),e}function Qr(t){if(Uint8Array.prototype.toBase64)return t.toBase64();let e=32768,r=[];for(let n=0;n<t.length;n+=e)r.push(String.fromCharCode.apply(null,t.subarray(n,n+e)));return btoa(r.join(""))}function Zr(t){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(t);let e=atob(t),r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return r}function ke(t){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(typeof t=="string"?t:we.decode(t),{alphabet:"base64url"});let e=t;e instanceof Uint8Array&&(e=we.decode(e)),e=e.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return Zr(e)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}}function qe(t){let e=t;return typeof e=="string"&&(e=le.encode(e)),Uint8Array.prototype.toBase64?e.toBase64({alphabet:"base64url",omitPadding:!0}):Qr(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}class ae extends Error{static{this.code="ERR_JOSE_GENERIC"}constructor(e,r){super(e,r),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class pe extends ae{static{this.code="ERR_JWT_CLAIM_VALIDATION_FAILED"}constructor(e,r,n="unspecified",a="unspecified"){super(e,{cause:{claim:n,reason:a,payload:r}}),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=n,this.reason=a,this.payload=r}}class Jt extends ae{static{this.code="ERR_JWT_EXPIRED"}constructor(e,r,n="unspecified",a="unspecified"){super(e,{cause:{claim:n,reason:a,payload:r}}),this.code="ERR_JWT_EXPIRED",this.claim=n,this.reason=a,this.payload=r}}class en extends ae{static{this.code="ERR_JOSE_ALG_NOT_ALLOWED"}constructor(...e){super(...e),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}}class Pe extends ae{static{this.code="ERR_JOSE_NOT_SUPPORTED"}constructor(...e){super(...e),this.code="ERR_JOSE_NOT_SUPPORTED"}}class Io extends ae{static{this.code="ERR_JWE_DECRYPTION_FAILED"}constructor(e="decryption operation failed",r){super(e,r),this.code="ERR_JWE_DECRYPTION_FAILED"}}class xo extends ae{static{this.code="ERR_JWE_INVALID"}constructor(...e){super(...e),this.code="ERR_JWE_INVALID"}}class q extends ae{static{this.code="ERR_JWS_INVALID"}constructor(...e){super(...e),this.code="ERR_JWS_INVALID"}}class Ye extends ae{static{this.code="ERR_JWT_INVALID"}constructor(...e){super(...e),this.code="ERR_JWT_INVALID"}}class Oo extends ae{static{this.code="ERR_JWK_INVALID"}constructor(...e){super(...e),this.code="ERR_JWK_INVALID"}}class No extends ae{static{this.code="ERR_JWKS_INVALID"}constructor(...e){super(...e),this.code="ERR_JWKS_INVALID"}}class Mo extends ae{static{this.code="ERR_JWKS_NO_MATCHING_KEY"}constructor(e="no applicable key found in the JSON Web Key Set",r){super(e,r),this.code="ERR_JWKS_NO_MATCHING_KEY"}}let tn;class Do extends ae{static{tn=Symbol.asyncIterator}static{this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS"}constructor(e="multiple matching keys found in the JSON Web Key Set",r){super(e,r),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS"}}class Ko extends ae{static{this.code="ERR_JWKS_TIMEOUT"}constructor(e="request timed out",r){super(e,r),this.code="ERR_JWKS_TIMEOUT"}}class rn extends ae{static{this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}constructor(e="signature verification failed",r){super(e,r),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}}function nn(t){switch(t){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new JOSENotSupported(`Unsupported JWE Algorithm: ${t}`)}}let Lo=t=>crypto.getRandomValues(new Uint8Array(nn(t)>>3)),Wo=(t,e)=>{if(e.length<<3!==bitLength(t))throw new JWEInvalid("Invalid Initialization Vector length")},ko=(t,e)=>{let r=t.byteLength<<3;if(r!==e)throw new JWEInvalid(`Invalid Content Encryption Key length. Expected ${e} bits, got ${r} bits`)};function te(t,e="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${e} must be ${t}`)}function fe(t,e){return t.name===e}function He(t){return parseInt(t.name.slice(4),10)}function an(t){switch(t){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}function Ut(t,e){if(e&&!t.usages.includes(e))throw new TypeError(`CryptoKey does not support this operation, its usages must include ${e}.`)}function sn(t,e,r){switch(e){case"HS256":case"HS384":case"HS512":{if(!fe(t.algorithm,"HMAC"))throw te("HMAC");let n=parseInt(e.slice(2),10);if(He(t.algorithm.hash)!==n)throw te(`SHA-${n}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!fe(t.algorithm,"RSASSA-PKCS1-v1_5"))throw te("RSASSA-PKCS1-v1_5");let n=parseInt(e.slice(2),10);if(He(t.algorithm.hash)!==n)throw te(`SHA-${n}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!fe(t.algorithm,"RSA-PSS"))throw te("RSA-PSS");let n=parseInt(e.slice(2),10);if(He(t.algorithm.hash)!==n)throw te(`SHA-${n}`,"algorithm.hash");break}case"Ed25519":case"EdDSA":{if(!fe(t.algorithm,"Ed25519"))throw te("Ed25519");break}case"ES256":case"ES384":case"ES512":{if(!fe(t.algorithm,"ECDSA"))throw te("ECDSA");let n=an(e);if(t.algorithm.namedCurve!==n)throw te(n,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}Ut(t,r)}function Ho(t,e,r){switch(e){case"A128GCM":case"A192GCM":case"A256GCM":{if(!fe(t.algorithm,"AES-GCM"))throw te("AES-GCM");let n=parseInt(e.slice(1,4),10);if(t.algorithm.length!==n)throw te(n,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!fe(t.algorithm,"AES-KW"))throw te("AES-KW");let n=parseInt(e.slice(1,4),10);if(t.algorithm.length!==n)throw te(n,"algorithm.length");break}case"ECDH":{switch(t.algorithm.name){case"ECDH":case"X25519":break;default:throw te("ECDH or X25519")}break}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!fe(t.algorithm,"PBKDF2"))throw te("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!fe(t.algorithm,"RSA-OAEP"))throw te("RSA-OAEP");let n=parseInt(e.slice(9),10)||1;if(He(t.algorithm.hash)!==n)throw te(`SHA-${n}`,"algorithm.hash");break}default:throw new TypeError("CryptoKey does not support this operation")}Ut(t,r)}function Bt(t,e,...r){if(r=r.filter(Boolean),r.length>2){let n=r.pop();t+=`one of type ${r.join(", ")}, or ${n}.`}else r.length===2?t+=`one of type ${r[0]} or ${r[1]}.`:t+=`of type ${r[0]}.`;return e==null?t+=` Received ${e}`:typeof e=="function"&&e.name?t+=` Received function ${e.name}`:typeof e=="object"&&e!=null&&e.constructor?.name&&(t+=` Received an instance of ${e.constructor.name}`),t}let on=(t,...e)=>Bt("Key must be ",t,...e);function $t(t,e,...r){return Bt(`Key for the ${t} algorithm must be `,e,...r)}function Jo(t){if(!Qe(t))throw new Error("CryptoKey instance expected")}function Qe(t){return t?.[Symbol.toStringTag]==="CryptoKey"}function Ft(t){return t?.[Symbol.toStringTag]==="KeyObject"}let jt=t=>Qe(t)||Ft(t);async function cn(t,e){if(!(t instanceof Uint8Array))throw new TypeError("First argument must be a buffer");if(!(e instanceof Uint8Array))throw new TypeError("Second argument must be a buffer");let r={name:"HMAC",hash:"SHA-256"},n=await crypto.subtle.generateKey(r,!1,["sign"]),a=new Uint8Array(await crypto.subtle.sign(r,n,t)),o=new Uint8Array(await crypto.subtle.sign(r,n,e)),i=0,l=-1;for(;++l<32;)i|=a[l]^o[l];return i===0}async function un(t,e,r,n,a,o){if(!(e instanceof Uint8Array))throw new TypeError(invalidKeyInput(e,"Uint8Array"));let i=parseInt(t.slice(1,4),10),l=await crypto.subtle.importKey("raw",e.subarray(i>>3),"AES-CBC",!1,["decrypt"]),E=await crypto.subtle.importKey("raw",e.subarray(0,i>>3),{hash:`SHA-${i<<1}`,name:"HMAC"},!1,["sign"]),_=concat(o,n,r,uint64be(o.length<<3)),R=new Uint8Array((await crypto.subtle.sign("HMAC",E,_)).slice(0,i>>3)),J;try{J=await cn(a,R)}catch{}if(!J)throw new JWEDecryptionFailed;let N;try{N=new Uint8Array(await crypto.subtle.decrypt({iv:n,name:"AES-CBC"},l,r))}catch{}if(!N)throw new JWEDecryptionFailed;return N}async function dn(t,e,r,n,a,o){let i;e instanceof Uint8Array?i=await crypto.subtle.importKey("raw",e,"AES-GCM",!1,["decrypt"]):(checkEncCryptoKey(e,t,"decrypt"),i=e);try{return new Uint8Array(await crypto.subtle.decrypt({additionalData:o,iv:n,name:"AES-GCM",tagLength:128},i,concat(r,a)))}catch{throw new JWEDecryptionFailed}}let Uo=async(t,e,r,n,a,o)=>{if(!isCryptoKey(e)&&!(e instanceof Uint8Array))throw new TypeError(invalidKeyInput(e,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));if(!n)throw new JWEInvalid("JWE Initialization Vector missing");if(!a)throw new JWEInvalid("JWE Authentication Tag missing");switch(checkIvLength(t,n),t){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return e instanceof Uint8Array&&checkCekLength(e,parseInt(t.slice(-3),10)),un(t,e,r,n,a,o);case"A128GCM":case"A192GCM":case"A256GCM":return e instanceof Uint8Array&&checkCekLength(e,parseInt(t.slice(1,4),10)),dn(t,e,r,n,a,o);default:throw new JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}},Gt=(...t)=>{let e=t.filter(Boolean);if(e.length===0||e.length===1)return!0;let r;for(let n of e){let a=Object.keys(n);if(!r||r.size===0){r=new Set(a);continue}for(let o of a){if(r.has(o))return!1;r.add(o)}}return!0};function ln(t){return typeof t=="object"&&t!==null}let Oe=t=>{if(!ln(t)||Object.prototype.toString.call(t)!=="[object Object]")return!1;if(Object.getPrototypeOf(t)===null)return!0;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e};function Vt(t,e){if(t.algorithm.length!==parseInt(e.slice(1,4),10))throw new TypeError(`Invalid key size for alg: ${e}`)}function zt(t,e,r){return t instanceof Uint8Array?crypto.subtle.importKey("raw",t,"AES-KW",!0,[r]):(checkEncCryptoKey(t,e,r),t)}async function Bo(t,e,r){let n=await zt(e,t,"wrapKey");Vt(n,t);let a=await crypto.subtle.importKey("raw",r,{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.wrapKey("raw",a,n,"AES-KW"))}async function $o(t,e,r){let n=await zt(e,t,"unwrapKey");Vt(n,t);let a=await crypto.subtle.unwrapKey("raw",r,n,"AES-KW",{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.exportKey("raw",a))}let Fo=async(t,e)=>{let r=`SHA-${t.slice(-3)}`;return new Uint8Array(await crypto.subtle.digest(r,e))};function Ze(t){return concat(uint32be(t.length),t)}async function pn(t,e,r){let n=Math.ceil((e>>3)/32),a=new Uint8Array(n*32);for(let o=0;o<n;o++){let i=new Uint8Array(4+t.length+r.length);i.set(uint32be(o+1)),i.set(t,4),i.set(r,4+t.length),a.set(await digest("sha256",i),o*32)}return a.slice(0,e>>3)}async function jo(t,e,r,n,a=new Uint8Array(0),o=new Uint8Array(0)){checkEncCryptoKey(t,"ECDH"),checkEncCryptoKey(e,"ECDH","deriveBits");let i=concat(Ze(encoder.encode(r)),Ze(a),Ze(o),uint32be(n)),l;t.algorithm.name==="X25519"?l=256:l=Math.ceil(parseInt(t.algorithm.namedCurve.slice(-3),10)/8)<<3;let E=new Uint8Array(await crypto.subtle.deriveBits({name:t.algorithm.name,public:t},e,l));return pn(E,n,i)}function Go(t){switch(t.algorithm.namedCurve){case"P-256":case"P-384":case"P-521":return!0;default:return t.algorithm.name==="X25519"}}function hn(t,e){return t instanceof Uint8Array?crypto.subtle.importKey("raw",t,"PBKDF2",!1,["deriveBits"]):(checkEncCryptoKey(t,e,"deriveBits"),t)}let fn=(t,e)=>concat(encoder.encode(t),new Uint8Array([0]),e);async function Xt(t,e,r,n){if(!(t instanceof Uint8Array)||t.length<8)throw new JWEInvalid("PBES2 Salt Input must be 8 or more octets");let a=fn(e,t),o=parseInt(e.slice(13,16),10),i={hash:`SHA-${e.slice(8,11)}`,iterations:r,name:"PBKDF2",salt:a},l=await hn(n,e);return new Uint8Array(await crypto.subtle.deriveBits(i,l,o))}async function Vo(t,e,r,n=2048,a=crypto.getRandomValues(new Uint8Array(16))){let o=await Xt(a,t,n,e);return{encryptedKey:await aeskw.wrap(t.slice(-6),o,r),p2c:n,p2s:b64u(a)}}async function zo(t,e,r,n,a){let o=await Xt(a,t,n,e);return aeskw.unwrap(t.slice(-6),o,r)}let qt=(t,e)=>{if(t.startsWith("RS")||t.startsWith("PS")){let{modulusLength:r}=e.algorithm;if(typeof r!="number"||r<2048)throw new TypeError(`${t} requires key modulusLength to be 2048 bits or larger`)}},Yt=t=>{switch(t){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new JOSENotSupported(`alg ${t} is not supported either by JOSE or your javascript runtime`)}};async function Xo(t,e,r){return checkEncCryptoKey(e,t,"encrypt"),checkKeyLength(t,e),new Uint8Array(await crypto.subtle.encrypt(Yt(t),e,r))}async function qo(t,e,r){return checkEncCryptoKey(e,t,"decrypt"),checkKeyLength(t,e),new Uint8Array(await crypto.subtle.decrypt(Yt(t),e,r))}function gn(t){switch(t){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new JOSENotSupported(`Unsupported JWE Algorithm: ${t}`)}}let Yo=t=>crypto.getRandomValues(new Uint8Array(gn(t)>>3)),yn=(t,e)=>{let r=(t.match(/.{1,64}/g)||[]).join(`
`);return`-----BEGIN ${e}-----
${r}
-----END ${e}-----`},Qt=async(t,e,r)=>{if(isKeyObject(r)){if(r.type!==t)throw new TypeError(`key is not a ${t} key`);return r.export({format:"pem",type:e})}if(!isCryptoKey(r))throw new TypeError(invalidKeyInput(r,"CryptoKey","KeyObject"));if(!r.extractable)throw new TypeError("CryptoKey is not extractable");if(r.type!==t)throw new TypeError(`key is not a ${t} key`);return yn(encodeBase64(new Uint8Array(await crypto.subtle.exportKey(e,r))),`${t.toUpperCase()} KEY`)},Qo=t=>Qt("public","spki",t),Zo=t=>Qt("private","pkcs8",t),mn=t=>{let e=Object.entries({"P-256":[6,8,42,134,72,206,61,3,1,7],"P-384":[6,5,43,129,4,0,34],"P-521":[6,5,43,129,4,0,35]}),r=Math.max(...e.map(([,n])=>n.length));for(let n=0;n<=t.byteLength-r;n++)for(let[a,o]of e)if(n<=t.byteLength-o.length&&t.subarray(n,n+o.length).every((i,l)=>i===o[l]))return a},et=async(t,e,r,n)=>{let a,o,i=t==="spki",l=()=>i?["verify"]:["sign"],E=()=>i?["encrypt","wrapKey"]:["decrypt","unwrapKey"];switch(r){case"PS256":case"PS384":case"PS512":a={name:"RSA-PSS",hash:`SHA-${r.slice(-3)}`},o=l();break;case"RS256":case"RS384":case"RS512":a={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${r.slice(-3)}`},o=l();break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":a={name:"RSA-OAEP",hash:`SHA-${parseInt(r.slice(-3),10)||1}`},o=E();break;case"ES256":case"ES384":case"ES512":{a={name:"ECDSA",namedCurve:{ES256:"P-256",ES384:"P-384",ES512:"P-521"}[r]},o=l();break}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let _=mn(e);a=_?{name:"ECDH",namedCurve:_}:{name:"X25519"},o=i?[]:["deriveBits"];break}case"Ed25519":case"EdDSA":a={name:"Ed25519"},o=l();break;default:throw new JOSENotSupported('Invalid or unsupported "alg" (Algorithm) value')}return crypto.subtle.importKey(t,e,a,n?.extractable??!!i,o)},ei=(t,e,r)=>{let n=decodeBase64(t.replace(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,""));return et("pkcs8",n,e,r)},ti=(t,e,r)=>{let n=decodeBase64(t.replace(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,""));return et("spki",n,e,r)};function En(t){let e=0,r=()=>{let i=t[e++];if(i&128){let l=i&127,E=0;for(let _=0;_<l;_++)E=E<<8|t[e++];return E}return i},n=(i=1)=>{if(i<=0)return;e++;let l=r();e+=l,i>1&&n(i-1)};if(t[e++]!==48)throw new Error("Invalid certificate structure");if(r(),t[e++]!==48)throw new Error("Invalid tbsCertificate structure");r(),t[e]===160?n(6):n(5);let a=e;if(t[e++]!==48)throw new Error("Invalid SPKI structure");let o=r();return t.subarray(a,a+o+(e-a))}function wn(t){let e=t.replace(/(?:-----(?:BEGIN|END) CERTIFICATE-----|\s)/g,""),r=decodeBase64(e);return En(r)}let ri=(t,e,r)=>{let n;try{n=wn(t)}catch(a){throw new TypeError("Failed to parse the X.509 certificate",{cause:a})}return et("spki",n,e,r)};function Sn(t){let e,r;switch(t.kty){case"RSA":{switch(t.alg){case"PS256":case"PS384":case"PS512":e={name:"RSA-PSS",hash:`SHA-${t.alg.slice(-3)}`},r=t.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":e={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${t.alg.slice(-3)}`},r=t.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":e={name:"RSA-OAEP",hash:`SHA-${parseInt(t.alg.slice(-3),10)||1}`},r=t.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new Pe('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"EC":{switch(t.alg){case"ES256":e={name:"ECDSA",namedCurve:"P-256"},r=t.d?["sign"]:["verify"];break;case"ES384":e={name:"ECDSA",namedCurve:"P-384"},r=t.d?["sign"]:["verify"];break;case"ES512":e={name:"ECDSA",namedCurve:"P-521"},r=t.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":e={name:"ECDH",namedCurve:t.crv},r=t.d?["deriveBits"]:[];break;default:throw new Pe('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"OKP":{switch(t.alg){case"Ed25519":case"EdDSA":e={name:"Ed25519"},r=t.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":e={name:t.crv},r=t.d?["deriveBits"]:[];break;default:throw new Pe('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}default:throw new Pe('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:e,keyUsages:r}}let _n=async t=>{if(!t.alg)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');let{algorithm:e,keyUsages:r}=Sn(t),n={...t};return delete n.alg,delete n.use,crypto.subtle.importKey("jwk",n,e,t.ext??!t.d,t.key_ops??r)};async function ni(t,e,r){if(typeof t!="string"||t.indexOf("-----BEGIN PUBLIC KEY-----")!==0)throw new TypeError('"spki" must be SPKI formatted string');return fromSPKI(t,e,r)}async function ai(t,e,r){if(typeof t!="string"||t.indexOf("-----BEGIN CERTIFICATE-----")!==0)throw new TypeError('"x509" must be X.509 formatted string');return fromX509(t,e,r)}async function si(t,e,r){if(typeof t!="string"||t.indexOf("-----BEGIN PRIVATE KEY-----")!==0)throw new TypeError('"pkcs8" must be PKCS#8 formatted string');return fromPKCS8(t,e,r)}async function oi(t,e,r){if(!isObject(t))throw new TypeError("JWK must be an object");let n;switch(e??=t.alg,n??=r?.extractable??t.ext,t.kty){case"oct":if(typeof t.k!="string"||!t.k)throw new TypeError('missing "k" (Key Value) Parameter value');return decodeBase64URL(t.k);case"RSA":if("oth"in t&&t.oth!==void 0)throw new JOSENotSupported('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return toCryptoKey({...t,alg:e,ext:n});default:throw new JOSENotSupported('Unsupported "kty" (Key Type) Parameter value')}}async function bn(t,e,r,n,a){if(!(r instanceof Uint8Array))throw new TypeError(invalidKeyInput(r,"Uint8Array"));let o=parseInt(t.slice(1,4),10),i=await crypto.subtle.importKey("raw",r.subarray(o>>3),"AES-CBC",!1,["encrypt"]),l=await crypto.subtle.importKey("raw",r.subarray(0,o>>3),{hash:`SHA-${o<<1}`,name:"HMAC"},!1,["sign"]),E=new Uint8Array(await crypto.subtle.encrypt({iv:n,name:"AES-CBC"},i,e)),_=concat(a,n,E,uint64be(a.length<<3)),R=new Uint8Array((await crypto.subtle.sign("HMAC",l,_)).slice(0,o>>3));return{ciphertext:E,tag:R,iv:n}}async function vn(t,e,r,n,a){let o;r instanceof Uint8Array?o=await crypto.subtle.importKey("raw",r,"AES-GCM",!1,["encrypt"]):(checkEncCryptoKey(r,t,"encrypt"),o=r);let i=new Uint8Array(await crypto.subtle.encrypt({additionalData:a,iv:n,name:"AES-GCM",tagLength:128},o,e)),l=i.slice(-16);return{ciphertext:i.slice(0,-16),tag:l,iv:n}}let ii=async(t,e,r,n,a)=>{if(!isCryptoKey(r)&&!(r instanceof Uint8Array))throw new TypeError(invalidKeyInput(r,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));switch(n?checkIvLength(t,n):n=generateIv(t),t){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return r instanceof Uint8Array&&checkCekLength(r,parseInt(t.slice(-3),10)),bn(t,e,r,n,a);case"A128GCM":case"A192GCM":case"A256GCM":return r instanceof Uint8Array&&checkCekLength(r,parseInt(t.slice(1,4),10)),vn(t,e,r,n,a);default:throw new JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}};async function ci(t,e,r,n){let a=t.slice(0,7),o=await encrypt(a,r,e,n,new Uint8Array(0));return{encryptedKey:o.ciphertext,iv:b64u(o.iv),tag:b64u(o.tag)}}async function ui(t,e,r,n,a){let o=t.slice(0,7);return decrypt(o,e,r,n,a,new Uint8Array(0))}let di=async(t,e,r,n,a)=>{switch(t){case"dir":{if(r!==void 0)throw new JWEInvalid("Encountered unexpected JWE Encrypted Key");return e}case"ECDH-ES":if(r!==void 0)throw new JWEInvalid("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!isObject(n.epk))throw new JWEInvalid('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(assertCryptoKey(e),!ecdhes.allowed(e))throw new JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let o=await importJWK(n.epk,t);assertCryptoKey(o);let i,l;if(n.apu!==void 0){if(typeof n.apu!="string")throw new JWEInvalid('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{i=b64u(n.apu)}catch{throw new JWEInvalid("Failed to base64url decode the apu")}}if(n.apv!==void 0){if(typeof n.apv!="string")throw new JWEInvalid('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{l=b64u(n.apv)}catch{throw new JWEInvalid("Failed to base64url decode the apv")}}let E=await ecdhes.deriveKey(o,e,t==="ECDH-ES"?n.enc:t,t==="ECDH-ES"?cekLength(n.enc):parseInt(t.slice(-5,-2),10),i,l);if(t==="ECDH-ES")return E;if(r===void 0)throw new JWEInvalid("JWE Encrypted Key missing");return aeskw.unwrap(t.slice(-6),E,r)}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(r===void 0)throw new JWEInvalid("JWE Encrypted Key missing");return assertCryptoKey(e),rsaes.decrypt(t,e,r)}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{if(r===void 0)throw new JWEInvalid("JWE Encrypted Key missing");if(typeof n.p2c!="number")throw new JWEInvalid('JOSE Header "p2c" (PBES2 Count) missing or invalid');let o=a?.maxPBES2Count||1e4;if(n.p2c>o)throw new JWEInvalid('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if(typeof n.p2s!="string")throw new JWEInvalid('JOSE Header "p2s" (PBES2 Salt) missing or invalid');let i;try{i=b64u(n.p2s)}catch{throw new JWEInvalid("Failed to base64url decode the p2s")}return pbes2kw.unwrap(t,e,r,n.p2c,i)}case"A128KW":case"A192KW":case"A256KW":{if(r===void 0)throw new JWEInvalid("JWE Encrypted Key missing");return aeskw.unwrap(t,e,r)}case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{if(r===void 0)throw new JWEInvalid("JWE Encrypted Key missing");if(typeof n.iv!="string")throw new JWEInvalid('JOSE Header "iv" (Initialization Vector) missing or invalid');if(typeof n.tag!="string")throw new JWEInvalid('JOSE Header "tag" (Authentication Tag) missing or invalid');let o;try{o=b64u(n.iv)}catch{throw new JWEInvalid("Failed to base64url decode the iv")}let i;try{i=b64u(n.tag)}catch{throw new JWEInvalid("Failed to base64url decode the tag")}return aesGcmKw(t,e,r,o,i)}default:throw new JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}},Zt=(t,e,r,n,a)=>{if(a.crit!==void 0&&n?.crit===void 0)throw new t('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||n.crit===void 0)return new Set;if(!Array.isArray(n.crit)||n.crit.length===0||n.crit.some(i=>typeof i!="string"||i.length===0))throw new t('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let o;r!==void 0?o=new Map([...Object.entries(r),...e.entries()]):o=e;for(let i of n.crit){if(!o.has(i))throw new Pe(`Extension Header Parameter "${i}" is not recognized`);if(a[i]===void 0)throw new t(`Extension Header Parameter "${i}" is missing`);if(o.get(i)&&n[i]===void 0)throw new t(`Extension Header Parameter "${i}" MUST be integrity protected`)}return new Set(n.crit)},An=(t,e)=>{if(e!==void 0&&(!Array.isArray(e)||e.some(r=>typeof r!="string")))throw new TypeError(`"${t}" option must be an array of strings`);if(!!e)return new Set(e)};function tt(t){return Oe(t)&&typeof t.kty=="string"}function Pn(t){return t.kty!=="oct"&&typeof t.d=="string"}function Rn(t){return t.kty!=="oct"&&typeof t.d>"u"}function Cn(t){return t.kty==="oct"&&typeof t.k=="string"}let Re,er=async(t,e,r,n=!1)=>{Re||=new WeakMap;let a=Re.get(t);if(a?.[r])return a[r];let o=await _n({...e,alg:r});return n&&Object.freeze(t),a?a[r]=o:Re.set(t,{[r]:o}),o},Tn=(t,e)=>{Re||=new WeakMap;let r=Re.get(t);if(r?.[e])return r[e];let n=t.type==="public",a=!!n,o;if(t.asymmetricKeyType==="x25519"){switch(e){case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":break;default:throw new TypeError("given KeyObject instance cannot be used for this algorithm")}o=t.toCryptoKey(t.asymmetricKeyType,a,n?[]:["deriveBits"])}if(t.asymmetricKeyType==="ed25519"){if(e!=="EdDSA"&&e!=="Ed25519")throw new TypeError("given KeyObject instance cannot be used for this algorithm");o=t.toCryptoKey(t.asymmetricKeyType,a,[n?"verify":"sign"])}if(t.asymmetricKeyType==="rsa"){let i;switch(e){case"RSA-OAEP":i="SHA-1";break;case"RS256":case"PS256":case"RSA-OAEP-256":i="SHA-256";break;case"RS384":case"PS384":case"RSA-OAEP-384":i="SHA-384";break;case"RS512":case"PS512":case"RSA-OAEP-512":i="SHA-512";break;default:throw new TypeError("given KeyObject instance cannot be used for this algorithm")}if(e.startsWith("RSA-OAEP"))return t.toCryptoKey({name:"RSA-OAEP",hash:i},a,n?["encrypt"]:["decrypt"]);o=t.toCryptoKey({name:e.startsWith("PS")?"RSA-PSS":"RSASSA-PKCS1-v1_5",hash:i},a,[n?"verify":"sign"])}if(t.asymmetricKeyType==="ec"){let l=new Map([["prime256v1","P-256"],["secp384r1","P-384"],["secp521r1","P-521"]]).get(t.asymmetricKeyDetails?.namedCurve);if(!l)throw new TypeError("given KeyObject instance cannot be used for this algorithm");e==="ES256"&&l==="P-256"&&(o=t.toCryptoKey({name:"ECDSA",namedCurve:l},a,[n?"verify":"sign"])),e==="ES384"&&l==="P-384"&&(o=t.toCryptoKey({name:"ECDSA",namedCurve:l},a,[n?"verify":"sign"])),e==="ES512"&&l==="P-521"&&(o=t.toCryptoKey({name:"ECDSA",namedCurve:l},a,[n?"verify":"sign"])),e.startsWith("ECDH-ES")&&(o=t.toCryptoKey({name:"ECDH",namedCurve:l},a,n?[]:["deriveBits"]))}if(!o)throw new TypeError("given KeyObject instance cannot be used for this algorithm");return r?r[e]=o:Re.set(t,{[e]:o}),o},tr=async(t,e)=>{if(t instanceof Uint8Array||Qe(t))return t;if(Ft(t)){if(t.type==="secret")return t.export();if("toCryptoKey"in t&&typeof t.toCryptoKey=="function")try{return Tn(t,e)}catch(n){if(n instanceof TypeError)throw n}let r=t.export({format:"jwk"});return er(t,r,e)}if(tt(t))return t.k?ke(t.k):er(t,t,e,!0);throw new Error("unreachable")},Ce=t=>t?.[Symbol.toStringTag],rt=(t,e,r)=>{if(e.use!==void 0){let n;switch(r){case"sign":case"verify":n="sig";break;case"encrypt":case"decrypt":n="enc";break}if(e.use!==n)throw new TypeError(`Invalid key for this operation, its "use" must be "${n}" when present`)}if(e.alg!==void 0&&e.alg!==t)throw new TypeError(`Invalid key for this operation, its "alg" must be "${t}" when present`);if(Array.isArray(e.key_ops)){let n;switch(!0){case(r==="sign"||r==="verify"):case t==="dir":case t.includes("CBC-HS"):n=r;break;case t.startsWith("PBES2"):n="deriveBits";break;case/^A\d{3}(?:GCM)?(?:KW)?$/.test(t):!t.includes("GCM")&&t.endsWith("KW")?n=r==="encrypt"?"wrapKey":"unwrapKey":n=r;break;case(r==="encrypt"&&t.startsWith("RSA")):n="wrapKey";break;case r==="decrypt":n=t.startsWith("RSA")?"unwrapKey":"deriveBits";break}if(n&&e.key_ops?.includes?.(n)===!1)throw new TypeError(`Invalid key for this operation, its "key_ops" must include "${n}" when present`)}return!0},In=(t,e,r)=>{if(!(e instanceof Uint8Array)){if(tt(e)){if(Cn(e)&&rt(t,e,r))return;throw new TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!jt(e))throw new TypeError($t(t,e,"CryptoKey","KeyObject","JSON Web Key","Uint8Array"));if(e.type!=="secret")throw new TypeError(`${Ce(e)} instances for symmetric algorithms must be of type "secret"`)}},xn=(t,e,r)=>{if(tt(e))switch(r){case"decrypt":case"sign":if(Pn(e)&&rt(t,e,r))return;throw new TypeError("JSON Web Key for this operation be a private JWK");case"encrypt":case"verify":if(Rn(e)&&rt(t,e,r))return;throw new TypeError("JSON Web Key for this operation be a public JWK")}if(!jt(e))throw new TypeError($t(t,e,"CryptoKey","KeyObject","JSON Web Key"));if(e.type==="secret")throw new TypeError(`${Ce(e)} instances for asymmetric algorithms must not be of type "secret"`);if(e.type==="public")switch(r){case"sign":throw new TypeError(`${Ce(e)} instances for asymmetric algorithm signing must be of type "private"`);case"decrypt":throw new TypeError(`${Ce(e)} instances for asymmetric algorithm decryption must be of type "private"`);default:break}if(e.type==="private")switch(r){case"verify":throw new TypeError(`${Ce(e)} instances for asymmetric algorithm verifying must be of type "public"`);case"encrypt":throw new TypeError(`${Ce(e)} instances for asymmetric algorithm encryption must be of type "public"`);default:break}},rr=(t,e,r)=>{t.startsWith("HS")||t==="dir"||t.startsWith("PBES2")||/^A(?:128|192|256)(?:GCM)?(?:KW)?$/.test(t)||/^A(?:128|192|256)CBC-HS(?:256|384|512)$/.test(t)?In(t,e,r):xn(t,e,r)};async function li(t,e,r){if(!isObject(t))throw new JWEInvalid("Flattened JWE must be an object");if(t.protected===void 0&&t.header===void 0&&t.unprotected===void 0)throw new JWEInvalid("JOSE Header missing");if(t.iv!==void 0&&typeof t.iv!="string")throw new JWEInvalid("JWE Initialization Vector incorrect type");if(typeof t.ciphertext!="string")throw new JWEInvalid("JWE Ciphertext missing or incorrect type");if(t.tag!==void 0&&typeof t.tag!="string")throw new JWEInvalid("JWE Authentication Tag incorrect type");if(t.protected!==void 0&&typeof t.protected!="string")throw new JWEInvalid("JWE Protected Header incorrect type");if(t.encrypted_key!==void 0&&typeof t.encrypted_key!="string")throw new JWEInvalid("JWE Encrypted Key incorrect type");if(t.aad!==void 0&&typeof t.aad!="string")throw new JWEInvalid("JWE AAD incorrect type");if(t.header!==void 0&&!isObject(t.header))throw new JWEInvalid("JWE Shared Unprotected Header incorrect type");if(t.unprotected!==void 0&&!isObject(t.unprotected))throw new JWEInvalid("JWE Per-Recipient Unprotected Header incorrect type");let n;if(t.protected)try{let Q=b64u(t.protected);n=JSON.parse(decoder.decode(Q))}catch{throw new JWEInvalid("JWE Protected Header is invalid")}if(!isDisjoint(n,t.header,t.unprotected))throw new JWEInvalid("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let a={...n,...t.header,...t.unprotected};if(validateCrit(JWEInvalid,new Map,r?.crit,n,a),a.zip!==void 0)throw new JOSENotSupported('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:o,enc:i}=a;if(typeof o!="string"||!o)throw new JWEInvalid("missing JWE Algorithm (alg) in JWE Header");if(typeof i!="string"||!i)throw new JWEInvalid("missing JWE Encryption Algorithm (enc) in JWE Header");let l=r&&validateAlgorithms("keyManagementAlgorithms",r.keyManagementAlgorithms),E=r&&validateAlgorithms("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(l&&!l.has(o)||!l&&o.startsWith("PBES2"))throw new JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter value not allowed');if(E&&!E.has(i))throw new JOSEAlgNotAllowed('"enc" (Encryption Algorithm) Header Parameter value not allowed');let _;if(t.encrypted_key!==void 0)try{_=b64u(t.encrypted_key)}catch{throw new JWEInvalid("Failed to base64url decode the encrypted_key")}let R=!1;typeof e=="function"&&(e=await e(n,t),R=!0),checkKeyType(o==="dir"?i:o,e,"decrypt");let J=await normalizeKey(e,o),N;try{N=await decryptKeyManagement(o,J,_,a,r)}catch(Q){if(Q instanceof TypeError||Q instanceof JWEInvalid||Q instanceof JOSENotSupported)throw Q;N=generateCek(i)}let j,B;if(t.iv!==void 0)try{j=b64u(t.iv)}catch{throw new JWEInvalid("Failed to base64url decode the iv")}if(t.tag!==void 0)try{B=b64u(t.tag)}catch{throw new JWEInvalid("Failed to base64url decode the tag")}let X=encoder.encode(t.protected??""),se;t.aad!==void 0?se=concat(X,encoder.encode("."),encoder.encode(t.aad)):se=X;let Me;try{Me=b64u(t.ciphertext)}catch{throw new JWEInvalid("Failed to base64url decode the ciphertext")}let V={plaintext:await decrypt(i,N,Me,j,B,se)};if(t.protected!==void 0&&(V.protectedHeader=n),t.aad!==void 0)try{V.additionalAuthenticatedData=b64u(t.aad)}catch{throw new JWEInvalid("Failed to base64url decode the aad")}return t.unprotected!==void 0&&(V.sharedUnprotectedHeader=t.unprotected),t.header!==void 0&&(V.unprotectedHeader=t.header),R?{...V,key:J}:V}async function pi(t,e,r){if(t instanceof Uint8Array&&(t=decoder.decode(t)),typeof t!="string")throw new JWEInvalid("Compact JWE must be a string or Uint8Array");let{0:n,1:a,2:o,3:i,4:l,length:E}=t.split(".");if(E!==5)throw new JWEInvalid("Invalid Compact JWE");let _=await flattenedDecrypt({ciphertext:i,iv:o||void 0,protected:n,tag:l||void 0,encrypted_key:a||void 0},e,r),R={plaintext:_.plaintext,protectedHeader:_.protectedHeader};return typeof e=="function"?{...R,key:_.key}:R}async function hi(t,e,r){if(!isObject(t))throw new JWEInvalid("General JWE must be an object");if(!Array.isArray(t.recipients)||!t.recipients.every(isObject))throw new JWEInvalid("JWE Recipients missing or incorrect type");if(!t.recipients.length)throw new JWEInvalid("JWE Recipients has no members");for(let n of t.recipients)try{return await flattenedDecrypt({aad:t.aad,ciphertext:t.ciphertext,encrypted_key:n.encrypted_key,header:n.header,iv:t.iv,protected:t.protected,tag:t.tag,unprotected:t.unprotected},e,r)}catch{}throw new JWEDecryptionFailed}let fi=Symbol();async function gi(t){if(isKeyObject(t))if(t.type==="secret")t=t.export();else return t.export({format:"jwk"});if(t instanceof Uint8Array)return{kty:"oct",k:b64u(t)};if(!isCryptoKey(t))throw new TypeError(invalidKeyInput(t,"CryptoKey","KeyObject","Uint8Array"));if(!t.extractable)throw new TypeError("non-extractable CryptoKey cannot be exported as a JWK");let{ext:e,key_ops:r,alg:n,use:a,...o}=await crypto.subtle.exportKey("jwk",t);return o}async function yi(t){return exportPublic(t)}async function mi(t){return exportPrivate(t)}async function Ei(t){return keyToJWK(t)}let wi=async(t,e,r,n,a={})=>{let o,i,l;switch(t){case"dir":{l=r;break}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(assertCryptoKey(r),!ecdhes.allowed(r))throw new JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:E,apv:_}=a,R;a.epk?R=await normalizeKey(a.epk,t):R=(await crypto.subtle.generateKey(r.algorithm,!0,["deriveBits"])).privateKey;let{x:J,y:N,crv:j,kty:B}=await exportJWK(R),X=await ecdhes.deriveKey(r,R,t==="ECDH-ES"?e:t,t==="ECDH-ES"?cekLength(e):parseInt(t.slice(-5,-2),10),E,_);if(i={epk:{x:J,crv:j,kty:B}},B==="EC"&&(i.epk.y=N),E&&(i.apu=b64u(E)),_&&(i.apv=b64u(_)),t==="ECDH-ES"){l=X;break}l=n||generateCek(e);let se=t.slice(-6);o=await aeskw.wrap(se,X,l);break}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{l=n||generateCek(e),assertCryptoKey(r),o=await rsaes.encrypt(t,r,l);break}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{l=n||generateCek(e);let{p2c:E,p2s:_}=a;({encryptedKey:o,...i}=await pbes2kw.wrap(t,r,l,E,_));break}case"A128KW":case"A192KW":case"A256KW":{l=n||generateCek(e),o=await aeskw.wrap(t,r,l);break}case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{l=n||generateCek(e);let{iv:E}=a;({encryptedKey:o,...i}=await aesGcmKw(t,r,l,E));break}default:throw new JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:l,encryptedKey:o,parameters:i}};class Si{#e;#t;#r;#n;#s;#o;#i;#a;constructor(e){if(!(e instanceof Uint8Array))throw new TypeError("plaintext must be an instance of Uint8Array");this.#e=e}setKeyManagementParameters(e){if(this.#a)throw new TypeError("setKeyManagementParameters can only be called once");return this.#a=e,this}setProtectedHeader(e){if(this.#t)throw new TypeError("setProtectedHeader can only be called once");return this.#t=e,this}setSharedUnprotectedHeader(e){if(this.#r)throw new TypeError("setSharedUnprotectedHeader can only be called once");return this.#r=e,this}setUnprotectedHeader(e){if(this.#n)throw new TypeError("setUnprotectedHeader can only be called once");return this.#n=e,this}setAdditionalAuthenticatedData(e){return this.#s=e,this}setContentEncryptionKey(e){if(this.#o)throw new TypeError("setContentEncryptionKey can only be called once");return this.#o=e,this}setInitializationVector(e){if(this.#i)throw new TypeError("setInitializationVector can only be called once");return this.#i=e,this}async encrypt(e,r){if(!this.#t&&!this.#n&&!this.#r)throw new JWEInvalid("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!isDisjoint(this.#t,this.#n,this.#r))throw new JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let n={...this.#t,...this.#n,...this.#r};if(validateCrit(JWEInvalid,new Map,r?.crit,this.#t,n),n.zip!==void 0)throw new JOSENotSupported('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:a,enc:o}=n;if(typeof a!="string"||!a)throw new JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if(typeof o!="string"||!o)throw new JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');let i;if(this.#o&&(a==="dir"||a==="ECDH-ES"))throw new TypeError(`setContentEncryptionKey cannot be called with JWE "alg" (Algorithm) Header ${a}`);checkKeyType(a==="dir"?o:a,e,"encrypt");let l;{let X,se=await normalizeKey(e,a);({cek:l,encryptedKey:i,parameters:X}=await encryptKeyManagement(a,o,se,this.#o,this.#a)),X&&(r&&unprotected in r?this.#n?this.#n={...this.#n,...X}:this.setUnprotectedHeader(X):this.#t?this.#t={...this.#t,...X}:this.setProtectedHeader(X))}let E,_,R;this.#t?_=encoder.encode(b64u(JSON.stringify(this.#t))):_=encoder.encode(""),this.#s?(R=b64u(this.#s),E=concat(_,encoder.encode("."),encoder.encode(R))):E=_;let{ciphertext:J,tag:N,iv:j}=await encrypt(o,this.#e,l,this.#i,E),B={ciphertext:b64u(J)};return j&&(B.iv=b64u(j)),N&&(B.tag=b64u(N)),i&&(B.encrypted_key=b64u(i)),R&&(B.aad=R),this.#t&&(B.protected=decoder.decode(_)),this.#r&&(B.unprotected=this.#r),this.#n&&(B.header=this.#n),B}}class On{#e;constructor(e,r,n){this.#e=e,this.key=r,this.options=n}setUnprotectedHeader(e){if(this.unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}addRecipient(...e){return this.#e.addRecipient(...e)}encrypt(...e){return this.#e.encrypt(...e)}done(){return this.#e}}class _i{#e;#t;#r;#n;#s;constructor(e){this.#t=[],this.#e=e}addRecipient(e,r){let n=new On(this,e,{crit:r?.crit});return this.#t.push(n),n}setProtectedHeader(e){if(this.#r)throw new TypeError("setProtectedHeader can only be called once");return this.#r=e,this}setSharedUnprotectedHeader(e){if(this.#n)throw new TypeError("setSharedUnprotectedHeader can only be called once");return this.#n=e,this}setAdditionalAuthenticatedData(e){return this.#s=e,this}async encrypt(){if(!this.#t.length)throw new JWEInvalid("at least one recipient must be added");if(this.#t.length===1){let[a]=this.#t,o=await new FlattenedEncrypt(this.#e).setAdditionalAuthenticatedData(this.#s).setProtectedHeader(this.#r).setSharedUnprotectedHeader(this.#n).setUnprotectedHeader(a.unprotectedHeader).encrypt(a.key,{...a.options}),i={ciphertext:o.ciphertext,iv:o.iv,recipients:[{}],tag:o.tag};return o.aad&&(i.aad=o.aad),o.protected&&(i.protected=o.protected),o.unprotected&&(i.unprotected=o.unprotected),o.encrypted_key&&(i.recipients[0].encrypted_key=o.encrypted_key),o.header&&(i.recipients[0].header=o.header),i}let e;for(let a=0;a<this.#t.length;a++){let o=this.#t[a];if(!isDisjoint(this.#r,this.#n,o.unprotectedHeader))throw new JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let i={...this.#r,...this.#n,...o.unprotectedHeader},{alg:l}=i;if(typeof l!="string"||!l)throw new JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if(l==="dir"||l==="ECDH-ES")throw new JWEInvalid('"dir" and "ECDH-ES" alg may only be used with a single recipient');if(typeof i.enc!="string"||!i.enc)throw new JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(!e)e=i.enc;else if(e!==i.enc)throw new JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients');if(validateCrit(JWEInvalid,new Map,o.options.crit,this.#r,i),i.zip!==void 0)throw new JOSENotSupported('JWE "zip" (Compression Algorithm) Header Parameter is not supported.')}let r=generateCek(e),n={ciphertext:"",iv:"",recipients:[],tag:""};for(let a=0;a<this.#t.length;a++){let o=this.#t[a],i={};n.recipients.push(i);let E={...this.#r,...this.#n,...o.unprotectedHeader}.alg.startsWith("PBES2")?2048+a:void 0;if(a===0){let j=await new FlattenedEncrypt(this.#e).setAdditionalAuthenticatedData(this.#s).setContentEncryptionKey(r).setProtectedHeader(this.#r).setSharedUnprotectedHeader(this.#n).setUnprotectedHeader(o.unprotectedHeader).setKeyManagementParameters({p2c:E}).encrypt(o.key,{...o.options,[unprotected]:!0});n.ciphertext=j.ciphertext,n.iv=j.iv,n.tag=j.tag,j.aad&&(n.aad=j.aad),j.protected&&(n.protected=j.protected),j.unprotected&&(n.unprotected=j.unprotected),i.encrypted_key=j.encrypted_key,j.header&&(i.header=j.header);continue}let _=o.unprotectedHeader?.alg||this.#r?.alg||this.#n?.alg;checkKeyType(_==="dir"?e:_,o.key,"encrypt");let R=await normalizeKey(o.key,_),{encryptedKey:J,parameters:N}=await encryptKeyManagement(_,e,R,r,{p2c:E});i.encrypted_key=b64u(J),(o.unprotectedHeader||N)&&(i.header={...o.unprotectedHeader,...N})}return n}}let nr=(t,e)=>{let r=`SHA-${t.slice(-3)}`;switch(t){case"HS256":case"HS384":case"HS512":return{hash:r,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:r,name:"RSA-PSS",saltLength:parseInt(t.slice(-3),10)>>3};case"RS256":case"RS384":case"RS512":return{hash:r,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:r,name:"ECDSA",namedCurve:e.namedCurve};case"Ed25519":case"EdDSA":return{name:"Ed25519"};default:throw new Pe(`alg ${t} is not supported either by JOSE or your javascript runtime`)}},ar=async(t,e,r)=>{if(e instanceof Uint8Array){if(!t.startsWith("HS"))throw new TypeError(on(e,"CryptoKey","KeyObject","JSON Web Key"));return crypto.subtle.importKey("raw",e,{hash:`SHA-${t.slice(-3)}`,name:"HMAC"},!1,[r])}return sn(e,t,r),e},Nn=async(t,e,r,n)=>{let a=await ar(t,e,"verify");qt(t,a);let o=nr(t,a.algorithm);try{return await crypto.subtle.verify(o,a,r,n)}catch{return!1}};async function Mn(t,e,r){if(!Oe(t))throw new q("Flattened JWS must be an object");if(t.protected===void 0&&t.header===void 0)throw new q('Flattened JWS must have either of the "protected" or "header" members');if(t.protected!==void 0&&typeof t.protected!="string")throw new q("JWS Protected Header incorrect type");if(t.payload===void 0)throw new q("JWS Payload missing");if(typeof t.signature!="string")throw new q("JWS Signature missing or incorrect type");if(t.header!==void 0&&!Oe(t.header))throw new q("JWS Unprotected Header incorrect type");let n={};if(t.protected)try{let se=ke(t.protected);n=JSON.parse(we.decode(se))}catch{throw new q("JWS Protected Header is invalid")}if(!Gt(n,t.header))throw new q("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let a={...n,...t.header},o=Zt(q,new Map([["b64",!0]]),r?.crit,n,a),i=!0;if(o.has("b64")&&(i=n.b64,typeof i!="boolean"))throw new q('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:l}=a;if(typeof l!="string"||!l)throw new q('JWS "alg" (Algorithm) Header Parameter missing or invalid');let E=r&&An("algorithms",r.algorithms);if(E&&!E.has(l))throw new en('"alg" (Algorithm) Header Parameter value not allowed');if(i){if(typeof t.payload!="string")throw new q("JWS Payload must be a string")}else if(typeof t.payload!="string"&&!(t.payload instanceof Uint8Array))throw new q("JWS Payload must be a string or an Uint8Array instance");let _=!1;typeof e=="function"&&(e=await e(n,t),_=!0),rr(l,e,"verify");let R=Ht(le.encode(t.protected??""),le.encode("."),typeof t.payload=="string"?le.encode(t.payload):t.payload),J;try{J=ke(t.signature)}catch{throw new q("Failed to base64url decode the signature")}let N=await tr(e,l);if(!await Nn(l,N,J,R))throw new rn;let B;if(i)try{B=ke(t.payload)}catch{throw new q("Failed to base64url decode the payload")}else typeof t.payload=="string"?B=le.encode(t.payload):B=t.payload;let X={payload:B};return t.protected!==void 0&&(X.protectedHeader=n),t.header!==void 0&&(X.unprotectedHeader=t.header),_?{...X,key:N}:X}async function Dn(t,e,r){if(t instanceof Uint8Array&&(t=we.decode(t)),typeof t!="string")throw new q("Compact JWS must be a string or Uint8Array");let{0:n,1:a,2:o,length:i}=t.split(".");if(i!==3)throw new q("Invalid Compact JWS");let l=await Mn({payload:a,protected:n,signature:o},e,r),E={payload:l.payload,protectedHeader:l.protectedHeader};return typeof e=="function"?{...E,key:l.key}:E}async function bi(t,e,r){if(!isObject(t))throw new JWSInvalid("General JWS must be an object");if(!Array.isArray(t.signatures)||!t.signatures.every(isObject))throw new JWSInvalid("JWS Signatures missing or incorrect type");for(let n of t.signatures)try{return await flattenedVerify({header:n.header,payload:t.payload,protected:n.protected,signature:n.signature},e,r)}catch{}throw new JWSSignatureVerificationFailed}let ye=t=>Math.floor(t.getTime()/1e3),sr=60,or=sr*60,nt=or*24,Kn=nt*7,Ln=nt*365.25,Wn=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i,Ne=t=>{let e=Wn.exec(t);if(!e||e[4]&&e[1])throw new TypeError("Invalid time period format");let r=parseFloat(e[2]),n=e[3].toLowerCase(),a;switch(n){case"sec":case"secs":case"second":case"seconds":case"s":a=Math.round(r);break;case"minute":case"minutes":case"min":case"mins":case"m":a=Math.round(r*sr);break;case"hour":case"hours":case"hr":case"hrs":case"h":a=Math.round(r*or);break;case"day":case"days":case"d":a=Math.round(r*nt);break;case"week":case"weeks":case"w":a=Math.round(r*Kn);break;default:a=Math.round(r*Ln);break}return e[1]==="-"||e[4]==="ago"?-a:a};function Se(t,e){if(!Number.isFinite(e))throw new TypeError(`Invalid ${t} input`);return e}let ir=t=>t.includes("/")?t.toLowerCase():`application/${t.toLowerCase()}`,kn=(t,e)=>typeof t=="string"?e.includes(t):Array.isArray(t)?e.some(Set.prototype.has.bind(new Set(t))):!1;function Hn(t,e,r={}){let n;try{n=JSON.parse(we.decode(e))}catch{}if(!Oe(n))throw new Ye("JWT Claims Set must be a top-level JSON object");let{typ:a}=r;if(a&&(typeof t.typ!="string"||ir(t.typ)!==ir(a)))throw new pe('unexpected "typ" JWT header value',n,"typ","check_failed");let{requiredClaims:o=[],issuer:i,subject:l,audience:E,maxTokenAge:_}=r,R=[...o];_!==void 0&&R.push("iat"),E!==void 0&&R.push("aud"),l!==void 0&&R.push("sub"),i!==void 0&&R.push("iss");for(let B of new Set(R.reverse()))if(!(B in n))throw new pe(`missing required "${B}" claim`,n,B,"missing");if(i&&!(Array.isArray(i)?i:[i]).includes(n.iss))throw new pe('unexpected "iss" claim value',n,"iss","check_failed");if(l&&n.sub!==l)throw new pe('unexpected "sub" claim value',n,"sub","check_failed");if(E&&!kn(n.aud,typeof E=="string"?[E]:E))throw new pe('unexpected "aud" claim value',n,"aud","check_failed");let J;switch(typeof r.clockTolerance){case"string":J=Ne(r.clockTolerance);break;case"number":J=r.clockTolerance;break;case"undefined":J=0;break;default:throw new TypeError("Invalid clockTolerance option type")}let{currentDate:N}=r,j=ye(N||new Date);if((n.iat!==void 0||_)&&typeof n.iat!="number")throw new pe('"iat" claim must be a number',n,"iat","invalid");if(n.nbf!==void 0){if(typeof n.nbf!="number")throw new pe('"nbf" claim must be a number',n,"nbf","invalid");if(n.nbf>j+J)throw new pe('"nbf" claim timestamp check failed',n,"nbf","check_failed")}if(n.exp!==void 0){if(typeof n.exp!="number")throw new pe('"exp" claim must be a number',n,"exp","invalid");if(n.exp<=j-J)throw new Jt('"exp" claim timestamp check failed',n,"exp","check_failed")}if(_){let B=j-n.iat,X=typeof _=="number"?_:Ne(_);if(B-J>X)throw new Jt('"iat" claim timestamp check failed (too far in the past)',n,"iat","check_failed");if(B<0-J)throw new pe('"iat" claim timestamp check failed (it should be in the past)',n,"iat","check_failed")}return n}class Jn{#e;constructor(e){if(!Oe(e))throw new TypeError("JWT Claims Set MUST be an object");this.#e=structuredClone(e)}data(){return le.encode(JSON.stringify(this.#e))}get iss(){return this.#e.iss}set iss(e){this.#e.iss=e}get sub(){return this.#e.sub}set sub(e){this.#e.sub=e}get aud(){return this.#e.aud}set aud(e){this.#e.aud=e}set jti(e){this.#e.jti=e}set nbf(e){typeof e=="number"?this.#e.nbf=Se("setNotBefore",e):e instanceof Date?this.#e.nbf=Se("setNotBefore",ye(e)):this.#e.nbf=ye(new Date)+Ne(e)}set exp(e){typeof e=="number"?this.#e.exp=Se("setExpirationTime",e):e instanceof Date?this.#e.exp=Se("setExpirationTime",ye(e)):this.#e.exp=ye(new Date)+Ne(e)}set iat(e){typeof e>"u"?this.#e.iat=ye(new Date):e instanceof Date?this.#e.iat=Se("setIssuedAt",ye(e)):typeof e=="string"?this.#e.iat=Se("setIssuedAt",ye(new Date)+Ne(e)):this.#e.iat=Se("setIssuedAt",e)}}async function Un(t,e,r){let n=await Dn(t,e,r);if(n.protectedHeader.crit?.includes("b64")&&n.protectedHeader.b64===!1)throw new Ye("JWTs MUST NOT use unencoded payload");let o={payload:Hn(n.protectedHeader,n.payload,r),protectedHeader:n.protectedHeader};return typeof e=="function"?{...o,key:n.key}:o}async function vi(t,e,r){let n=await compactDecrypt(t,e,r),a=validateClaimsSet(n.protectedHeader,n.plaintext,r),{protectedHeader:o}=n;if(o.iss!==void 0&&o.iss!==a.iss)throw new JWTClaimValidationFailed('replicated "iss" claim header parameter mismatch',a,"iss","mismatch");if(o.sub!==void 0&&o.sub!==a.sub)throw new JWTClaimValidationFailed('replicated "sub" claim header parameter mismatch',a,"sub","mismatch");if(o.aud!==void 0&&JSON.stringify(o.aud)!==JSON.stringify(a.aud))throw new JWTClaimValidationFailed('replicated "aud" claim header parameter mismatch',a,"aud","mismatch");let i={payload:a,protectedHeader:o};return typeof e=="function"?{...i,key:n.key}:i}class Ai{#e;constructor(e){this.#e=new FlattenedEncrypt(e)}setContentEncryptionKey(e){return this.#e.setContentEncryptionKey(e),this}setInitializationVector(e){return this.#e.setInitializationVector(e),this}setProtectedHeader(e){return this.#e.setProtectedHeader(e),this}setKeyManagementParameters(e){return this.#e.setKeyManagementParameters(e),this}async encrypt(e,r){let n=await this.#e.encrypt(e,r);return[n.protected,n.encrypted_key,n.iv,n.ciphertext,n.tag].join(".")}}let Bn=async(t,e,r)=>{let n=await ar(t,e,"sign");qt(t,n);let a=await crypto.subtle.sign(nr(t,n.algorithm),n,r);return new Uint8Array(a)};class $n{#e;#t;#r;constructor(e){if(!(e instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this.#e=e}setProtectedHeader(e){if(this.#t)throw new TypeError("setProtectedHeader can only be called once");return this.#t=e,this}setUnprotectedHeader(e){if(this.#r)throw new TypeError("setUnprotectedHeader can only be called once");return this.#r=e,this}async sign(e,r){if(!this.#t&&!this.#r)throw new q("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!Gt(this.#t,this.#r))throw new q("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let n={...this.#t,...this.#r},a=Zt(q,new Map([["b64",!0]]),r?.crit,this.#t,n),o=!0;if(a.has("b64")&&(o=this.#t.b64,typeof o!="boolean"))throw new q('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:i}=n;if(typeof i!="string"||!i)throw new q('JWS "alg" (Algorithm) Header Parameter missing or invalid');rr(i,e,"sign");let l=this.#e;o&&(l=le.encode(qe(l)));let E;this.#t?E=le.encode(qe(JSON.stringify(this.#t))):E=le.encode("");let _=Ht(E,le.encode("."),l),R=await tr(e,i),J=await Bn(i,R,_),N={signature:qe(J),payload:""};return o&&(N.payload=we.decode(l)),this.#r&&(N.header=this.#r),this.#t&&(N.protected=we.decode(E)),N}}class Fn{#e;constructor(e){this.#e=new $n(e)}setProtectedHeader(e){return this.#e.setProtectedHeader(e),this}async sign(e,r){let n=await this.#e.sign(e,r);if(n.payload===void 0)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${n.protected}.${n.payload}.${n.signature}`}}class jn{#e;constructor(e,r,n){this.#e=e,this.key=r,this.options=n}setProtectedHeader(e){if(this.protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this.protectedHeader=e,this}setUnprotectedHeader(e){if(this.unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}addSignature(...e){return this.#e.addSignature(...e)}sign(...e){return this.#e.sign(...e)}done(){return this.#e}}class Pi{#e;#t;constructor(e){this.#t=[],this.#e=e}addSignature(e,r){let n=new jn(this,e,r);return this.#t.push(n),n}async sign(){if(!this.#t.length)throw new JWSInvalid("at least one signature must be added");let e={signatures:[],payload:""};for(let r=0;r<this.#t.length;r++){let n=this.#t[r],a=new FlattenedSign(this.#e);a.setProtectedHeader(n.protectedHeader),a.setUnprotectedHeader(n.unprotectedHeader);let{payload:o,...i}=await a.sign(n.key,n.options);if(r===0)e.payload=o;else if(e.payload!==o)throw new JWSInvalid("inconsistent use of JWS Unencoded Payload (RFC7797)");e.signatures.push(i)}return e}}class at{#e;#t;constructor(e={}){this.#t=new Jn(e)}setIssuer(e){return this.#t.iss=e,this}setSubject(e){return this.#t.sub=e,this}setAudience(e){return this.#t.aud=e,this}setJti(e){return this.#t.jti=e,this}setNotBefore(e){return this.#t.nbf=e,this}setExpirationTime(e){return this.#t.exp=e,this}setIssuedAt(e){return this.#t.iat=e,this}setProtectedHeader(e){return this.#e=e,this}async sign(e,r){let n=new Fn(this.#t.data());if(n.setProtectedHeader(this.#e),Array.isArray(this.#e?.crit)&&this.#e.crit.includes("b64")&&this.#e.b64===!1)throw new Ye("JWTs MUST NOT use unencoded payload");return n.sign(e,r)}}class Ri{#e;#t;#r;#n;#s;#o;#i;#a;constructor(e={}){this.#a=new JWTClaimsBuilder(e)}setIssuer(e){return this.#a.iss=e,this}setSubject(e){return this.#a.sub=e,this}setAudience(e){return this.#a.aud=e,this}setJti(e){return this.#a.jti=e,this}setNotBefore(e){return this.#a.nbf=e,this}setExpirationTime(e){return this.#a.exp=e,this}setIssuedAt(e){return this.#a.iat=e,this}setProtectedHeader(e){if(this.#n)throw new TypeError("setProtectedHeader can only be called once");return this.#n=e,this}setKeyManagementParameters(e){if(this.#r)throw new TypeError("setKeyManagementParameters can only be called once");return this.#r=e,this}setContentEncryptionKey(e){if(this.#e)throw new TypeError("setContentEncryptionKey can only be called once");return this.#e=e,this}setInitializationVector(e){if(this.#t)throw new TypeError("setInitializationVector can only be called once");return this.#t=e,this}replicateIssuerAsHeader(){return this.#s=!0,this}replicateSubjectAsHeader(){return this.#o=!0,this}replicateAudienceAsHeader(){return this.#i=!0,this}async encrypt(e,r){let n=new CompactEncrypt(this.#a.data());return this.#n&&(this.#s||this.#o||this.#i)&&(this.#n={...this.#n,iss:this.#s?this.#a.iss:void 0,sub:this.#o?this.#a.sub:void 0,aud:this.#i?this.#a.aud:void 0}),n.setProtectedHeader(this.#n),this.#t&&n.setInitializationVector(this.#t),this.#e&&n.setContentEncryptionKey(this.#e),this.#r&&n.setKeyManagementParameters(this.#r),n.encrypt(e,r)}}let me=(t,e)=>{if(typeof t!="string"||!t)throw new JWKInvalid(`${e} missing or invalid`)};async function Gn(t,e){let r;if(isJWK(t))r=t;else if(isKeyLike(t))r=await exportJWK(t);else throw new TypeError(invalidKeyInput(t,"CryptoKey","KeyObject","JSON Web Key"));if(e??="sha256",e!=="sha256"&&e!=="sha384"&&e!=="sha512")throw new TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');let n;switch(r.kty){case"EC":me(r.crv,'"crv" (Curve) Parameter'),me(r.x,'"x" (X Coordinate) Parameter'),me(r.y,'"y" (Y Coordinate) Parameter'),n={crv:r.crv,kty:r.kty,x:r.x,y:r.y};break;case"OKP":me(r.crv,'"crv" (Subtype of Key Pair) Parameter'),me(r.x,'"x" (Public Key) Parameter'),n={crv:r.crv,kty:r.kty,x:r.x};break;case"RSA":me(r.e,'"e" (Exponent) Parameter'),me(r.n,'"n" (Modulus) Parameter'),n={e:r.e,kty:r.kty,n:r.n};break;case"oct":me(r.k,'"k" (Key Value) Parameter'),n={k:r.k,kty:r.kty};break;default:throw new JOSENotSupported('"kty" (Key Type) Parameter missing or unsupported')}let a=encoder.encode(JSON.stringify(n));return b64u(await digest(e,a))}async function Ci(t,e){e??="sha256";let r=await Gn(t,e);return`urn:ietf:params:oauth:jwk-thumbprint:sha-${e.slice(-3)}:${r}`}async function Ti(t,e){let r={...t,...e?.header};if(!isObject(r.jwk))throw new JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a JSON object');let n=await importJWK({...r.jwk,ext:!0},r.alg);if(n instanceof Uint8Array||n.type!=="public")throw new JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a public key');return n}function Vn(t){switch(typeof t=="string"&&t.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new JOSENotSupported('Unsupported "alg" value for a JSON Web Key Set')}}function zn(t){return t&&typeof t=="object"&&Array.isArray(t.keys)&&t.keys.every(Xn)}function Xn(t){return isObject(t)}class qn{#e;#t;constructor(e){if(this.#t=new WeakMap,!zn(e))throw new JWKSInvalid("JSON Web Key Set malformed");this.#e=structuredClone(e)}jwks(){return this.#e}async getKey(e,r){let{alg:n,kid:a}={...e,...r?.header},o=Vn(n),i=this.#e.keys.filter(_=>{let R=o===_.kty;if(R&&typeof a=="string"&&(R=a===_.kid),R&&typeof _.alg=="string"&&(R=n===_.alg),R&&typeof _.use=="string"&&(R=_.use==="sig"),R&&Array.isArray(_.key_ops)&&(R=_.key_ops.includes("verify")),R)switch(n){case"ES256":R=_.crv==="P-256";break;case"ES384":R=_.crv==="P-384";break;case"ES512":R=_.crv==="P-521";break;case"Ed25519":case"EdDSA":R=_.crv==="Ed25519";break}return R}),{0:l,length:E}=i;if(E===0)throw new JWKSNoMatchingKey;if(E!==1){let _=new JWKSMultipleMatchingKeys,R=this.#t;throw _[Symbol.asyncIterator]=async function*(){for(let J of i)try{yield await cr(R,J,n)}catch{}},_}return cr(this.#t,l,n)}}async function cr(t,e,r){let n=t.get(e)||t.set(e,{}).get(e);if(n[r]===void 0){let a=await importJWK({...e,ext:!0},r);if(a instanceof Uint8Array||a.type!=="public")throw new JWKSInvalid("JSON Web Key Set members must be public keys");n[r]=a}return n[r]}function Ii(t){let e=new qn(t),r=async(n,a)=>e.getKey(n,a);return Object.defineProperties(r,{jwks:{value:()=>structuredClone(e.jwks()),enumerable:!1,configurable:!1,writable:!1}}),r}function Yn(){return typeof WebSocketPair<"u"||typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"||!0}let st;(typeof navigator>"u"||!navigator.userAgent?.startsWith?.("Mozilla/5.0 "))&&(st="jose/v6.0.12");let Qn=Symbol();async function Zn(t,e,r,n=fetch){let a=await n(t,{method:"GET",signal:r,redirect:"manual",headers:e}).catch(o=>{throw o.name==="TimeoutError"?new JWKSTimeout:o});if(a.status!==200)throw new JOSEError("Expected 200 OK from the JSON Web Key Set HTTP response");try{return await a.json()}catch{throw new JOSEError("Failed to parse the JSON Web Key Set HTTP response as JSON")}}let ot=Symbol();function ea(t,e){return!(typeof t!="object"||t===null||!("uat"in t)||typeof t.uat!="number"||Date.now()-t.uat>=e||!("jwks"in t)||!isObject(t.jwks)||!Array.isArray(t.jwks.keys)||!Array.prototype.every.call(t.jwks.keys,isObject))}class ta{#e;#t;#r;#n;#s;#o;#i;#a;#c;#u;constructor(e,r){if(!(e instanceof URL))throw new TypeError("url must be an instance of URL");this.#e=new URL(e.href),this.#t=typeof r?.timeoutDuration=="number"?r?.timeoutDuration:5e3,this.#r=typeof r?.cooldownDuration=="number"?r?.cooldownDuration:3e4,this.#n=typeof r?.cacheMaxAge=="number"?r?.cacheMaxAge:6e5,this.#i=new Headers(r?.headers),st&&!this.#i.has("User-Agent")&&this.#i.set("User-Agent",st),this.#i.has("accept")||(this.#i.set("accept","application/json"),this.#i.append("accept","application/jwk-set+json")),this.#a=r?.[Qn],r?.[ot]!==void 0&&(this.#u=r?.[ot],ea(r?.[ot],this.#n)&&(this.#s=this.#u.uat,this.#c=createLocalJWKSet(this.#u.jwks)))}pendingFetch(){return!!this.#o}coolingDown(){return typeof this.#s=="number"?Date.now()<this.#s+this.#r:!1}fresh(){return typeof this.#s=="number"?Date.now()<this.#s+this.#n:!1}jwks(){return this.#c?.jwks()}async getKey(e,r){(!this.#c||!this.fresh())&&await this.reload();try{return await this.#c(e,r)}catch(n){if(n instanceof JWKSNoMatchingKey&&this.coolingDown()===!1)return await this.reload(),this.#c(e,r);throw n}}async reload(){this.#o&&Yn()&&(this.#o=void 0),this.#o||=Zn(this.#e.href,this.#i,AbortSignal.timeout(this.#t),this.#a).then(e=>{this.#c=createLocalJWKSet(e),this.#u&&(this.#u.uat=Date.now(),this.#u.jwks=e),this.#s=Date.now(),this.#o=void 0}).catch(e=>{throw this.#o=void 0,e}),await this.#o}}function xi(t,e){let r=new ta(t,e),n=async(a,o)=>r.getKey(a,o);return Object.defineProperties(n,{coolingDown:{get:()=>r.coolingDown(),enumerable:!0,configurable:!1},fresh:{get:()=>r.fresh(),enumerable:!0,configurable:!1},reload:{value:()=>r.reload(),enumerable:!0,configurable:!1,writable:!1},reloading:{get:()=>r.pendingFetch(),enumerable:!0,configurable:!1},jwks:{value:()=>r.jwks(),enumerable:!0,configurable:!1,writable:!1}}),n}class Oi{#e;constructor(e={}){this.#e=new JWTClaimsBuilder(e)}encode(){let e=b64u.encode(JSON.stringify({alg:"none"})),r=b64u.encode(this.#e.data());return`${e}.${r}.`}setIssuer(e){return this.#e.iss=e,this}setSubject(e){return this.#e.sub=e,this}setAudience(e){return this.#e.aud=e,this}setJti(e){return this.#e.jti=e,this}setNotBefore(e){return this.#e.nbf=e,this}setExpirationTime(e){return this.#e.exp=e,this}setIssuedAt(e){return this.#e.iat=e,this}static decode(e,r){if(typeof e!="string")throw new JWTInvalid("Unsecured JWT must be a string");let{0:n,1:a,2:o,length:i}=e.split(".");if(i!==3||o!=="")throw new JWTInvalid("Invalid Unsecured JWT");let l;try{if(l=JSON.parse(decoder.decode(b64u.decode(n))),l.alg!=="none")throw new Error}catch{throw new JWTInvalid("Invalid Unsecured JWT")}return{payload:validateClaimsSet(l,b64u.decode(a),r),header:l}}}function Ni(t){let e;if(typeof t=="string"){let r=t.split(".");(r.length===3||r.length===5)&&([e]=r)}else if(typeof t=="object"&&t)if("protected"in t)e=t.protected;else throw new TypeError("Token does not contain a Protected Header");try{if(typeof e!="string"||!e)throw new Error;let r=JSON.parse(decoder.decode(b64u(e)));if(!isObject(r))throw new Error;return r}catch{throw new TypeError("Invalid Token or Protected Header formatting")}}function Mi(t){if(typeof t!="string")throw new JWTInvalid("JWTs must use Compact JWS serialization, JWT must be a string");let{1:e,length:r}=t.split(".");if(r===5)throw new JWTInvalid("Only JWTs using Compact JWS serialization can be decoded");if(r!==3)throw new JWTInvalid("Invalid JWT");if(!e)throw new JWTInvalid("JWTs must contain a payload");let n;try{n=b64u(e)}catch{throw new JWTInvalid("Failed to base64url decode the payload")}let a;try{a=JSON.parse(decoder.decode(n))}catch{throw new JWTInvalid("Failed to parse the decoded payload as JSON")}if(!isObject(a))throw new JWTInvalid("Invalid JWT Claims Set");return a}function it(t){let e=t?.modulusLength??2048;if(typeof e!="number"||e<2048)throw new JOSENotSupported("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");return e}async function Di(t,e){let r,n;switch(t){case"PS256":case"PS384":case"PS512":r={name:"RSA-PSS",hash:`SHA-${t.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:it(e)},n=["sign","verify"];break;case"RS256":case"RS384":case"RS512":r={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${t.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:it(e)},n=["sign","verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":r={name:"RSA-OAEP",hash:`SHA-${parseInt(t.slice(-3),10)||1}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:it(e)},n=["decrypt","unwrapKey","encrypt","wrapKey"];break;case"ES256":r={name:"ECDSA",namedCurve:"P-256"},n=["sign","verify"];break;case"ES384":r={name:"ECDSA",namedCurve:"P-384"},n=["sign","verify"];break;case"ES512":r={name:"ECDSA",namedCurve:"P-521"},n=["sign","verify"];break;case"Ed25519":case"EdDSA":{n=["sign","verify"],r={name:"Ed25519"};break}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{n=["deriveBits"];let a=e?.crv??"P-256";switch(a){case"P-256":case"P-384":case"P-521":{r={name:"ECDH",namedCurve:a};break}case"X25519":r={name:"X25519"};break;default:throw new JOSENotSupported("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, and X25519")}break}default:throw new JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return crypto.subtle.generateKey(r,e?.extractable??!1,n)}async function Ki(t,e){let r,n,a;switch(t){case"HS256":case"HS384":case"HS512":r=parseInt(t.slice(-3),10),n={name:"HMAC",hash:`SHA-${r}`,length:r},a=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return r=parseInt(t.slice(-3),10),crypto.getRandomValues(new Uint8Array(r>>3));case"A128KW":case"A192KW":case"A256KW":r=parseInt(t.slice(1,4),10),n={name:"AES-KW",length:r},a=["wrapKey","unwrapKey"];break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":r=parseInt(t.slice(1,4),10),n={name:"AES-GCM",length:r},a=["encrypt","decrypt"];break;default:throw new JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return crypto.subtle.generateKey(n,e?.extractable??!1,a)}let Li="WebCryptoAPI";class Wi{static async hashPassword(e,r){let n=r||crypto.getRandomValues(new Uint8Array(32)),a=new TextEncoder().encode(e),o=await crypto.subtle.importKey("raw",a,{name:"PBKDF2"},!1,["deriveBits"]),i=await crypto.subtle.deriveBits({name:"PBKDF2",salt:n,iterations:1e5,hash:"SHA-256"},o,256),l=new Uint8Array(i),E=new Uint8Array(64);return E.set(n,0),E.set(l,32),btoa(String.fromCharCode.apply(null,Array.from(E)))}static async verifyPassword(e,r){try{let n=new Uint8Array(atob(r).split("").map(R=>R.charCodeAt(0))),a=n.slice(0,32),o=n.slice(32,64),i=new TextEncoder().encode(e),l=await crypto.subtle.importKey("raw",i,{name:"PBKDF2"},!1,["deriveBits"]),E=await crypto.subtle.deriveBits({name:"PBKDF2",salt:a,iterations:1e5,hash:"SHA-256"},l,256),_=new Uint8Array(E);return this.constantTimeEquals(o,_)}catch(n){return console.error("Password verification error:",n),!1}}static constantTimeEquals(e,r){if(e.length!==r.length)return!1;let n=0;for(let a=0;a<e.length;a++)n|=e[a]^r[a];return n===0}static generateRandomPassword(e=12){let r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*",n="",a=crypto.getRandomValues(new Uint8Array(e));for(let o=0;o<e;o++)n+=r.charAt(a[o]%r.length);return n}static async migrateBcryptHash(e,r){return await this.hashPassword(e)}}let ki=null;function Hi(){return G.DB}async function Ji(t,e,r=[]){try{let n=await t.prepare(e).bind(...r).all();return{success:!0,data:n.results,meta:{duration:n.meta?.duration,changes:n.meta?.changes,last_row_id:n.meta?.last_row_id,rows_read:n.meta?.rows_read,rows_written:n.meta?.rows_written}}}catch(n){return console.error("Database query error:",n),{success:!1,error:n instanceof Error?n.message:"Unknown database error"}}}async function Ui(t,e,r=[]){try{return{success:!0,data:await t.prepare(e).bind(...r).first()}}catch(n){return console.error("Database query error:",n),{success:!1,error:n instanceof Error?n.message:"Unknown database error"}}}async function Bi(t,e){try{let r=e.map(({query:a,params:o=[]})=>t.prepare(a).bind(...o));return{success:!0,results:(await t.batch(r)).map(a=>a.results)}}catch(r){return console.error("Database transaction error:",r),{success:!1,error:r instanceof Error?r.message:"Unknown transaction error"}}}let _e={generateId:()=>crypto.randomUUID(),toJson:t=>JSON.stringify(t),fromJson:t=>{if(!t)return null;try{return JSON.parse(t)}catch{return null}},generateSlug:t=>t.toLowerCase().replace(/ğ/g,"g").replace(/ü/g,"u").replace(/ş/g,"s").replace(/ı/g,"i").replace(/ö/g,"o").replace(/ç/g,"c").replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,""),formatDate:(t=new Date)=>t.toISOString(),getPaginationParams:(t=1,e=20)=>{let r=(t-1)*e;return{limit:e,offset:r}}},$i={isValidEmail:t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),isValidPhone:t=>/^[\+]?[0-9\s\-\(\)]{10,}$/.test(t),isValidUrl:t=>{try{return new URL(t),!0}catch{return!1}},sanitizeHtml:t=>t.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,"").replace(/on\w+="[^"]*"/gi,"")},ra=process.env.JWT_SECRET||"your-super-secret-jwt-key-change-in-production",na=process.env.JWT_ACCESS_EXPIRES_IN||"15m",aa=process.env.JWT_REFRESH_EXPIRES_IN||"7d";class be{static getSecret(){return new TextEncoder().encode(ra)}static async generateAccessToken(e){let r={sub:e.id,username:e.username,email:e.email,role:e.role,type:"access"};return await new at(r).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime(na).sign(this.getSecret())}static async generateRefreshToken(e){let r={sub:e.id,username:e.username,email:e.email,role:e.role,type:"refresh"};return await new at(r).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime(aa).sign(this.getSecret())}static async verifyToken(e){try{let{payload:r}=await Un(e,this.getSecret());return{success:!0,payload:r}}catch(r){return{success:!1,error:r.message||"Invalid token"}}}}class Fi{static async hashPassword(e){return await EdgePasswordUtils.hashPassword(e)}static async verifyPassword(e,r){return await EdgePasswordUtils.verifyPassword(e,r)}static generateRandomPassword(e=12){let r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*",n="";for(let a=0;a<e;a++)n+=r.charAt(Math.floor(Math.random()*r.length));return n}}class ji{static{this.attempts=new Map}static isRateLimited(e,r=5,n=15*60*1e3){let a=Date.now(),o=this.attempts.get(e);return!o||a>o.resetTime?(this.attempts.set(e,{count:1,resetTime:a+n}),!1):o.count>=r?!0:(o.count++,!1)}static clearAttempts(e){this.attempts.delete(e)}static resetRateLimit(e){this.attempts.delete(e)}static cleanup(){let e=Date.now(),r=[];this.attempts.forEach((n,a)=>{e>n.resetTime&&r.push(a)}),r.forEach(n=>{this.attempts.delete(n)})}}class ur{static async authenticate(e,r){try{if((e==="protekadmin"||e==="admin@protekanalitik.com")&&r==="protek1234"){let n={id:"admin-001",username:"protekadmin",email:"admin@protekanalitik.com",first_name:"Admin",last_name:"User",role:"admin",is_active:!0,last_login:_e.formatDate(),created_at:_e.formatDate(),updated_at:_e.formatDate()},a=await be.generateAccessToken(n),o=await be.generateRefreshToken(n);return{success:!0,user:n,accessToken:a,refreshToken:o}}else return{success:!1,error:"Ge\xE7ersiz kullan\u0131c\u0131 ad\u0131 veya \u015Fifre"}}catch(n){return console.error("Authentication error:",n),{success:!1,error:"Kimlik do\u011Frulama s\u0131ras\u0131nda hata olu\u015Ftu"}}}static async refreshAccessToken(e){try{let r=await be.verifyToken(e);if(!r.success||!r.payload)return{success:!1,error:"Ge\xE7ersiz refresh token"};if(r.payload.type!=="refresh")return{success:!1,error:"Ge\xE7ersiz token tipi"};let n={id:r.payload.sub,username:r.payload.username,email:r.payload.email,role:r.payload.role,is_active:!0,created_at:_e.formatDate(),updated_at:_e.formatDate()},a=await be.generateAccessToken(n);return{success:!0,user:n,accessToken:a,refreshToken:e}}catch(r){return console.error("Token refresh error:",r),{success:!1,error:"Token yenileme s\u0131ras\u0131nda hata olu\u015Ftu"}}}static async verifyAccessToken(e){try{let r=await be.verifyToken(e);return!r.success||!r.payload?{success:!1,error:"Ge\xE7ersiz token"}:r.payload.type!=="access"?{success:!1,error:"Ge\xE7ersiz token tipi"}:{success:!0,user:{id:r.payload.sub,username:r.payload.username,email:r.payload.email,role:r.payload.role,is_active:!0,created_at:_e.formatDate(),updated_at:_e.formatDate()}}}catch(r){return console.error("Token verification error:",r),{success:!1,error:"Token do\u011Frulama s\u0131ras\u0131nda hata olu\u015Ftu"}}}static hasRole(e,r){let n={viewer:1,editor:2,admin:3,super_admin:4};return n[e.role]>=n[r]}static async generatePasswordResetToken(e){let r={sub:e,type:"password_reset",exp:Math.floor(Date.now()/1e3)+3600};return await new at(r).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("1h").sign(be.getSecret())}static async verifyPasswordResetToken(e){try{let r=await be.verifyToken(e);return!r.success||!r.payload||r.payload.type!=="password_reset"?{success:!1,error:"Ge\xE7ersiz \u015Fifre s\u0131f\u0131rlama token"}:{success:!0,userId:r.payload.sub}}catch(r){return console.error("Password reset token verification error:",r),{success:!1,error:"Token do\u011Frulama s\u0131ras\u0131nda hata olu\u015Ftu"}}}}let sa=["/admin","/api/products","/api/categories","/api/news","/api/events","/api/upload"],oa=["/api/auth/login","/api/auth/refresh","/api/auth/logout","/api/products/public","/api/contact"];async function ia(t){let{pathname:e}=t.nextUrl;if(e.startsWith("/_next")||e.startsWith("/static")||e.includes(".")||e==="/favicon.ico")return re.next();let r=sa.some(o=>e.startsWith(o)),n=oa.some(o=>e.startsWith(o));if(!r||n)return re.next();let a=t.cookies.get("accessToken")?.value;if(!a){let o=t.headers.get("authorization");o&&o.startsWith("Bearer ")&&(a=o.substring(7))}if(!a)if(e.startsWith("/admin")){let o=new URL("/login",t.url);return o.searchParams.set("redirect",e),re.redirect(o)}else return re.json({success:!1,error:"Authentication required",code:"AUTHENTICATION_REQUIRED"},{status:401});try{let o=await ur.verifyAccessToken(a);if(!o.success){let l=t.cookies.get("refreshToken")?.value;if(l){let E=await ur.refreshAccessToken(l);if(E.success){let _=re.next();return _.cookies.set("accessToken",E.accessToken,{httpOnly:!0,secure:!0,sameSite:"strict",path:"/",maxAge:15*60}),_.headers.set("x-user-id",E.user.id),_.headers.set("x-user-role",E.user.role),_}}if(e.startsWith("/admin")){let E=new URL("/login",t.url);E.searchParams.set("redirect",e);let _=re.redirect(E);return _.cookies.delete("accessToken"),_.cookies.delete("refreshToken"),_}else{let E=re.json({success:!1,error:"Invalid or expired token",code:"INVALID_TOKEN"},{status:401});return E.cookies.delete("accessToken"),E.cookies.delete("refreshToken"),E}}let i=re.next();return i.headers.set("x-user-id",o.user.id),i.headers.set("x-user-role",o.user.role),i.headers.set("x-user-email",o.user.email),i}catch(o){return console.error("Middleware error:",o),e.startsWith("/admin")?re.redirect(new URL("/login",t.url)):re.json({success:!1,error:"Authentication error",code:"AUTH_ERROR"},{status:500})}}let ca={matcher:["/((?!api/auth|_next/static|_next/image|favicon.ico|public).*)"]},dr={...x},lr=dr.middleware||dr.default,pr="/src/middleware";if(typeof lr!="function")throw new Error(`The Middleware "${pr}" must export a \`middleware\` or a \`default\` function`);function ua(t){return Yr({...t,page:pr,handler:lr})}},1170:z=>{"use strict";var $=Object.defineProperty,D=Object.getOwnPropertyDescriptor,x=Object.getOwnPropertyNames,U=Object.prototype.hasOwnProperty,W=(c,S)=>{for(var b in S)$(c,b,{get:S[b],enumerable:!0})},K=(c,S,b,M)=>{if(S&&typeof S=="object"||typeof S=="function")for(let O of x(S))!U.call(c,O)&&O!==b&&$(c,O,{get:()=>S[O],enumerable:!(M=D(S,O))||M.enumerable});return c},F=c=>K($({},"__esModule",{value:!0}),c),y={};W(y,{RequestCookies:()=>w,ResponseCookies:()=>v,parseCookie:()=>d,parseSetCookie:()=>u,stringifyCookie:()=>s}),z.exports=F(y);function s(c){var S;let b=["path"in c&&c.path&&`Path=${c.path}`,"expires"in c&&(c.expires||c.expires===0)&&`Expires=${(typeof c.expires=="number"?new Date(c.expires):c.expires).toUTCString()}`,"maxAge"in c&&typeof c.maxAge=="number"&&`Max-Age=${c.maxAge}`,"domain"in c&&c.domain&&`Domain=${c.domain}`,"secure"in c&&c.secure&&"Secure","httpOnly"in c&&c.httpOnly&&"HttpOnly","sameSite"in c&&c.sameSite&&`SameSite=${c.sameSite}`,"priority"in c&&c.priority&&`Priority=${c.priority}`].filter(Boolean);return`${c.name}=${encodeURIComponent((S=c.value)!=null?S:"")}; ${b.join("; ")}`}function d(c){let S=new Map;for(let b of c.split(/; */)){if(!b)continue;let M=b.indexOf("=");if(M===-1){S.set(b,"true");continue}let[O,A]=[b.slice(0,M),b.slice(M+1)];try{S.set(O,decodeURIComponent(A??"true"))}catch{}}return S}function u(c){if(!c)return;let[[S,b],...M]=d(c),{domain:O,expires:A,httponly:k,maxage:L,path:H,samesite:Z,secure:ee,priority:ie}=Object.fromEntries(M.map(([ne,T])=>[ne.toLowerCase(),T])),ce={name:S,value:decodeURIComponent(b),domain:O,...A&&{expires:new Date(A)},...k&&{httpOnly:!0},...typeof L=="string"&&{maxAge:Number(L)},path:H,...Z&&{sameSite:p(Z)},...ee&&{secure:!0},...ie&&{priority:m(ie)}};return f(ce)}function f(c){let S={};for(let b in c)c[b]&&(S[b]=c[b]);return S}var h=["strict","lax","none"];function p(c){return c=c.toLowerCase(),h.includes(c)?c:void 0}var g=["low","medium","high"];function m(c){return c=c.toLowerCase(),g.includes(c)?c:void 0}function P(c){if(!c)return[];var S=[],b=0,M,O,A,k,L;function H(){for(;b<c.length&&/\s/.test(c.charAt(b));)b+=1;return b<c.length}function Z(){return O=c.charAt(b),O!=="="&&O!==";"&&O!==","}for(;b<c.length;){for(M=b,L=!1;H();)if(O=c.charAt(b),O===","){for(A=b,b+=1,H(),k=b;b<c.length&&Z();)b+=1;b<c.length&&c.charAt(b)==="="?(L=!0,b=k,S.push(c.substring(M,A)),M=b):b=A+1}else b+=1;(!L||b>=c.length)&&S.push(c.substring(M,c.length))}return S}var w=class{constructor(c){this._parsed=new Map,this._headers=c;let S=c.get("cookie");if(S){let b=d(S);for(let[M,O]of b)this._parsed.set(M,{name:M,value:O})}}[Symbol.iterator](){return this._parsed[Symbol.iterator]()}get size(){return this._parsed.size}get(...c){let S=typeof c[0]=="string"?c[0]:c[0].name;return this._parsed.get(S)}getAll(...c){var S;let b=Array.from(this._parsed);if(!c.length)return b.map(([O,A])=>A);let M=typeof c[0]=="string"?c[0]:(S=c[0])==null?void 0:S.name;return b.filter(([O])=>O===M).map(([O,A])=>A)}has(c){return this._parsed.has(c)}set(...c){let[S,b]=c.length===1?[c[0].name,c[0].value]:c,M=this._parsed;return M.set(S,{name:S,value:b}),this._headers.set("cookie",Array.from(M).map(([O,A])=>s(A)).join("; ")),this}delete(c){let S=this._parsed,b=Array.isArray(c)?c.map(M=>S.delete(M)):S.delete(c);return this._headers.set("cookie",Array.from(S).map(([M,O])=>s(O)).join("; ")),b}clear(){return this.delete(Array.from(this._parsed.keys())),this}[Symbol.for("edge-runtime.inspect.custom")](){return`RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(c=>`${c.name}=${encodeURIComponent(c.value)}`).join("; ")}},v=class{constructor(c){this._parsed=new Map;var S,b,M;this._headers=c;let O=(M=(b=(S=c.getSetCookie)==null?void 0:S.call(c))!=null?b:c.get("set-cookie"))!=null?M:[],A=Array.isArray(O)?O:P(O);for(let k of A){let L=u(k);L&&this._parsed.set(L.name,L)}}get(...c){let S=typeof c[0]=="string"?c[0]:c[0].name;return this._parsed.get(S)}getAll(...c){var S;let b=Array.from(this._parsed.values());if(!c.length)return b;let M=typeof c[0]=="string"?c[0]:(S=c[0])==null?void 0:S.name;return b.filter(O=>O.name===M)}has(c){return this._parsed.has(c)}set(...c){let[S,b,M]=c.length===1?[c[0].name,c[0].value,c[0]]:c,O=this._parsed;return O.set(S,C({name:S,value:b,...M})),I(O,this._headers),this}delete(...c){let[S,b,M]=typeof c[0]=="string"?[c[0]]:[c[0].name,c[0].path,c[0].domain];return this.set({name:S,path:b,domain:M,value:"",expires:new Date(0)})}[Symbol.for("edge-runtime.inspect.custom")](){return`ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(s).join("; ")}};function I(c,S){S.delete("set-cookie");for(let[,b]of c){let M=s(b);S.append("set-cookie",M)}}function C(c={name:"",value:""}){return typeof c.expires=="number"&&(c.expires=new Date(c.expires)),c.maxAge&&(c.expires=new Date(Date.now()+c.maxAge*1e3)),(c.path===null||c.path===void 0)&&(c.path="/"),c}},3016:(z,$,D)=>{"use strict";var x="/";(()=>{"use strict";var U={491:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ContextAPI=void 0;let u=d(223),f=d(172),h=d(930),p="context",g=new u.NoopContextManager;class m{constructor(){}static getInstance(){return this._instance||(this._instance=new m),this._instance}setGlobalContextManager(w){return(0,f.registerGlobal)(p,w,h.DiagAPI.instance())}active(){return this._getContextManager().active()}with(w,v,I,...C){return this._getContextManager().with(w,v,I,...C)}bind(w,v){return this._getContextManager().bind(w,v)}_getContextManager(){return(0,f.getGlobal)(p)||g}disable(){this._getContextManager().disable(),(0,f.unregisterGlobal)(p,h.DiagAPI.instance())}}s.ContextAPI=m},930:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DiagAPI=void 0;let u=d(56),f=d(912),h=d(957),p=d(172),g="diag";class m{constructor(){function w(C){return function(...c){let S=(0,p.getGlobal)("diag");if(!!S)return S[C](...c)}}let v=this,I=(C,c={logLevel:h.DiagLogLevel.INFO})=>{var S,b,M;if(C===v){let k=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return v.error((S=k.stack)!==null&&S!==void 0?S:k.message),!1}typeof c=="number"&&(c={logLevel:c});let O=(0,p.getGlobal)("diag"),A=(0,f.createLogLevelDiagLogger)((b=c.logLevel)!==null&&b!==void 0?b:h.DiagLogLevel.INFO,C);if(O&&!c.suppressOverrideMessage){let k=(M=new Error().stack)!==null&&M!==void 0?M:"<failed to generate stacktrace>";O.warn(`Current logger will be overwritten from ${k}`),A.warn(`Current logger will overwrite one already registered from ${k}`)}return(0,p.registerGlobal)("diag",A,v,!0)};v.setLogger=I,v.disable=()=>{(0,p.unregisterGlobal)(g,v)},v.createComponentLogger=C=>new u.DiagComponentLogger(C),v.verbose=w("verbose"),v.debug=w("debug"),v.info=w("info"),v.warn=w("warn"),v.error=w("error")}static instance(){return this._instance||(this._instance=new m),this._instance}}s.DiagAPI=m},653:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.MetricsAPI=void 0;let u=d(660),f=d(172),h=d(930),p="metrics";class g{constructor(){}static getInstance(){return this._instance||(this._instance=new g),this._instance}setGlobalMeterProvider(P){return(0,f.registerGlobal)(p,P,h.DiagAPI.instance())}getMeterProvider(){return(0,f.getGlobal)(p)||u.NOOP_METER_PROVIDER}getMeter(P,w,v){return this.getMeterProvider().getMeter(P,w,v)}disable(){(0,f.unregisterGlobal)(p,h.DiagAPI.instance())}}s.MetricsAPI=g},181:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PropagationAPI=void 0;let u=d(172),f=d(874),h=d(194),p=d(277),g=d(369),m=d(930),P="propagation",w=new f.NoopTextMapPropagator;class v{constructor(){this.createBaggage=g.createBaggage,this.getBaggage=p.getBaggage,this.getActiveBaggage=p.getActiveBaggage,this.setBaggage=p.setBaggage,this.deleteBaggage=p.deleteBaggage}static getInstance(){return this._instance||(this._instance=new v),this._instance}setGlobalPropagator(C){return(0,u.registerGlobal)(P,C,m.DiagAPI.instance())}inject(C,c,S=h.defaultTextMapSetter){return this._getGlobalPropagator().inject(C,c,S)}extract(C,c,S=h.defaultTextMapGetter){return this._getGlobalPropagator().extract(C,c,S)}fields(){return this._getGlobalPropagator().fields()}disable(){(0,u.unregisterGlobal)(P,m.DiagAPI.instance())}_getGlobalPropagator(){return(0,u.getGlobal)(P)||w}}s.PropagationAPI=v},997:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TraceAPI=void 0;let u=d(172),f=d(846),h=d(139),p=d(607),g=d(930),m="trace";class P{constructor(){this._proxyTracerProvider=new f.ProxyTracerProvider,this.wrapSpanContext=h.wrapSpanContext,this.isSpanContextValid=h.isSpanContextValid,this.deleteSpan=p.deleteSpan,this.getSpan=p.getSpan,this.getActiveSpan=p.getActiveSpan,this.getSpanContext=p.getSpanContext,this.setSpan=p.setSpan,this.setSpanContext=p.setSpanContext}static getInstance(){return this._instance||(this._instance=new P),this._instance}setGlobalTracerProvider(v){let I=(0,u.registerGlobal)(m,this._proxyTracerProvider,g.DiagAPI.instance());return I&&this._proxyTracerProvider.setDelegate(v),I}getTracerProvider(){return(0,u.getGlobal)(m)||this._proxyTracerProvider}getTracer(v,I){return this.getTracerProvider().getTracer(v,I)}disable(){(0,u.unregisterGlobal)(m,g.DiagAPI.instance()),this._proxyTracerProvider=new f.ProxyTracerProvider}}s.TraceAPI=P},277:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.deleteBaggage=s.setBaggage=s.getActiveBaggage=s.getBaggage=void 0;let u=d(491),h=(0,d(780).createContextKey)("OpenTelemetry Baggage Key");function p(w){return w.getValue(h)||void 0}s.getBaggage=p;function g(){return p(u.ContextAPI.getInstance().active())}s.getActiveBaggage=g;function m(w,v){return w.setValue(h,v)}s.setBaggage=m;function P(w){return w.deleteValue(h)}s.deleteBaggage=P},993:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BaggageImpl=void 0;class d{constructor(f){this._entries=f?new Map(f):new Map}getEntry(f){let h=this._entries.get(f);if(!!h)return Object.assign({},h)}getAllEntries(){return Array.from(this._entries.entries()).map(([f,h])=>[f,h])}setEntry(f,h){let p=new d(this._entries);return p._entries.set(f,h),p}removeEntry(f){let h=new d(this._entries);return h._entries.delete(f),h}removeEntries(...f){let h=new d(this._entries);for(let p of f)h._entries.delete(p);return h}clear(){return new d}}s.BaggageImpl=d},830:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.baggageEntryMetadataSymbol=void 0,s.baggageEntryMetadataSymbol=Symbol("BaggageEntryMetadata")},369:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.baggageEntryMetadataFromString=s.createBaggage=void 0;let u=d(930),f=d(993),h=d(830),p=u.DiagAPI.instance();function g(P={}){return new f.BaggageImpl(new Map(Object.entries(P)))}s.createBaggage=g;function m(P){return typeof P!="string"&&(p.error(`Cannot create baggage metadata from unknown type: ${typeof P}`),P=""),{__TYPE__:h.baggageEntryMetadataSymbol,toString(){return P}}}s.baggageEntryMetadataFromString=m},67:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.context=void 0;let u=d(491);s.context=u.ContextAPI.getInstance()},223:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.NoopContextManager=void 0;let u=d(780);class f{active(){return u.ROOT_CONTEXT}with(p,g,m,...P){return g.call(m,...P)}bind(p,g){return g}enable(){return this}disable(){return this}}s.NoopContextManager=f},780:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ROOT_CONTEXT=s.createContextKey=void 0;function d(f){return Symbol.for(f)}s.createContextKey=d;class u{constructor(h){let p=this;p._currentContext=h?new Map(h):new Map,p.getValue=g=>p._currentContext.get(g),p.setValue=(g,m)=>{let P=new u(p._currentContext);return P._currentContext.set(g,m),P},p.deleteValue=g=>{let m=new u(p._currentContext);return m._currentContext.delete(g),m}}}s.ROOT_CONTEXT=new u},506:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.diag=void 0;let u=d(930);s.diag=u.DiagAPI.instance()},56:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DiagComponentLogger=void 0;let u=d(172);class f{constructor(g){this._namespace=g.namespace||"DiagComponentLogger"}debug(...g){return h("debug",this._namespace,g)}error(...g){return h("error",this._namespace,g)}info(...g){return h("info",this._namespace,g)}warn(...g){return h("warn",this._namespace,g)}verbose(...g){return h("verbose",this._namespace,g)}}s.DiagComponentLogger=f;function h(p,g,m){let P=(0,u.getGlobal)("diag");if(!!P)return m.unshift(g),P[p](...m)}},972:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DiagConsoleLogger=void 0;let d=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}];class u{constructor(){function h(p){return function(...g){if(console){let m=console[p];if(typeof m!="function"&&(m=console.log),typeof m=="function")return m.apply(console,g)}}}for(let p=0;p<d.length;p++)this[d[p].n]=h(d[p].c)}}s.DiagConsoleLogger=u},912:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.createLogLevelDiagLogger=void 0;let u=d(957);function f(h,p){h<u.DiagLogLevel.NONE?h=u.DiagLogLevel.NONE:h>u.DiagLogLevel.ALL&&(h=u.DiagLogLevel.ALL),p=p||{};function g(m,P){let w=p[m];return typeof w=="function"&&h>=P?w.bind(p):function(){}}return{error:g("error",u.DiagLogLevel.ERROR),warn:g("warn",u.DiagLogLevel.WARN),info:g("info",u.DiagLogLevel.INFO),debug:g("debug",u.DiagLogLevel.DEBUG),verbose:g("verbose",u.DiagLogLevel.VERBOSE)}}s.createLogLevelDiagLogger=f},957:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DiagLogLevel=void 0;var d;(function(u){u[u.NONE=0]="NONE",u[u.ERROR=30]="ERROR",u[u.WARN=50]="WARN",u[u.INFO=60]="INFO",u[u.DEBUG=70]="DEBUG",u[u.VERBOSE=80]="VERBOSE",u[u.ALL=9999]="ALL"})(d=s.DiagLogLevel||(s.DiagLogLevel={}))},172:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.unregisterGlobal=s.getGlobal=s.registerGlobal=void 0;let u=d(200),f=d(521),h=d(130),p=f.VERSION.split(".")[0],g=Symbol.for(`opentelemetry.js.api.${p}`),m=u._globalThis;function P(I,C,c,S=!1){var b;let M=m[g]=(b=m[g])!==null&&b!==void 0?b:{version:f.VERSION};if(!S&&M[I]){let O=new Error(`@opentelemetry/api: Attempted duplicate registration of API: ${I}`);return c.error(O.stack||O.message),!1}if(M.version!==f.VERSION){let O=new Error(`@opentelemetry/api: Registration of version v${M.version} for ${I} does not match previously registered API v${f.VERSION}`);return c.error(O.stack||O.message),!1}return M[I]=C,c.debug(`@opentelemetry/api: Registered a global for ${I} v${f.VERSION}.`),!0}s.registerGlobal=P;function w(I){var C,c;let S=(C=m[g])===null||C===void 0?void 0:C.version;if(!(!S||!(0,h.isCompatible)(S)))return(c=m[g])===null||c===void 0?void 0:c[I]}s.getGlobal=w;function v(I,C){C.debug(`@opentelemetry/api: Unregistering a global for ${I} v${f.VERSION}.`);let c=m[g];c&&delete c[I]}s.unregisterGlobal=v},130:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.isCompatible=s._makeCompatibilityCheck=void 0;let u=d(521),f=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function h(p){let g=new Set([p]),m=new Set,P=p.match(f);if(!P)return()=>!1;let w={major:+P[1],minor:+P[2],patch:+P[3],prerelease:P[4]};if(w.prerelease!=null)return function(c){return c===p};function v(C){return m.add(C),!1}function I(C){return g.add(C),!0}return function(c){if(g.has(c))return!0;if(m.has(c))return!1;let S=c.match(f);if(!S)return v(c);let b={major:+S[1],minor:+S[2],patch:+S[3],prerelease:S[4]};return b.prerelease!=null||w.major!==b.major?v(c):w.major===0?w.minor===b.minor&&w.patch<=b.patch?I(c):v(c):w.minor<=b.minor?I(c):v(c)}}s._makeCompatibilityCheck=h,s.isCompatible=h(u.VERSION)},886:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.metrics=void 0;let u=d(653);s.metrics=u.MetricsAPI.getInstance()},901:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ValueType=void 0;var d;(function(u){u[u.INT=0]="INT",u[u.DOUBLE=1]="DOUBLE"})(d=s.ValueType||(s.ValueType={}))},102:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.createNoopMeter=s.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=s.NOOP_OBSERVABLE_GAUGE_METRIC=s.NOOP_OBSERVABLE_COUNTER_METRIC=s.NOOP_UP_DOWN_COUNTER_METRIC=s.NOOP_HISTOGRAM_METRIC=s.NOOP_COUNTER_METRIC=s.NOOP_METER=s.NoopObservableUpDownCounterMetric=s.NoopObservableGaugeMetric=s.NoopObservableCounterMetric=s.NoopObservableMetric=s.NoopHistogramMetric=s.NoopUpDownCounterMetric=s.NoopCounterMetric=s.NoopMetric=s.NoopMeter=void 0;class d{constructor(){}createHistogram(C,c){return s.NOOP_HISTOGRAM_METRIC}createCounter(C,c){return s.NOOP_COUNTER_METRIC}createUpDownCounter(C,c){return s.NOOP_UP_DOWN_COUNTER_METRIC}createObservableGauge(C,c){return s.NOOP_OBSERVABLE_GAUGE_METRIC}createObservableCounter(C,c){return s.NOOP_OBSERVABLE_COUNTER_METRIC}createObservableUpDownCounter(C,c){return s.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC}addBatchObservableCallback(C,c){}removeBatchObservableCallback(C){}}s.NoopMeter=d;class u{}s.NoopMetric=u;class f extends u{add(C,c){}}s.NoopCounterMetric=f;class h extends u{add(C,c){}}s.NoopUpDownCounterMetric=h;class p extends u{record(C,c){}}s.NoopHistogramMetric=p;class g{addCallback(C){}removeCallback(C){}}s.NoopObservableMetric=g;class m extends g{}s.NoopObservableCounterMetric=m;class P extends g{}s.NoopObservableGaugeMetric=P;class w extends g{}s.NoopObservableUpDownCounterMetric=w,s.NOOP_METER=new d,s.NOOP_COUNTER_METRIC=new f,s.NOOP_HISTOGRAM_METRIC=new p,s.NOOP_UP_DOWN_COUNTER_METRIC=new h,s.NOOP_OBSERVABLE_COUNTER_METRIC=new m,s.NOOP_OBSERVABLE_GAUGE_METRIC=new P,s.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=new w;function v(){return s.NOOP_METER}s.createNoopMeter=v},660:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.NOOP_METER_PROVIDER=s.NoopMeterProvider=void 0;let u=d(102);class f{getMeter(p,g,m){return u.NOOP_METER}}s.NoopMeterProvider=f,s.NOOP_METER_PROVIDER=new f},200:function(y,s,d){var u=this&&this.__createBinding||(Object.create?function(h,p,g,m){m===void 0&&(m=g),Object.defineProperty(h,m,{enumerable:!0,get:function(){return p[g]}})}:function(h,p,g,m){m===void 0&&(m=g),h[m]=p[g]}),f=this&&this.__exportStar||function(h,p){for(var g in h)g!=="default"&&!Object.prototype.hasOwnProperty.call(p,g)&&u(p,h,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(d(46),s)},651:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s._globalThis=void 0,s._globalThis=typeof G=="object"?G:D.g},46:function(y,s,d){var u=this&&this.__createBinding||(Object.create?function(h,p,g,m){m===void 0&&(m=g),Object.defineProperty(h,m,{enumerable:!0,get:function(){return p[g]}})}:function(h,p,g,m){m===void 0&&(m=g),h[m]=p[g]}),f=this&&this.__exportStar||function(h,p){for(var g in h)g!=="default"&&!Object.prototype.hasOwnProperty.call(p,g)&&u(p,h,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(d(651),s)},939:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.propagation=void 0;let u=d(181);s.propagation=u.PropagationAPI.getInstance()},874:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.NoopTextMapPropagator=void 0;class d{inject(f,h){}extract(f,h){return f}fields(){return[]}}s.NoopTextMapPropagator=d},194:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.defaultTextMapSetter=s.defaultTextMapGetter=void 0,s.defaultTextMapGetter={get(d,u){if(d!=null)return d[u]},keys(d){return d==null?[]:Object.keys(d)}},s.defaultTextMapSetter={set(d,u,f){d!=null&&(d[u]=f)}}},845:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.trace=void 0;let u=d(997);s.trace=u.TraceAPI.getInstance()},403:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.NonRecordingSpan=void 0;let u=d(476);class f{constructor(p=u.INVALID_SPAN_CONTEXT){this._spanContext=p}spanContext(){return this._spanContext}setAttribute(p,g){return this}setAttributes(p){return this}addEvent(p,g){return this}setStatus(p){return this}updateName(p){return this}end(p){}isRecording(){return!1}recordException(p,g){}}s.NonRecordingSpan=f},614:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.NoopTracer=void 0;let u=d(491),f=d(607),h=d(403),p=d(139),g=u.ContextAPI.getInstance();class m{startSpan(v,I,C=g.active()){if(Boolean(I?.root))return new h.NonRecordingSpan;let S=C&&(0,f.getSpanContext)(C);return P(S)&&(0,p.isSpanContextValid)(S)?new h.NonRecordingSpan(S):new h.NonRecordingSpan}startActiveSpan(v,I,C,c){let S,b,M;if(arguments.length<2)return;arguments.length===2?M=I:arguments.length===3?(S=I,M=C):(S=I,b=C,M=c);let O=b??g.active(),A=this.startSpan(v,S,O),k=(0,f.setSpan)(O,A);return g.with(k,M,void 0,A)}}s.NoopTracer=m;function P(w){return typeof w=="object"&&typeof w.spanId=="string"&&typeof w.traceId=="string"&&typeof w.traceFlags=="number"}},124:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.NoopTracerProvider=void 0;let u=d(614);class f{getTracer(p,g,m){return new u.NoopTracer}}s.NoopTracerProvider=f},125:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ProxyTracer=void 0;let u=d(614),f=new u.NoopTracer;class h{constructor(g,m,P,w){this._provider=g,this.name=m,this.version=P,this.options=w}startSpan(g,m,P){return this._getTracer().startSpan(g,m,P)}startActiveSpan(g,m,P,w){let v=this._getTracer();return Reflect.apply(v.startActiveSpan,v,arguments)}_getTracer(){if(this._delegate)return this._delegate;let g=this._provider.getDelegateTracer(this.name,this.version,this.options);return g?(this._delegate=g,this._delegate):f}}s.ProxyTracer=h},846:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ProxyTracerProvider=void 0;let u=d(125),f=d(124),h=new f.NoopTracerProvider;class p{getTracer(m,P,w){var v;return(v=this.getDelegateTracer(m,P,w))!==null&&v!==void 0?v:new u.ProxyTracer(this,m,P,w)}getDelegate(){var m;return(m=this._delegate)!==null&&m!==void 0?m:h}setDelegate(m){this._delegate=m}getDelegateTracer(m,P,w){var v;return(v=this._delegate)===null||v===void 0?void 0:v.getTracer(m,P,w)}}s.ProxyTracerProvider=p},996:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SamplingDecision=void 0;var d;(function(u){u[u.NOT_RECORD=0]="NOT_RECORD",u[u.RECORD=1]="RECORD",u[u.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(d=s.SamplingDecision||(s.SamplingDecision={}))},607:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.getSpanContext=s.setSpanContext=s.deleteSpan=s.setSpan=s.getActiveSpan=s.getSpan=void 0;let u=d(780),f=d(403),h=d(491),p=(0,u.createContextKey)("OpenTelemetry Context Key SPAN");function g(C){return C.getValue(p)||void 0}s.getSpan=g;function m(){return g(h.ContextAPI.getInstance().active())}s.getActiveSpan=m;function P(C,c){return C.setValue(p,c)}s.setSpan=P;function w(C){return C.deleteValue(p)}s.deleteSpan=w;function v(C,c){return P(C,new f.NonRecordingSpan(c))}s.setSpanContext=v;function I(C){var c;return(c=g(C))===null||c===void 0?void 0:c.spanContext()}s.getSpanContext=I},325:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TraceStateImpl=void 0;let u=d(564),f=32,h=512,p=",",g="=";class m{constructor(w){this._internalState=new Map,w&&this._parse(w)}set(w,v){let I=this._clone();return I._internalState.has(w)&&I._internalState.delete(w),I._internalState.set(w,v),I}unset(w){let v=this._clone();return v._internalState.delete(w),v}get(w){return this._internalState.get(w)}serialize(){return this._keys().reduce((w,v)=>(w.push(v+g+this.get(v)),w),[]).join(p)}_parse(w){w.length>h||(this._internalState=w.split(p).reverse().reduce((v,I)=>{let C=I.trim(),c=C.indexOf(g);if(c!==-1){let S=C.slice(0,c),b=C.slice(c+1,I.length);(0,u.validateKey)(S)&&(0,u.validateValue)(b)&&v.set(S,b)}return v},new Map),this._internalState.size>f&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,f))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let w=new m;return w._internalState=new Map(this._internalState),w}}s.TraceStateImpl=m},564:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.validateValue=s.validateKey=void 0;let d="[_0-9a-z-*/]",u=`[a-z]${d}{0,255}`,f=`[a-z0-9]${d}{0,240}@[a-z]${d}{0,13}`,h=new RegExp(`^(?:${u}|${f})$`),p=/^[ -~]{0,255}[!-~]$/,g=/,|=/;function m(w){return h.test(w)}s.validateKey=m;function P(w){return p.test(w)&&!g.test(w)}s.validateValue=P},98:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.createTraceState=void 0;let u=d(325);function f(h){return new u.TraceStateImpl(h)}s.createTraceState=f},476:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.INVALID_SPAN_CONTEXT=s.INVALID_TRACEID=s.INVALID_SPANID=void 0;let u=d(475);s.INVALID_SPANID="0000000000000000",s.INVALID_TRACEID="00000000000000000000000000000000",s.INVALID_SPAN_CONTEXT={traceId:s.INVALID_TRACEID,spanId:s.INVALID_SPANID,traceFlags:u.TraceFlags.NONE}},357:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SpanKind=void 0;var d;(function(u){u[u.INTERNAL=0]="INTERNAL",u[u.SERVER=1]="SERVER",u[u.CLIENT=2]="CLIENT",u[u.PRODUCER=3]="PRODUCER",u[u.CONSUMER=4]="CONSUMER"})(d=s.SpanKind||(s.SpanKind={}))},139:(y,s,d)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.wrapSpanContext=s.isSpanContextValid=s.isValidSpanId=s.isValidTraceId=void 0;let u=d(476),f=d(403),h=/^([0-9a-f]{32})$/i,p=/^[0-9a-f]{16}$/i;function g(v){return h.test(v)&&v!==u.INVALID_TRACEID}s.isValidTraceId=g;function m(v){return p.test(v)&&v!==u.INVALID_SPANID}s.isValidSpanId=m;function P(v){return g(v.traceId)&&m(v.spanId)}s.isSpanContextValid=P;function w(v){return new f.NonRecordingSpan(v)}s.wrapSpanContext=w},847:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SpanStatusCode=void 0;var d;(function(u){u[u.UNSET=0]="UNSET",u[u.OK=1]="OK",u[u.ERROR=2]="ERROR"})(d=s.SpanStatusCode||(s.SpanStatusCode={}))},475:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TraceFlags=void 0;var d;(function(u){u[u.NONE=0]="NONE",u[u.SAMPLED=1]="SAMPLED"})(d=s.TraceFlags||(s.TraceFlags={}))},521:(y,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.VERSION=void 0,s.VERSION="1.6.0"}},W={};function K(y){var s=W[y];if(s!==void 0)return s.exports;var d=W[y]={exports:{}},u=!0;try{U[y].call(d.exports,d,d.exports,K),u=!1}finally{u&&delete W[y]}return d.exports}typeof K<"u"&&(K.ab=x+"/");var F={};(()=>{var y=F;Object.defineProperty(y,"__esModule",{value:!0}),y.trace=y.propagation=y.metrics=y.diag=y.context=y.INVALID_SPAN_CONTEXT=y.INVALID_TRACEID=y.INVALID_SPANID=y.isValidSpanId=y.isValidTraceId=y.isSpanContextValid=y.createTraceState=y.TraceFlags=y.SpanStatusCode=y.SpanKind=y.SamplingDecision=y.ProxyTracerProvider=y.ProxyTracer=y.defaultTextMapSetter=y.defaultTextMapGetter=y.ValueType=y.createNoopMeter=y.DiagLogLevel=y.DiagConsoleLogger=y.ROOT_CONTEXT=y.createContextKey=y.baggageEntryMetadataFromString=void 0;var s=K(369);Object.defineProperty(y,"baggageEntryMetadataFromString",{enumerable:!0,get:function(){return s.baggageEntryMetadataFromString}});var d=K(780);Object.defineProperty(y,"createContextKey",{enumerable:!0,get:function(){return d.createContextKey}}),Object.defineProperty(y,"ROOT_CONTEXT",{enumerable:!0,get:function(){return d.ROOT_CONTEXT}});var u=K(972);Object.defineProperty(y,"DiagConsoleLogger",{enumerable:!0,get:function(){return u.DiagConsoleLogger}});var f=K(957);Object.defineProperty(y,"DiagLogLevel",{enumerable:!0,get:function(){return f.DiagLogLevel}});var h=K(102);Object.defineProperty(y,"createNoopMeter",{enumerable:!0,get:function(){return h.createNoopMeter}});var p=K(901);Object.defineProperty(y,"ValueType",{enumerable:!0,get:function(){return p.ValueType}});var g=K(194);Object.defineProperty(y,"defaultTextMapGetter",{enumerable:!0,get:function(){return g.defaultTextMapGetter}}),Object.defineProperty(y,"defaultTextMapSetter",{enumerable:!0,get:function(){return g.defaultTextMapSetter}});var m=K(125);Object.defineProperty(y,"ProxyTracer",{enumerable:!0,get:function(){return m.ProxyTracer}});var P=K(846);Object.defineProperty(y,"ProxyTracerProvider",{enumerable:!0,get:function(){return P.ProxyTracerProvider}});var w=K(996);Object.defineProperty(y,"SamplingDecision",{enumerable:!0,get:function(){return w.SamplingDecision}});var v=K(357);Object.defineProperty(y,"SpanKind",{enumerable:!0,get:function(){return v.SpanKind}});var I=K(847);Object.defineProperty(y,"SpanStatusCode",{enumerable:!0,get:function(){return I.SpanStatusCode}});var C=K(475);Object.defineProperty(y,"TraceFlags",{enumerable:!0,get:function(){return C.TraceFlags}});var c=K(98);Object.defineProperty(y,"createTraceState",{enumerable:!0,get:function(){return c.createTraceState}});var S=K(139);Object.defineProperty(y,"isSpanContextValid",{enumerable:!0,get:function(){return S.isSpanContextValid}}),Object.defineProperty(y,"isValidTraceId",{enumerable:!0,get:function(){return S.isValidTraceId}}),Object.defineProperty(y,"isValidSpanId",{enumerable:!0,get:function(){return S.isValidSpanId}});var b=K(476);Object.defineProperty(y,"INVALID_SPANID",{enumerable:!0,get:function(){return b.INVALID_SPANID}}),Object.defineProperty(y,"INVALID_TRACEID",{enumerable:!0,get:function(){return b.INVALID_TRACEID}}),Object.defineProperty(y,"INVALID_SPAN_CONTEXT",{enumerable:!0,get:function(){return b.INVALID_SPAN_CONTEXT}});let M=K(67);Object.defineProperty(y,"context",{enumerable:!0,get:function(){return M.context}});let O=K(506);Object.defineProperty(y,"diag",{enumerable:!0,get:function(){return O.diag}});let A=K(886);Object.defineProperty(y,"metrics",{enumerable:!0,get:function(){return A.metrics}});let k=K(939);Object.defineProperty(y,"propagation",{enumerable:!0,get:function(){return k.propagation}});let L=K(845);Object.defineProperty(y,"trace",{enumerable:!0,get:function(){return L.trace}}),y.default={context:M.context,diag:O.diag,metrics:A.metrics,propagation:k.propagation,trace:L.trace}})(),z.exports=F})()},1053:z=>{"use strict";var $="/";(()=>{"use strict";typeof __nccwpck_require__<"u"&&(__nccwpck_require__.ab=$+"/");var D={};(()=>{var x=D;x.parse=y,x.serialize=s;var U=decodeURIComponent,W=encodeURIComponent,K=/; */,F=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function y(u,f){if(typeof u!="string")throw new TypeError("argument str must be a string");for(var h={},p=f||{},g=u.split(K),m=p.decode||U,P=0;P<g.length;P++){var w=g[P],v=w.indexOf("=");if(!(v<0)){var I=w.substr(0,v).trim(),C=w.substr(++v,w.length).trim();C[0]=='"'&&(C=C.slice(1,-1)),h[I]==null&&(h[I]=d(C,m))}}return h}function s(u,f,h){var p=h||{},g=p.encode||W;if(typeof g!="function")throw new TypeError("option encode is invalid");if(!F.test(u))throw new TypeError("argument name is invalid");var m=g(f);if(m&&!F.test(m))throw new TypeError("argument val is invalid");var P=u+"="+m;if(p.maxAge!=null){var w=p.maxAge-0;if(isNaN(w)||!isFinite(w))throw new TypeError("option maxAge is invalid");P+="; Max-Age="+Math.floor(w)}if(p.domain){if(!F.test(p.domain))throw new TypeError("option domain is invalid");P+="; Domain="+p.domain}if(p.path){if(!F.test(p.path))throw new TypeError("option path is invalid");P+="; Path="+p.path}if(p.expires){if(typeof p.expires.toUTCString!="function")throw new TypeError("option expires is invalid");P+="; Expires="+p.expires.toUTCString()}if(p.httpOnly&&(P+="; HttpOnly"),p.secure&&(P+="; Secure"),p.sameSite){var v=typeof p.sameSite=="string"?p.sameSite.toLowerCase():p.sameSite;switch(v){case!0:P+="; SameSite=Strict";break;case"lax":P+="; SameSite=Lax";break;case"strict":P+="; SameSite=Strict";break;case"none":P+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return P}function d(u,f){try{return f(u)}catch{return u}}})(),z.exports=D})()},687:z=>{"use strict";let $=["chrome 64","edge 79","firefox 67","opera 51","safari 12"];z.exports=$},3241:(z,$,D)=>{"use strict";Object.defineProperty($,"__esModule",{value:!0});function x(s,d){for(var u in d)Object.defineProperty(s,u,{enumerable:!0,get:d[u]})}x($,{withRequest:function(){return F},getTestReqInfo:function(){return y}});let U=D(2067),W=new U.AsyncLocalStorage;function K(s,d){let u=d.header(s,"next-test-proxy-port");if(!u)return;let f=d.url(s),h=Number(u),p=d.header(s,"next-test-data")||"";return{url:f,proxyPort:h,testData:p}}function F(s,d,u){let f=K(s,d);return f?W.run(f,u):u()}function y(s,d){let u=W.getStore();if(u)return u;if(s&&d)return K(s,d)}},5178:(z,$,D)=>{"use strict";var x=D(6195).Buffer;Object.defineProperty($,"__esModule",{value:!0});function U(f,h){for(var p in h)Object.defineProperty(f,p,{enumerable:!0,get:h[p]})}U($,{reader:function(){return K},handleFetch:function(){return d},interceptFetch:function(){return u}});let W=D(3241),K={url(f){return f.url},header(f,h){return f.headers.get(h)}};function F(){let f=(new Error().stack??"").split(`
`);for(let h=1;h<f.length;h++)if(f[h].length>0){f=f.slice(h);break}return f=f.filter(h=>!h.includes("/next/dist/")),f=f.slice(0,5),f=f.map(h=>h.replace("webpack-internal:///(rsc)/","").trim()),f.join("    ")}async function y(f,h){let{url:p,method:g,headers:m,body:P,cache:w,credentials:v,integrity:I,mode:C,redirect:c,referrer:S,referrerPolicy:b}=h;return{testData:f,api:"fetch",request:{url:p,method:g,headers:[...Array.from(m),["next-test-stack",F()]],body:P?x.from(await h.arrayBuffer()).toString("base64"):null,cache:w,credentials:v,integrity:I,mode:C,redirect:c,referrer:S,referrerPolicy:b}}}function s(f){let{status:h,headers:p,body:g}=f.response;return new Response(g?x.from(g,"base64"):null,{status:h,headers:new Headers(p)})}async function d(f,h){let p=(0,W.getTestReqInfo)(h,K);if(!p)throw new Error(`No test info for ${h.method} ${h.url}`);let{testData:g,proxyPort:m}=p,P=await y(g,h),w=await f(`http://localhost:${m}`,{method:"POST",body:JSON.stringify(P),next:{internal:!0}});if(!w.ok)throw new Error(`Proxy request failed: ${w.status}`);let v=await w.json(),{api:I}=v;switch(I){case"continue":return f(h);case"abort":case"unhandled":throw new Error(`Proxy request aborted [${h.method} ${h.url}]`);default:break}return s(v)}function u(f){return D.g.fetch=function(p,g){var m;return!(g==null||(m=g.next)==null)&&m.internal?f(p,g):d(f,new Request(p,g))},()=>{D.g.fetch=f}}},3457:(z,$,D)=>{"use strict";Object.defineProperty($,"__esModule",{value:!0});function x(y,s){for(var d in s)Object.defineProperty(y,d,{enumerable:!0,get:s[d]})}x($,{interceptTestApis:function(){return K},wrapRequestHandler:function(){return F}});let U=D(3241),W=D(5178);function K(){return(0,W.interceptFetch)(D.g.fetch)}function F(y){return(s,d)=>(0,U.withRequest)(s,W.reader,()=>y(s,d))}},9186:(z,$,D)=>{"use strict";D.d($,{P:()=>K});let x=new Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available");class U{disable(){throw x}getStore(){}run(){throw x}exit(){throw x}enterWith(){throw x}}let W=G.AsyncLocalStorage;function K(){return W?new W:new U}}},z=>{var $=x=>z(z.s=x),D=$(5257);(G._ENTRIES=typeof G._ENTRIES>"u"?{}:G._ENTRIES)["middleware_src/middleware"]=D}]),function(){let z={exports:{},loaded:!1};return function(D,x){var U=Object.create,W=Object.defineProperty,K=Object.getOwnPropertyDescriptor,F=Object.getOwnPropertyNames,y=Object.getPrototypeOf,s=Object.prototype.hasOwnProperty,d=A=>W(A,"__esModule",{value:!0}),u=(A,k)=>{d(A);for(var L in k)W(A,L,{get:k[L],enumerable:!0})},f=(A,k,L)=>{if(k&&typeof k=="object"||typeof k=="function")for(let H of F(k))!s.call(A,H)&&H!=="default"&&W(A,H,{get:()=>k[H],enumerable:!(L=K(k,H))||L.enumerable});return A},h=A=>f(d(W(A!=null?U(y(A)):{},"default",A&&A.__esModule&&"default"in A?{get:()=>A.default,enumerable:!0}:{value:A,enumerable:!0})),A);u(x,{default:()=>S});var p=h((yr(),lt(Le))),g="@next/request-context",m=Symbol.for(g),P=Symbol.for("internal.storage");function w(){let A=G;if(!A[m]){let k=new p.AsyncLocalStorage,L={get:()=>k.getStore(),[P]:k};A[m]=L}return A[m]}var v=w();function I(A,k){return v[P].run(A,k)}function C(A){let k={};return A&&A.forEach((L,H)=>{k[H]=L,H.toLowerCase()==="set-cookie"&&(k[H]=c(L))}),k}function c(A){let k=[],L=0,H,Z,ee,ie,ce;function ne(){for(;L<A.length&&/\s/.test(A.charAt(L));)L+=1;return L<A.length}function T(){return Z=A.charAt(L),Z!=="="&&Z!==";"&&Z!==","}for(;L<A.length;){for(H=L,ce=!1;ne();)if(Z=A.charAt(L),Z===","){for(ee=L,L+=1,ne(),ie=L;L<A.length&&T();)L+=1;L<A.length&&A.charAt(L)==="="?(ce=!0,L=ie,k.push(A.substring(H,ee)),H=L):L=ee+1}else L+=1;(!ce||L>=A.length)&&k.push(A.substring(H,A.length))}return k}function S(A){let k=A.staticRoutes.map(H=>({regexp:new RegExp(H.namedRegex),page:H.page})),L=A.dynamicRoutes?.map(H=>({regexp:new RegExp(H.namedRegex),page:H.page}))||[];return async function(H,Z){let ee=new URL(H.url).pathname,ie={};if(A.nextConfig?.basePath&&ee.startsWith(A.nextConfig.basePath)&&(ee=ee.replace(A.nextConfig.basePath,"")||"/"),A.nextConfig?.i18n)for(let ne of A.nextConfig.i18n.locales){let T=new RegExp(`^/${ne}($|/)`,"i");if(ee.match(T)){ee=ee.replace(T,"/")||"/";break}}for(let ne of k)if(ne.regexp.exec(ee)){ie.name=ne.page;break}if(!ie.name){let ne=M(ee);for(let T of L||[]){if(ne&&!M(T.page))continue;let de=T.regexp.exec(ee);if(de){ie={name:T.page,params:de.groups};break}}}let ce=await I({waitUntil:Z.waitUntil},()=>G._ENTRIES[`middleware_${A.name}`].default.call({},{request:{url:H.url,method:H.method,headers:C(H.headers),ip:b(H.headers,O.Ip),geo:{city:b(H.headers,O.City,!0),country:b(H.headers,O.Country,!0),latitude:b(H.headers,O.Latitude),longitude:b(H.headers,O.Longitude),region:b(H.headers,O.Region,!0)},nextConfig:A.nextConfig,page:ie,body:H.body}}));return ce.waitUntil&&Z.waitUntil(ce.waitUntil),ce.response}}function b(A,k,L=!1){let H=A.get(k)||void 0;return L&&H?decodeURIComponent(H):H}function M(A){return A==="/api"||A.startsWith("/api/")}var O;(function(A){A.City="x-vercel-ip-city",A.Country="x-vercel-ip-country",A.Ip="x-real-ip",A.Latitude="x-vercel-ip-latitude",A.Longitude="x-vercel-ip-longitude",A.Region="x-vercel-ip-country-region"})(O||(O={}))}(z,z.exports),z.exports}.call({}).default({name:"src/middleware",staticRoutes:[{page:"/",regex:"^/(?:/)?$",routeKeys:{},namedRegex:"^/(?:/)?$"},{page:"/_not-found",regex:"^/_not\\-found(?:/)?$",routeKeys:{},namedRegex:"^/_not\\-found(?:/)?$"},{page:"/admin",regex:"^/admin(?:/)?$",routeKeys:{},namedRegex:"^/admin(?:/)?$"},{page:"/admin/categories",regex:"^/admin/categories(?:/)?$",routeKeys:{},namedRegex:"^/admin/categories(?:/)?$"},{page:"/admin/contact",regex:"^/admin/contact(?:/)?$",routeKeys:{},namedRegex:"^/admin/contact(?:/)?$"},{page:"/admin/contact/messages",regex:"^/admin/contact/messages(?:/)?$",routeKeys:{},namedRegex:"^/admin/contact/messages(?:/)?$"},{page:"/admin/products",regex:"^/admin/products(?:/)?$",routeKeys:{},namedRegex:"^/admin/products(?:/)?$"},{page:"/admin/products/new",regex:"^/admin/products/new(?:/)?$",routeKeys:{},namedRegex:"^/admin/products/new(?:/)?$"},{page:"/admin/resources",regex:"^/admin/resources(?:/)?$",routeKeys:{},namedRegex:"^/admin/resources(?:/)?$"},{page:"/admin/resources/events/new",regex:"^/admin/resources/events/new(?:/)?$",routeKeys:{},namedRegex:"^/admin/resources/events/new(?:/)?$"},{page:"/admin/resources/news/new",regex:"^/admin/resources/news/new(?:/)?$",routeKeys:{},namedRegex:"^/admin/resources/news/new(?:/)?$"},{page:"/cozumler",regex:"^/cozumler(?:/)?$",routeKeys:{},namedRegex:"^/cozumler(?:/)?$"},{page:"/cozumler/anahtar-teslim-projeler",regex:"^/cozumler/anahtar\\-teslim\\-projeler(?:/)?$",routeKeys:{},namedRegex:"^/cozumler/anahtar\\-teslim\\-projeler(?:/)?$"},{page:"/cozumler/ar-ge-laboratuvarlari",regex:"^/cozumler/ar\\-ge\\-laboratuvarlari(?:/)?$",routeKeys:{},namedRegex:"^/cozumler/ar\\-ge\\-laboratuvarlari(?:/)?$"},{page:"/cozumler/endustriyel-laboratuvar-kurulumu",regex:"^/cozumler/endustriyel\\-laboratuvar\\-kurulumu(?:/)?$",routeKeys:{},namedRegex:"^/cozumler/endustriyel\\-laboratuvar\\-kurulumu(?:/)?$"},{page:"/cozumler/kalite-guvence-sistemleri",regex:"^/cozumler/kalite\\-guvence\\-sistemleri(?:/)?$",routeKeys:{},namedRegex:"^/cozumler/kalite\\-guvence\\-sistemleri(?:/)?$"},{page:"/cozumler/otomasyon-sistemleri",regex:"^/cozumler/otomasyon\\-sistemleri(?:/)?$",routeKeys:{},namedRegex:"^/cozumler/otomasyon\\-sistemleri(?:/)?$"},{page:"/hakkimizda",regex:"^/hakkimizda(?:/)?$",routeKeys:{},namedRegex:"^/hakkimizda(?:/)?$"},{page:"/iletisim",regex:"^/iletisim(?:/)?$",routeKeys:{},namedRegex:"^/iletisim(?:/)?$"},{page:"/kaynaklar",regex:"^/kaynaklar(?:/)?$",routeKeys:{},namedRegex:"^/kaynaklar(?:/)?$"},{page:"/login",regex:"^/login(?:/)?$",routeKeys:{},namedRegex:"^/login(?:/)?$"},{page:"/sektorler",regex:"^/sektorler(?:/)?$",routeKeys:{},namedRegex:"^/sektorler(?:/)?$"},{page:"/teklif-al",regex:"^/teklif\\-al(?:/)?$",routeKeys:{},namedRegex:"^/teklif\\-al(?:/)?$"},{page:"/urunler",regex:"^/urunler(?:/)?$",routeKeys:{},namedRegex:"^/urunler(?:/)?$"}],dynamicRoutes:[{page:"/admin/products/[id]/edit",regex:"^/admin/products/([^/]+?)/edit(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/admin/products/(?<nxtPid>[^/]+?)/edit(?:/)?$"},{page:"/admin/resources/events/[id]/edit",regex:"^/admin/resources/events/([^/]+?)/edit(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/admin/resources/events/(?<nxtPid>[^/]+?)/edit(?:/)?$"},{page:"/admin/resources/news/edit/[id]",regex:"^/admin/resources/news/edit/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/admin/resources/news/edit/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/events/[id]",regex:"^/api/events/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/events/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/news/[id]",regex:"^/api/news/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/news/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/products/[id]",regex:"^/api/products/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/products/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/kaynaklar/etkinlik/[id]",regex:"^/kaynaklar/etkinlik/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/kaynaklar/etkinlik/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/kaynaklar/haber/[id]",regex:"^/kaynaklar/haber/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/kaynaklar/haber/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/urunler/[category]",regex:"^/urunler/([^/]+?)(?:/)?$",routeKeys:{nxtPcategory:"nxtPcategory"},namedRegex:"^/urunler/(?<nxtPcategory>[^/]+?)(?:/)?$"},{page:"/urunler/[category]/[subcategory]",regex:"^/urunler/([^/]+?)/([^/]+?)(?:/)?$",routeKeys:{nxtPcategory:"nxtPcategory",nxtPsubcategory:"nxtPsubcategory"},namedRegex:"^/urunler/(?<nxtPcategory>[^/]+?)/(?<nxtPsubcategory>[^/]+?)(?:/)?$"},{page:"/urunler/[category]/[subcategory]/[product]",regex:"^/urunler/([^/]+?)/([^/]+?)/([^/]+?)(?:/)?$",routeKeys:{nxtPcategory:"nxtPcategory",nxtPsubcategory:"nxtPsubcategory",nxtPproduct:"nxtPproduct"},namedRegex:"^/urunler/(?<nxtPcategory>[^/]+?)/(?<nxtPsubcategory>[^/]+?)/(?<nxtPproduct>[^/]+?)(?:/)?$"}],nextConfig:{basePath:""}})))(pt,pt,pt);export{qi as default};
/*!
* cookie
* Copyright(c) 2012-2014 Roman Shtylman
* Copyright(c) 2015 Douglas Christopher Wilson
* MIT Licensed
*/
